<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nilorea Library: n_thread_pool.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Nilorea Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('n__thread__pool_8c_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">n_thread_pool.c</div></div>
</div><!--header-->
<div class="contents">
<a href="n__thread__pool_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><span class="lineno">    1</span><span class="comment">/**\file n_thread_pool.c</span></div>
<div class="line"><span class="lineno">    2</span><span class="comment"> *  Thread pool functions</span></div>
<div class="line"><span class="lineno">    3</span><span class="comment"> *\author Castagnier Mickael</span></div>
<div class="line"><span class="lineno">    4</span><span class="comment"> *\version 1.0</span></div>
<div class="line"><span class="lineno">    5</span><span class="comment"> *\date 30/04/2014</span></div>
<div class="line"><span class="lineno">    6</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">    7</span> </div>
<div class="line"><span class="lineno">    8</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_common.h&quot;</span></div>
<div class="line"><span class="lineno">    9</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_log.h&quot;</span></div>
<div class="line"><span class="lineno">   10</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_thread_pool.h&quot;</span></div>
<div class="line"><span class="lineno">   11</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_time.h&quot;</span></div>
<div class="line"><span class="lineno">   12</span> </div>
<div class="line"><span class="lineno">   13</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">unistd</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   14</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">pthread</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   15</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">string</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   16</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">errno</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span> </div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span><span class="comment">/*!\fn void *thread_pool_processing_function( void *param )</span></div>
<div class="line"><span class="lineno">   21</span><span class="comment"> * \brief Internal thread pool processing function</span></div>
<div class="line"><span class="lineno">   22</span><span class="comment"> * \param param Teh eventual param of a process</span></div>
<div class="line"><span class="lineno">   23</span><span class="comment"> * \return NULL when exiting</span></div>
<div class="line"><span class="lineno">   24</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="n__thread__pool_8c.html#abd0649708787bc15e1bc1ee59d64fd1f">   25</a></span><span class="keywordtype">void</span> *<a class="code hl_function" href="n__thread__pool_8c.html#abd0649708787bc15e1bc1ee59d64fd1f">thread_pool_processing_function</a>( <span class="keywordtype">void</span> *param )</div>
<div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span>    <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html">THREAD_POOL_NODE</a> *node = (<a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html">THREAD_POOL_NODE</a> *)param ;</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordtype">int</span> thread_state = 0 ;</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">   32</span>    {</div>
<div class="line"><span class="lineno">   33</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Thread pool processing func waiting&quot;</span> );</div>
<div class="line"><span class="lineno">   34</span>        <span class="comment">/* Direct procs automatically post th_start */</span></div>
<div class="line"><span class="lineno">   35</span>        sem_wait( &amp;node -&gt; th_start );</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>        pthread_mutex_lock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   38</span>        thread_state = node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">thread_state</a> ;</div>
<div class="line"><span class="lineno">   39</span>        pthread_mutex_unlock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">if</span>( thread_state == <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gac3966893f43d72bd23c7c3f410df9a48">RUNNING_THREAD</a> )</div>
<div class="line"><span class="lineno">   42</span>        {</div>
<div class="line"><span class="lineno">   43</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Thread pool running proc %p&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">func</a> );</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>            pthread_mutex_lock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   46</span>            node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga928be77c90a9b28e1931431b5eac113b">RUNNING_PROC</a> ;</div>
<div class="line"><span class="lineno">   47</span>            pthread_mutex_unlock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>            <span class="keywordflow">if</span>( node &amp;&amp; node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">func</a> )</div>
<div class="line"><span class="lineno">   50</span>            {</div>
<div class="line"><span class="lineno">   51</span>                <span class="keywordflow">if</span>( node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">param</a> )</div>
<div class="line"><span class="lineno">   52</span>                    node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">func</a><a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">(</a> node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">param</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">)</a> ;</div>
<div class="line"><span class="lineno">   53</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   54</span>                    node -&gt; func( NULL );</div>
<div class="line"><span class="lineno">   55</span>            }</div>
<div class="line"><span class="lineno">   56</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Thread pool end proc %p&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">func</a> );</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>            pthread_mutex_lock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   59</span>            node -&gt; func = NULL ;</div>
<div class="line"><span class="lineno">   60</span>            node -&gt; param = NULL ;</div>
<div class="line"><span class="lineno">   61</span>            node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga7131f70ca662b8211de3586a2a6a5a16">IDLE_PROC</a> ;</div>
<div class="line"><span class="lineno">   62</span>            <span class="keywordtype">int</span> type = node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">type</a> ;</div>
<div class="line"><span class="lineno">   63</span>            node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">type</a> = -1 ;</div>
<div class="line"><span class="lineno">   64</span>            pthread_mutex_unlock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>            <span class="comment">/* DIRECT_PROC do not need to post th_end */</span></div>
<div class="line"><span class="lineno">   67</span>            <span class="keywordflow">if</span>( type&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga2b400f548be5f43fa27d8f8b18892c08">SYNCED_PROC</a> )</div>
<div class="line"><span class="lineno">   68</span>                sem_post( &amp;node -&gt; th_end );</div>
<div class="line"><span class="lineno">   69</span>        }</div>
<div class="line"><span class="lineno">   70</span>    }</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">while</span>( thread_state != <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gaac52c55616f27d8f95c4435d4b2cf91d">EXITING_THREAD</a> );</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#gad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Thread processing func %ld exiting&quot;</span>, node -&gt; thr );</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    pthread_mutex_lock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   76</span>    node <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">thread_state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga1acdd58d4aee3c8453ea124bd862518d">EXITED_THREAD</a> ;</div>
<div class="line"><span class="lineno">   77</span>    pthread_mutex_unlock( &amp;node -&gt; lock );</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#gad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Thread %ld exited&quot;</span>, node -&gt; thr );</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    pthread_exit( NULL );</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">   84</span>} <span class="comment">/* thread_pool_processing_function */</span></div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span><span class="comment">/*!\fn THREAD_POOL *new_thread_pool( int nbmaxthr , int nb_max_waiting )</span></div>
<div class="line"><span class="lineno">   89</span><span class="comment"> * \brief Create a new pool of nbmaxthr threads</span></div>
<div class="line"><span class="lineno">   90</span><span class="comment"> * \param nbmaxthr number of active threads in the pool</span></div>
<div class="line"><span class="lineno">   91</span><span class="comment"> * \param nb_max_waiting max number of waiting procs in the pool</span></div>
<div class="line"><span class="lineno">   92</span><span class="comment"> * \return NULL or a new trhead pool object</span></div>
<div class="line"><span class="lineno">   93</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___t_h_r_e_a_d_s.html#gadb3f2b85b758433e29e84b54992cfed4">   94</a></span><a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a> *<a class="code hl_function" href="group___t_h_r_e_a_d_s.html#gadb3f2b85b758433e29e84b54992cfed4">new_thread_pool</a>( <span class="keywordtype">int</span> nbmaxthr, <span class="keywordtype">int</span> nb_max_waiting )</div>
<div class="line"><span class="lineno">   95</span>{</div>
<div class="line"><span class="lineno">   96</span>    <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a> *thread_pool = NULL ;</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( thread_pool, <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a>, 1 );</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span>( !thread_pool )</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> = nbmaxthr ;</div>
<div class="line"><span class="lineno">  103</span>    thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#abe43ad9cb87f223ab2a875cda79b53ed">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#abe43ad9cb87f223ab2a875cda79b53ed">nb_max_waiting</a> = nb_max_waiting ;</div>
<div class="line"><span class="lineno">  104</span>    thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a0dedc7e382229d6d1b263a6438300941">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a0dedc7e382229d6d1b263a6438300941">nb_actives</a> = 0 ;</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a> =  (<a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html">THREAD_POOL_NODE</a> **)malloc( nbmaxthr * <span class="keyword">sizeof</span>( <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html">THREAD_POOL_NODE</a> * ) );</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span>( !thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a> )</div>
<div class="line"><span class="lineno">  108</span>    {</div>
<div class="line"><span class="lineno">  109</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( thread_pool );</div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  111</span>    }</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> = <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">new_generic_list</a><a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">(</a> 0 <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">)</a>;</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">if</span>( !thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> )</div>
<div class="line"><span class="lineno">  115</span>    {</div>
<div class="line"><span class="lineno">  116</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unable to initialize wait list&quot;</span> );</div>
<div class="line"><span class="lineno">  117</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  118</span>    }</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    pthread_mutex_init( &amp;thread_pool -&gt; lock, NULL );</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; nbmaxthr ; it ++ )</div>
<div class="line"><span class="lineno">  123</span>    {</div>
<div class="line"><span class="lineno">  124</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( thread_pool -&gt; thread_list[ it ], <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html">THREAD_POOL_NODE</a>, 1 );</div>
<div class="line"><span class="lineno">  125</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">type</a> = -1 ;</div>
<div class="line"><span class="lineno">  126</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga7131f70ca662b8211de3586a2a6a5a16">IDLE_PROC</a> ;</div>
<div class="line"><span class="lineno">  127</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">thread_state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gac3966893f43d72bd23c7c3f410df9a48">RUNNING_THREAD</a> ;</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">if</span>( sem_init( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; th_start, 0, 0 ) == -1 )</div>
<div class="line"><span class="lineno">  130</span>        {</div>
<div class="line"><span class="lineno">  131</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;sem_init failed : %s on &amp;thread_pool -&gt; thread_list[ %d ] -&gt; th_start\n&quot;</span>, strerror ( errno ), it );</div>
<div class="line"><span class="lineno">  132</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  133</span>        }</div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">if</span>( sem_init( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; th_end, 0, 0 ) == -1 )</div>
<div class="line"><span class="lineno">  135</span>        {</div>
<div class="line"><span class="lineno">  136</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;sem_init failed : %s on &amp;thread_pool -&gt; thread_list[ %d] -&gt; th_end\n&quot;</span>, strerror ( errno ), it );</div>
<div class="line"><span class="lineno">  137</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  138</span>        }</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>        thread_pool -&gt; thread_list[ it ] -&gt; func = NULL ;</div>
<div class="line"><span class="lineno">  141</span>        thread_pool -&gt; thread_list[ it ] -&gt; param = NULL ;</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>        pthread_mutex_init( &amp;thread_pool -&gt; thread_list[ it ] -&gt; lock, NULL );</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">if</span>( pthread_create( &amp;thread_pool -&gt; thread_list[ it ] -&gt; thr, NULL, thread_pool_processing_function, (<span class="keywordtype">void</span> *)thread_pool -&gt; thread_list[ it ] ) != 0 )</div>
<div class="line"><span class="lineno">  146</span>        {</div>
<div class="line"><span class="lineno">  147</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;pthread_create failed : %s for it %d\n&quot;</span>,  strerror ( errno ), it );</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  149</span>        }</div>
<div class="line"><span class="lineno">  150</span>    }</div>
<div class="line"><span class="lineno">  151</span>    <span class="keywordflow">return</span> thread_pool ;</div>
<div class="line"><span class="lineno">  152</span>} <span class="comment">/* new_thread_pool */</span></div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span><span class="comment">/*!\fn int add_threaded_process( THREAD_POOL *thread_pool , void *(*func_ptr)(void *param) , void *param , int mode )</span></div>
<div class="line"><span class="lineno">  157</span><span class="comment"> *\brief add a function and params to a thread pool</span></div>
<div class="line"><span class="lineno">  158</span><span class="comment"> *\param thread_pool The target thread pool</span></div>
<div class="line"><span class="lineno">  159</span><span class="comment"> *\param func_ptr The function pointer to launch</span></div>
<div class="line"><span class="lineno">  160</span><span class="comment"> *\param param Eventual parameter struct to pass to the function</span></div>
<div class="line"><span class="lineno">  161</span><span class="comment"> *\param mode SYNCED_PROC: added to pool, but wait for a start call with other waiting procs. DIRECT_PROC: the function actually starts as quick as possible</span></div>
<div class="line"><span class="lineno">  162</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno">  163</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">  164</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">add_threaded_process</a>( <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a> *thread_pool, <span class="keywordtype">void</span> *(*func_ptr)(<span class="keywordtype">void</span> *param), <span class="keywordtype">void</span> *param,  <span class="keywordtype">int</span> mode )</div>
<div class="line"><span class="lineno">  165</span>{</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">if</span>( !thread_pool )</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">if</span>( !thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a> )</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordtype">int</span> it = 0 ;</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">if</span>( !(mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a>) ) pthread_mutex_lock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">while</span>( it &lt; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> )</div>
<div class="line"><span class="lineno">  178</span>    {</div>
<div class="line"><span class="lineno">  179</span>        pthread_mutex_lock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">if</span>( thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">thread_state</a> == <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gac3966893f43d72bd23c7c3f410df9a48">RUNNING_THREAD</a> &amp;&amp; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> == <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga7131f70ca662b8211de3586a2a6a5a16">IDLE_PROC</a> )</div>
<div class="line"><span class="lineno">  181</span>        {</div>
<div class="line"><span class="lineno">  182</span>            <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno">  183</span>        }</div>
<div class="line"><span class="lineno">  184</span>        pthread_mutex_unlock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  185</span>        it ++ ;</div>
<div class="line"><span class="lineno">  186</span>    }</div>
<div class="line"><span class="lineno">  187</span>    <span class="comment">/* all thread are occupied -&gt; test waiting lists. not holding node lock  because it &gt; max_threads !!! */</span></div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">if</span>( it &gt;= thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> )</div>
<div class="line"><span class="lineno">  189</span>    {</div>
<div class="line"><span class="lineno">  190</span>        <span class="comment">/* if already coming from queue, or if it should be part of a synced start, do not re-add &amp;&amp; return FALSE  */</span></div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordflow">if</span>( mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gaa558974d10eb2bf6f6915b6cc2bfea34">NOQUEUE</a> || mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga2b400f548be5f43fa27d8f8b18892c08">SYNCED_PROC</a> )</div>
<div class="line"><span class="lineno">  192</span>        {</div>
<div class="line"><span class="lineno">  193</span>            <span class="keywordflow">if</span>( !(mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a>) ) pthread_mutex_unlock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  194</span>            <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  195</span>        }</div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">if</span>( thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">nb_items</a> &lt; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#abe43ad9cb87f223ab2a875cda79b53ed">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#abe43ad9cb87f223ab2a875cda79b53ed">nb_max_waiting</a> )</div>
<div class="line"><span class="lineno">  197</span>        {</div>
<div class="line"><span class="lineno">  198</span>            THREAD_WAITING_PROC *proc = NULL ;</div>
<div class="line"><span class="lineno">  199</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( proc, THREAD_WAITING_PROC, 1 );</div>
<div class="line"><span class="lineno">  200</span>            proc <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">func</a> = func_ptr ;</div>
<div class="line"><span class="lineno">  201</span>            proc <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">param</a> = param ;</div>
<div class="line"><span class="lineno">  202</span>            list_push( thread_pool -&gt; waiting_list, proc, free );</div>
<div class="line"><span class="lineno">  203</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Adding %p %p to waitlist&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> proc <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">func</a><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> proc <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">param</a> );</div>
<div class="line"><span class="lineno">  204</span>            <span class="keywordflow">if</span>( !(mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a>) ) pthread_mutex_unlock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  205</span>            <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno">  206</span>        }</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  208</span>        {</div>
<div class="line"><span class="lineno">  209</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Proc %p %p was dropped from waitlist because waitlist is full&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> func_ptr<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> param );</div>
<div class="line"><span class="lineno">  210</span>            <span class="keywordflow">if</span>( !(mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a>) ) pthread_mutex_unlock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  211</span>            <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  212</span>        }</div>
<div class="line"><span class="lineno">  213</span>    }</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span>( mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga8c7d9cf88f160af14b39be46a66f8189">DIRECT_PROC</a> )</div>
<div class="line"><span class="lineno">  215</span>    {</div>
<div class="line"><span class="lineno">  216</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">func</a> = func_ptr ;</div>
<div class="line"><span class="lineno">  217</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">param</a> = param ;</div>
<div class="line"><span class="lineno">  218</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gad1478c0e8f6772bb9673116dd0902e56">WAITING_PROC</a> ;</div>
<div class="line"><span class="lineno">  219</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">type</a> = mode ;</div>
<div class="line"><span class="lineno">  220</span>        sem_post( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; th_start );</div>
<div class="line"><span class="lineno">  221</span>    }</div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga2b400f548be5f43fa27d8f8b18892c08">SYNCED_PROC</a> )</div>
<div class="line"><span class="lineno">  223</span>    {</div>
<div class="line"><span class="lineno">  224</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">func</a> = func_ptr ;</div>
<div class="line"><span class="lineno">  225</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">param</a> = param ;</div>
<div class="line"><span class="lineno">  226</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gad1478c0e8f6772bb9673116dd0902e56">WAITING_PROC</a> ;</div>
<div class="line"><span class="lineno">  227</span>        thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">type</a> = mode ;</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  230</span>    {</div>
<div class="line"><span class="lineno">  231</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unknown mode %d for thread %d&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> mode<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> it );</div>
<div class="line"><span class="lineno">  232</span>        pthread_mutex_unlock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span>( !(mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a>) ) pthread_mutex_unlock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  235</span>    }</div>
<div class="line"><span class="lineno">  236</span>    pthread_mutex_unlock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">if</span>( !(mode&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a>) ) pthread_mutex_unlock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno">  239</span>} <span class="comment">/* add_threaded_process */</span></div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span><span class="comment">/*!\fn int start_threaded_pool( THREAD_POOL *thread_pool )</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment"> * \brief Launch the process waiting for exectution in the thread pool</span></div>
<div class="line"><span class="lineno">  245</span><span class="comment"> * \param thread_pool The thread pool to launche</span></div>
<div class="line"><span class="lineno">  246</span><span class="comment"> * \return TRUE or FALSE</span></div>
<div class="line"><span class="lineno">  247</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___t_h_r_e_a_d_s.html#ga0563294cf52eb2b9e4f1d017390ff46c">  248</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga0563294cf52eb2b9e4f1d017390ff46c">start_threaded_pool</a>( <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a> *thread_pool )</div>
<div class="line"><span class="lineno">  249</span>{</div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">if</span>( !thread_pool )</div>
<div class="line"><span class="lineno">  251</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">if</span>( !thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a> )</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordtype">int</span> retval = TRUE ;</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    pthread_mutex_lock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> ; it ++ )</div>
<div class="line"><span class="lineno">  260</span>    {</div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordtype">int</span> to_run = 0 ;</div>
<div class="line"><span class="lineno">  262</span>        pthread_mutex_lock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">if</span>( (thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">type</a>&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga2b400f548be5f43fa27d8f8b18892c08">SYNCED_PROC</a>) &amp;&amp; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> == <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gad1478c0e8f6772bb9673116dd0902e56">WAITING_PROC</a> )</div>
<div class="line"><span class="lineno">  264</span>        {</div>
<div class="line"><span class="lineno">  265</span>            to_run = 1 ;</div>
<div class="line"><span class="lineno">  266</span>        }</div>
<div class="line"><span class="lineno">  267</span>        pthread_mutex_unlock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">if</span>( to_run == 1 )</div>
<div class="line"><span class="lineno">  269</span>        {</div>
<div class="line"><span class="lineno">  270</span>            <span class="keywordflow">if</span>( sem_post( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; th_start ) != 0 )</div>
<div class="line"><span class="lineno">  271</span>            {</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>            }   retval = FALSE ;</div>
<div class="line"><span class="lineno">  274</span>        }</div>
<div class="line"><span class="lineno">  275</span>    }</div>
<div class="line"><span class="lineno">  276</span>    pthread_mutex_unlock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">return</span> retval ;</div>
<div class="line"><span class="lineno">  279</span>} <span class="comment">/* start_threaded_pool */</span></div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span><span class="comment">/*!\fn int wait_for_threaded_pool( THREAD_POOL *thread_pool , int delay )</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment"> * \brief Wait for all the launched process in the thread pool to terminate</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment"> * \param thread_pool The thread pool to wait</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment"> * \param delay time between each check</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment"> * \return TRUE or FALSE</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___t_h_r_e_a_d_s.html#ga992fc2a67a2d66733ccd10f7d9e2ead3">  289</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga992fc2a67a2d66733ccd10f7d9e2ead3">wait_for_threaded_pool</a>(  <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a> *thread_pool, <span class="keywordtype">int</span> delay )</div>
<div class="line"><span class="lineno">  290</span>{</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span>( !thread_pool )</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">if</span>( !thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a> )</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordtype">int</span> DONE = 0 ;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Waiting for the waitlist of %p to be consumed&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> thread_pool );</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    <span class="comment">/* waiting to consume all the waiting list */</span></div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">while</span>( thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">nb_items</a> &gt; 0 )</div>
<div class="line"><span class="lineno">  303</span>    {</div>
<div class="line"><span class="lineno">  304</span>        <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">refresh_thread_pool</a><a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">(</a> thread_pool <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">)</a>;</div>
<div class="line"><span class="lineno">  305</span>        u_sleep( delay );</div>
<div class="line"><span class="lineno">  306</span>    }</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Waiting for active process of %p to be terminated&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> thread_pool );</div>
<div class="line"><span class="lineno">  309</span>    <span class="comment">/* waiting for all active procs to have terminated */</span></div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">while</span>( !DONE )</div>
<div class="line"><span class="lineno">  311</span>    {</div>
<div class="line"><span class="lineno">  312</span>        DONE = 1 ;</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> ; it ++ )</div>
<div class="line"><span class="lineno">  314</span>        {</div>
<div class="line"><span class="lineno">  315</span>            <span class="keywordtype">int</span> state = 0 ;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>            pthread_mutex_lock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  318</span>            state = thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> ;</div>
<div class="line"><span class="lineno">  319</span>            pthread_mutex_unlock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  320</span>            <span class="keywordflow">if</span>( !(state&amp;<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga7131f70ca662b8211de3586a2a6a5a16">IDLE_PROC</a>) )</div>
<div class="line"><span class="lineno">  321</span>            {</div>
<div class="line"><span class="lineno">  322</span>                DONE = 0 ;</div>
<div class="line"><span class="lineno">  323</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Thread id %d status is not IDLE: %d&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> it<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> state );</div>
<div class="line"><span class="lineno">  324</span>            }</div>
<div class="line"><span class="lineno">  325</span>        }</div>
<div class="line"><span class="lineno">  326</span>        u_sleep( delay );</div>
<div class="line"><span class="lineno">  327</span>        <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">refresh_thread_pool</a><a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">(</a> thread_pool <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">)</a>;</div>
<div class="line"><span class="lineno">  328</span>    }</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno">  331</span>}</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span><span class="comment">/*!\fn int destroy_threaded_pool( THREAD_POOL **pool  ,int delay )</span></div>
<div class="line"><span class="lineno">  335</span><span class="comment"> * \brief delete a thread_pool, exit the threads and free the structs</span></div>
<div class="line"><span class="lineno">  336</span><span class="comment"> * \param pool The THREAD_POOL *object to kill</span></div>
<div class="line"><span class="lineno">  337</span><span class="comment"> * \param delay The THREAD_POOL *object to kill</span></div>
<div class="line"><span class="lineno">  338</span><span class="comment"> * \return TRUE or FALSE</span></div>
<div class="line"><span class="lineno">  339</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___t_h_r_e_a_d_s.html#ga12ce28c2aaa5a5a1a05abe11071dd83f">  340</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga12ce28c2aaa5a5a1a05abe11071dd83f">destroy_threaded_pool</a>( <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a> **pool, <span class="keywordtype">int</span> delay )</div>
<div class="line"><span class="lineno">  341</span>{</div>
<div class="line"><span class="lineno">  342</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( pool&amp;&amp;(*pool), <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno">  343</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordtype">int</span> state= 0, DONE = 0 ;</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordflow">while</span>( !DONE )</div>
<div class="line"><span class="lineno">  348</span>    {</div>
<div class="line"><span class="lineno">  349</span>        DONE = 0 ;</div>
<div class="line"><span class="lineno">  350</span>        pthread_mutex_lock( &amp;(*pool) -&gt; lock );</div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> ; it ++ )</div>
<div class="line"><span class="lineno">  352</span>        {</div>
<div class="line"><span class="lineno">  353</span>            pthread_mutex_lock( &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  354</span>            state = (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> ;</div>
<div class="line"><span class="lineno">  355</span>            pthread_mutex_unlock( &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>            <span class="keywordflow">if</span>( state == <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga7131f70ca662b8211de3586a2a6a5a16">IDLE_PROC</a> )</div>
<div class="line"><span class="lineno">  358</span>            {</div>
<div class="line"><span class="lineno">  359</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Posting EXITING to thread %ld&quot;</span>, (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; thr  );</div>
<div class="line"><span class="lineno">  360</span>                pthread_mutex_lock( &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  361</span>                (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">thread_state</a> = <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gaac52c55616f27d8f95c4435d4b2cf91d">EXITING_THREAD</a> ;</div>
<div class="line"><span class="lineno">  362</span>                sem_post( &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; th_start );</div>
<div class="line"><span class="lineno">  363</span>                pthread_mutex_unlock( &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  364</span>                DONE = 1 ;</div>
<div class="line"><span class="lineno">  365</span>            }</div>
<div class="line"><span class="lineno">  366</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  367</span>            {</div>
<div class="line"><span class="lineno">  368</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;thr %ld proc state %d thr state %d&quot;</span>, (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; thr,  (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a>,(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">thread_state</a>  );</div>
<div class="line"><span class="lineno">  369</span>            }</div>
<div class="line"><span class="lineno">  370</span>        }</div>
<div class="line"><span class="lineno">  371</span>        pthread_mutex_unlock( &amp;(*pool) -&gt; lock );</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>        u_sleep( delay );</div>
<div class="line"><span class="lineno">  374</span>    }</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    pthread_mutex_lock( &amp;(*pool) -&gt; lock );</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; (*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> ; it ++ )</div>
<div class="line"><span class="lineno">  378</span>    {</div>
<div class="line"><span class="lineno">  379</span>        pthread_join( (*pool) -&gt; thread_list[ it ] -&gt; thr, NULL );</div>
<div class="line"><span class="lineno">  380</span>        pthread_mutex_destroy( &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  381</span>        sem_destroy(  &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; th_start );</div>
<div class="line"><span class="lineno">  382</span>        sem_destroy(  &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; th_end );</div>
<div class="line"><span class="lineno">  383</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( (*pool) -&gt; thread_list[ it ] );</div>
<div class="line"><span class="lineno">  384</span>    }</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( (*pool) -&gt; thread_list );</div>
<div class="line"><span class="lineno">  386</span>    <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">list_destroy</a><a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">(</a> &amp;(*pool) <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">)</a>;</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    pthread_mutex_unlock( &amp;(*pool) -&gt; lock );</div>
<div class="line"><span class="lineno">  389</span>    pthread_mutex_destroy( &amp;(*pool) -&gt; lock );</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( (*pool) );</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno">  394</span>} <span class="comment">/* destroy_threaded_pool */</span></div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span><span class="comment">/*!\fn  int refresh_thread_pool( THREAD_POOL *thread_pool )</span></div>
<div class="line"><span class="lineno">  400</span><span class="comment"> * \brief try to add some waiting DIRECT_PROCs on some free thread slots, else do nothing</span></div>
<div class="line"><span class="lineno">  401</span><span class="comment"> * \param thread_pool The thread pool to refresh</span></div>
<div class="line"><span class="lineno">  402</span><span class="comment"> * \return TRUE or FALSE</span></div>
<div class="line"><span class="lineno">  403</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">  404</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">refresh_thread_pool</a>( <a class="code hl_struct" href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a> *thread_pool )</div>
<div class="line"><span class="lineno">  405</span>{</div>
<div class="line"><span class="lineno">  406</span>    <span class="comment">/* Trying to empty the wait list */</span></div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordtype">int</span> push_status = 0 ;</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( thread_pool, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno">  410</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a>, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>    pthread_mutex_lock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">if</span>( thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> &amp;&amp; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> <a class="code hl_variable" href="struct_l_i_s_t.html#aaaf4b83d5bfb568b4a840032ba46ead3">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t.html#aaaf4b83d5bfb568b4a840032ba46ead3">start</a> )</div>
<div class="line"><span class="lineno">  415</span>        push_status = 1 ;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">while</span>( push_status == 1 )</div>
<div class="line"><span class="lineno">  418</span>    {</div>
<div class="line"><span class="lineno">  419</span>        LIST_NODE *node = thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a> <a class="code hl_variable" href="struct_l_i_s_t.html#aaaf4b83d5bfb568b4a840032ba46ead3">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t.html#aaaf4b83d5bfb568b4a840032ba46ead3">start</a> ;</div>
<div class="line"><span class="lineno">  420</span>        LIST_NODE *next_node = NULL ;</div>
<div class="line"><span class="lineno">  421</span>        <span class="keywordflow">if</span>( node &amp;&amp; node <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">ptr</a> )</div>
<div class="line"><span class="lineno">  422</span>        {</div>
<div class="line"><span class="lineno">  423</span>            THREAD_WAITING_PROC *proc = (THREAD_WAITING_PROC *)node <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">ptr</a> ;</div>
<div class="line"><span class="lineno">  424</span>            <span class="keywordflow">if</span>( proc )</div>
<div class="line"><span class="lineno">  425</span>            {</div>
<div class="line"><span class="lineno">  426</span>                <span class="keywordflow">if</span>( <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">add_threaded_process</a><a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">(</a> thread_pool<a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">,</a> proc <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">func</a><a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">,</a> proc <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">param</a><a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">,</a> <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga8c7d9cf88f160af14b39be46a66f8189">DIRECT_PROC</a>|<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#gaa558974d10eb2bf6f6915b6cc2bfea34">NOQUEUE</a>|<a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a> <a class="code hl_function" href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">)</a> == TRUE )</div>
<div class="line"><span class="lineno">  427</span>                {</div>
<div class="line"><span class="lineno">  428</span>                    THREAD_WAITING_PROC *procptr = NULL ;</div>
<div class="line"><span class="lineno">  429</span>                    next_node = node <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#ad6f2edb2e5026bbdff71604e5f9d8f3c">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#ad6f2edb2e5026bbdff71604e5f9d8f3c">next</a> ;</div>
<div class="line"><span class="lineno">  430</span>                    procptr = <a class="code hl_define" href="group___l_i_s_t.html#ga366776cfa85e526b247ef1d348c34e0c">remove_list_node</a>( thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">waiting_list</a>, node, THREAD_WAITING_PROC );</div>
<div class="line"><span class="lineno">  431</span>                    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;waitlist: adding %p,%p to %p&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> procptr <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">func</a><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> procptr <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">param</a><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> thread_pool );</div>
<div class="line"><span class="lineno">  432</span>                    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( procptr );</div>
<div class="line"><span class="lineno">  433</span>                    node = next_node ;</div>
<div class="line"><span class="lineno">  434</span>                }</div>
<div class="line"><span class="lineno">  435</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  436</span>                {</div>
<div class="line"><span class="lineno">  437</span>                    push_status = 0 ;</div>
<div class="line"><span class="lineno">  438</span>                }</div>
<div class="line"><span class="lineno">  439</span>            }</div>
<div class="line"><span class="lineno">  440</span>        }</div>
<div class="line"><span class="lineno">  441</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  442</span>        {</div>
<div class="line"><span class="lineno">  443</span>            push_status = 0 ;</div>
<div class="line"><span class="lineno">  444</span>        }</div>
<div class="line"><span class="lineno">  445</span>    } <span class="comment">/* while( push_status == 1 ) */</span></div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <span class="comment">/* update statictics */</span></div>
<div class="line"><span class="lineno">  448</span>    thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a0dedc7e382229d6d1b263a6438300941">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a0dedc7e382229d6d1b263a6438300941">nb_actives</a> = 0 ;</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">max_threads</a> ; it ++ )</div>
<div class="line"><span class="lineno">  450</span>    {</div>
<div class="line"><span class="lineno">  451</span>        pthread_mutex_lock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  452</span>        <span class="keywordflow">if</span>( thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">state</a> == <a class="code hl_define" href="group___t_h_r_e_a_d_s.html#ga928be77c90a9b28e1931431b5eac113b">RUNNING_PROC</a> )</div>
<div class="line"><span class="lineno">  453</span>            thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a0dedc7e382229d6d1b263a6438300941">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a0dedc7e382229d6d1b263a6438300941">nb_actives</a> ++ ;</div>
<div class="line"><span class="lineno">  454</span>        pthread_mutex_unlock( &amp;thread_pool <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">-&gt;</a> <a class="code hl_variable" href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">thread_list</a>[ it ] -&gt; lock );</div>
<div class="line"><span class="lineno">  455</span>    }</div>
<div class="line"><span class="lineno">  456</span>    pthread_mutex_unlock( &amp;thread_pool -&gt; lock );</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno">  461</span>} <span class="comment">/* refresh_thread_pool() */</span></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga46bf052fc99248347a1dcf89bc0757c6"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a></div><div class="ttdeci">#define Malloc(__ptr, __struct, __size)</div><div class="ttdoc">Malloc Handler to get errors and set to 0.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00180">n_common.h:180</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga4ecf5d80299a4ca1dc13c3a19610db11"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a></div><div class="ttdeci">#define __n_assert(__ptr, __ret)</div><div class="ttdoc">macro to assert things</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00260">n_common.h:260</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_gae62e40d702e99a7760ba1de7451dff51"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a></div><div class="ttdeci">#define Free(__ptr)</div><div class="ttdoc">Free Handler to get errors.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00240">n_common.h:240</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga366776cfa85e526b247ef1d348c34e0c"><div class="ttname"><a href="group___l_i_s_t.html#ga366776cfa85e526b247ef1d348c34e0c">remove_list_node</a></div><div class="ttdeci">#define remove_list_node(__LIST_,__NODE_, __TYPE_)</div><div class="ttdoc">Remove macro helper for void pointer casting.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00083">n_list.h:83</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga90d32fef68ce6f3ec0a7b4085690c755"><div class="ttname"><a href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">list_destroy</a></div><div class="ttdeci">int list_destroy(LIST **list)</div><div class="ttdoc">Empty and Free a list container.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8c_source.html#l00480">n_list.c:480</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_gada615e3b144e97bcff147dfe89f6fef6"><div class="ttname"><a href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">new_generic_list</a></div><div class="ttdeci">LIST * new_generic_list(int max_items)</div><div class="ttdoc">Initialiaze a generic list container to max_items pointers.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8c_source.html#l00020">n_list.c:20</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_ga61355655c6d490cdf201afdfc340df4b"><div class="ttname"><a href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a></div><div class="ttdeci">#define n_log(__LEVEL__,...)</div><div class="ttdoc">Logging function wrapper to get line and func.</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00073">n_log.h:73</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_ga6ff63e8955665c4a58b1598f2b07c51a"><div class="ttname"><a href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG</div><div class="ttdoc">debug-level messages</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00065">n_log.h:65</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_ga96fad55b3f5adf08c39e4c877cf185e3"><div class="ttname"><a href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a></div><div class="ttdeci">#define LOG_ERR</div><div class="ttdoc">error conditions</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00057">n_log.h:57</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_gad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="group___l_o_g.html#gad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdoc">normal but significant condition</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00061">n_log.h:61</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_gafbbbfcb9063b9f1454a499dbf98f7a56"><div class="ttname"><a href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">_n_log</a></div><div class="ttdeci">void _n_log(int level, const char *file, const char *func, int line, const char *format,...)</div><div class="ttdoc">Logging function.</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8c_source.html#l00216">n_log.c:216</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga0563294cf52eb2b9e4f1d017390ff46c"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga0563294cf52eb2b9e4f1d017390ff46c">start_threaded_pool</a></div><div class="ttdeci">int start_threaded_pool(THREAD_POOL *thread_pool)</div><div class="ttdoc">Launch the process waiting for exectution in the thread pool.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8c_source.html#l00248">n_thread_pool.c:248</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga12ce28c2aaa5a5a1a05abe11071dd83f"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga12ce28c2aaa5a5a1a05abe11071dd83f">destroy_threaded_pool</a></div><div class="ttdeci">int destroy_threaded_pool(THREAD_POOL **pool, int delay)</div><div class="ttdoc">delete a thread_pool, exit the threads and free the structs</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8c_source.html#l00340">n_thread_pool.c:340</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga1acdd58d4aee3c8453ea124bd862518d"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga1acdd58d4aee3c8453ea124bd862518d">EXITED_THREAD</a></div><div class="ttdeci">#define EXITED_THREAD</div><div class="ttdoc">indicate that the pool is off, all jobs have been consumed</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00042">n_thread_pool.h:42</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga2b400f548be5f43fa27d8f8b18892c08"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga2b400f548be5f43fa27d8f8b18892c08">SYNCED_PROC</a></div><div class="ttdeci">#define SYNCED_PROC</div><div class="ttdoc">processing mode for added func, synced start</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00026">n_thread_pool.h:26</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga46497eb81066d0df83dfd07ad0a9f561"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga46497eb81066d0df83dfd07ad0a9f561">add_threaded_process</a></div><div class="ttdeci">int add_threaded_process(THREAD_POOL *thread_pool, void *(*func_ptr)(void *param), void *param, int mode)</div><div class="ttdoc">add a function and params to a thread pool</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8c_source.html#l00164">n_thread_pool.c:164</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga5d9ce1747e4b7cb58ce3767f7e56cd8b"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga5d9ce1747e4b7cb58ce3767f7e56cd8b">refresh_thread_pool</a></div><div class="ttdeci">int refresh_thread_pool(THREAD_POOL *thread_pool)</div><div class="ttdoc">try to add some waiting DIRECT_PROCs on some free thread slots, else do nothing</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8c_source.html#l00404">n_thread_pool.c:404</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga7131f70ca662b8211de3586a2a6a5a16"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga7131f70ca662b8211de3586a2a6a5a16">IDLE_PROC</a></div><div class="ttdeci">#define IDLE_PROC</div><div class="ttdoc">status of a thread which is waiting for some proc</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00032">n_thread_pool.h:32</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga8c7d9cf88f160af14b39be46a66f8189"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga8c7d9cf88f160af14b39be46a66f8189">DIRECT_PROC</a></div><div class="ttdeci">#define DIRECT_PROC</div><div class="ttdoc">processing mode for added func, direct start</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00028">n_thread_pool.h:28</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga928be77c90a9b28e1931431b5eac113b"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga928be77c90a9b28e1931431b5eac113b">RUNNING_PROC</a></div><div class="ttdeci">#define RUNNING_PROC</div><div class="ttdoc">status of a thread which proc is currently running</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00036">n_thread_pool.h:36</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga992fc2a67a2d66733ccd10f7d9e2ead3"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga992fc2a67a2d66733ccd10f7d9e2ead3">wait_for_threaded_pool</a></div><div class="ttdeci">int wait_for_threaded_pool(THREAD_POOL *thread_pool, int delay)</div><div class="ttdoc">Wait for all the launched process in the thread pool to terminate.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8c_source.html#l00289">n_thread_pool.c:289</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_ga993c05b6c403f10fb3627e9e4fc30c83"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#ga993c05b6c403f10fb3627e9e4fc30c83">NO_LOCK</a></div><div class="ttdeci">#define NO_LOCK</div><div class="ttdoc">if passed to add_threaded_process, skip main table lock in case we are in a func which is already loc...</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00044">n_thread_pool.h:44</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_gaa558974d10eb2bf6f6915b6cc2bfea34"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#gaa558974d10eb2bf6f6915b6cc2bfea34">NOQUEUE</a></div><div class="ttdeci">#define NOQUEUE</div><div class="ttdoc">processing mode for waiting_list: do not readd the work in queue</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00030">n_thread_pool.h:30</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_gaac52c55616f27d8f95c4435d4b2cf91d"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#gaac52c55616f27d8f95c4435d4b2cf91d">EXITING_THREAD</a></div><div class="ttdeci">#define EXITING_THREAD</div><div class="ttdoc">indicate that the pool is exiting, unfinished jobs will finish and the pool will exit the threads and...</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00040">n_thread_pool.h:40</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_gac3966893f43d72bd23c7c3f410df9a48"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#gac3966893f43d72bd23c7c3f410df9a48">RUNNING_THREAD</a></div><div class="ttdeci">#define RUNNING_THREAD</div><div class="ttdoc">indicate that the pool is running and ready to use</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00038">n_thread_pool.h:38</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_gad1478c0e8f6772bb9673116dd0902e56"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#gad1478c0e8f6772bb9673116dd0902e56">WAITING_PROC</a></div><div class="ttdeci">#define WAITING_PROC</div><div class="ttdoc">status of a thread who have proc waiting to be processed</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00034">n_thread_pool.h:34</a></div></div>
<div class="ttc" id="agroup___t_h_r_e_a_d_s_html_gadb3f2b85b758433e29e84b54992cfed4"><div class="ttname"><a href="group___t_h_r_e_a_d_s.html#gadb3f2b85b758433e29e84b54992cfed4">new_thread_pool</a></div><div class="ttdeci">THREAD_POOL * new_thread_pool(int nbmaxthr, int nb_max_waiting)</div><div class="ttdoc">Create a new pool of nbmaxthr threads.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8c_source.html#l00094">n_thread_pool.c:94</a></div></div>
<div class="ttc" id="an__thread__pool_8c_html_abd0649708787bc15e1bc1ee59d64fd1f"><div class="ttname"><a href="n__thread__pool_8c.html#abd0649708787bc15e1bc1ee59d64fd1f">thread_pool_processing_function</a></div><div class="ttdeci">void * thread_pool_processing_function(void *param)</div><div class="ttdoc">Internal thread pool processing function.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8c_source.html#l00025">n_thread_pool.c:25</a></div></div>
<div class="ttc" id="astruct_l_i_s_t___n_o_d_e_html_a3e3c8144183582d63ffad5fb3315ea69"><div class="ttname"><a href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">LIST_NODE::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdoc">void pointer to store</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00029">n_list.h:29</a></div></div>
<div class="ttc" id="astruct_l_i_s_t___n_o_d_e_html_ad6f2edb2e5026bbdff71604e5f9d8f3c"><div class="ttname"><a href="struct_l_i_s_t___n_o_d_e.html#ad6f2edb2e5026bbdff71604e5f9d8f3c">LIST_NODE::next</a></div><div class="ttdeci">struct LIST_NODE * next</div><div class="ttdoc">pointer to the next node</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00035">n_list.h:35</a></div></div>
<div class="ttc" id="astruct_l_i_s_t_html_a17ecceed58e4353b703f55133a36c0d1"><div class="ttname"><a href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">LIST::nb_items</a></div><div class="ttdeci">int nb_items</div><div class="ttdoc">number of item currently in the list</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00047">n_list.h:47</a></div></div>
<div class="ttc" id="astruct_l_i_s_t_html_aaaf4b83d5bfb568b4a840032ba46ead3"><div class="ttname"><a href="struct_l_i_s_t.html#aaaf4b83d5bfb568b4a840032ba46ead3">LIST::start</a></div><div class="ttdeci">LIST_NODE * start</div><div class="ttdoc">pointer to the start of the list</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00052">n_list.h:52</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l___n_o_d_e_html"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html">THREAD_POOL_NODE</a></div><div class="ttdoc">A thread pool node.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00047">n_thread_pool.h:48</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l___n_o_d_e_html_a065b2419124f6d3824a182e3147bab43"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a065b2419124f6d3824a182e3147bab43">THREAD_POOL_NODE::state</a></div><div class="ttdeci">int state</div><div class="ttdoc">state of the proc , RUNNING_PROC when it is busy processing func( param) , IDLE_PROC when it waits fo...</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00058">n_thread_pool.h:58</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l___n_o_d_e_html_a1671454dbf63472ffa867ca84f0afb0f"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a1671454dbf63472ffa867ca84f0afb0f">THREAD_POOL_NODE::type</a></div><div class="ttdeci">int type</div><div class="ttdoc">SYNCED or DIRECT process start.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00056">n_thread_pool.h:56</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l___n_o_d_e_html_a34366b14ed447b68b13afc113589c367"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#a34366b14ed447b68b13afc113589c367">THREAD_POOL_NODE::func</a></div><div class="ttdeci">void *(* func)(void *param)</div><div class="ttdoc">function to call in the thread</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00050">n_thread_pool.h:50</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l___n_o_d_e_html_acbfd0602c9f617ee1b8ed54747111a33"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#acbfd0602c9f617ee1b8ed54747111a33">THREAD_POOL_NODE::thread_state</a></div><div class="ttdeci">int thread_state</div><div class="ttdoc">state of the managing thread , RUNNING_THREAD, EXITING_THREAD, EXITED_THREAD</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00060">n_thread_pool.h:60</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l___n_o_d_e_html_af2c6175edf922b474d70a8e9ba45ff67"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l___n_o_d_e.html#af2c6175edf922b474d70a8e9ba45ff67">THREAD_POOL_NODE::param</a></div><div class="ttdeci">void * param</div><div class="ttdoc">if not NULL , passed as argument</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00053">n_thread_pool.h:53</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l_html"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l.html">THREAD_POOL</a></div><div class="ttdoc">Structure of a trhead pool.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00075">n_thread_pool.h:76</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l_html_a0dedc7e382229d6d1b263a6438300941"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l.html#a0dedc7e382229d6d1b263a6438300941">THREAD_POOL::nb_actives</a></div><div class="ttdeci">int nb_actives</div><div class="ttdoc">number of threads actually doing a proc</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00085">n_thread_pool.h:85</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l_html_a82a4f1f2900076822de004f357ef4e4a"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l.html#a82a4f1f2900076822de004f357ef4e4a">THREAD_POOL::thread_list</a></div><div class="ttdeci">THREAD_POOL_NODE ** thread_list</div><div class="ttdoc">Dynamically allocated but fixed size thread array.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00078">n_thread_pool.h:78</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l_html_a86b5f24f3379eb4659ac2e6e06e8835d"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l.html#a86b5f24f3379eb4659ac2e6e06e8835d">THREAD_POOL::waiting_list</a></div><div class="ttdeci">LIST * waiting_list</div><div class="ttdoc">Waiting list handling.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00090">n_thread_pool.h:90</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l_html_abe43ad9cb87f223ab2a875cda79b53ed"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l.html#abe43ad9cb87f223ab2a875cda79b53ed">THREAD_POOL::nb_max_waiting</a></div><div class="ttdeci">int nb_max_waiting</div><div class="ttdoc">Maximum number of waiting procedures int the list, 0 or -1 for unlimited.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00083">n_thread_pool.h:83</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___p_o_o_l_html_ad1032e66a3c497de40dc989cb245c28d"><div class="ttname"><a href="struct_t_h_r_e_a_d___p_o_o_l.html#ad1032e66a3c497de40dc989cb245c28d">THREAD_POOL::max_threads</a></div><div class="ttdeci">int max_threads</div><div class="ttdoc">Maximum number of running threads in the list.</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00081">n_thread_pool.h:81</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c_html_a22f53a970daf642828333cdc303bae37"><div class="ttname"><a href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#a22f53a970daf642828333cdc303bae37">THREAD_WAITING_PROC::param</a></div><div class="ttdeci">void * param</div><div class="ttdoc">if not NULL , passed as argument</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00102">n_thread_pool.h:102</a></div></div>
<div class="ttc" id="astruct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c_html_ab96bd6795664db0829d2ebc3530ea6b8"><div class="ttname"><a href="struct_t_h_r_e_a_d___w_a_i_t_i_n_g___p_r_o_c.html#ab96bd6795664db0829d2ebc3530ea6b8">THREAD_WAITING_PROC::func</a></div><div class="ttdeci">void *(* func)(void *param)</div><div class="ttdoc">function to call in the thread</div><div class="ttdef"><b>Definition:</b> <a href="n__thread__pool_8h_source.html#l00100">n_thread_pool.h:100</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="n__thread__pool_8c.html">n_thread_pool.c</a></li>
    <li class="footer">Generated on Wed Feb 2 2022 14:24:10 for Nilorea Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
