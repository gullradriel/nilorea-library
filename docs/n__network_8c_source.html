<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nilorea Library: n_network.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Nilorea Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('n__network_8c_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">n_network.c</div></div>
</div><!--header-->
<div class="contents">
<a href="n__network_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><span class="lineno">    1</span><span class="comment">/**\file n_network.c</span></div>
<div class="line"><span class="lineno">    2</span><span class="comment"> *  Network Engine</span></div>
<div class="line"><span class="lineno">    3</span><span class="comment"> *\author Castagnier Mickael</span></div>
<div class="line"><span class="lineno">    4</span><span class="comment"> *\version 1.0</span></div>
<div class="line"><span class="lineno">    5</span><span class="comment"> *\date 10/05/2005</span></div>
<div class="line"><span class="lineno">    6</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">    7</span> </div>
<div class="line"><span class="lineno">    8</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">errno</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">    9</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">limits</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   10</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">pthread</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   11</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">unistd</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   12</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">string</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   13</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">sys</span><span class="preprocessor">/</span><span class="preprocessor">types</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">   14</span> </div>
<div class="line"><span class="lineno">   15</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_network.h&quot;</span></div>
<div class="line"><span class="lineno">   16</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_network_msg.h&quot;</span></div>
<div class="line"><span class="lineno">   17</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_log.h&quot;</span></div>
<div class="line"><span class="lineno">   18</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&quot;nilorea/n_hash.h&quot;</span></div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span><a class="code hl_define" href="group___e_n_u_m_s.html#gaa8f74897a9d29d0a5e3465a63a532668">N_ENUM_DEFINE</a>( N_ENUM_netw_code_type, __netw_code_type )</div>
<div class="line"><span class="lineno">   21</span> </div>
<div class="line"><span class="lineno">   22</span><span class="preprocessor">#</span><span class="preprocessor">ifdef</span> __windows__</div>
<div class="line"><span class="lineno">   23</span> </div>
<div class="line"><span class="lineno">   24</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">   25</span><span class="comment"> * From https://stackoverflow.com/questions/3019977/convert-wchar-t-to-char/55715607#55715607 by Richard Bamford</span></div>
<div class="line"><span class="lineno">   26</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">   27</span><span class="keywordtype">char</span>* wchar_to_char(<span class="keyword">const</span> <span class="keywordtype">wchar_t</span>* pwchar)</div>
<div class="line"><span class="lineno">   28</span>{</div>
<div class="line"><span class="lineno">   29</span>    <span class="comment">// get the number of characters in the string.</span></div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordtype">int</span> currentCharIndex = 0;</div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordtype">char</span> currentChar = pwchar[currentCharIndex];</div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordtype">char</span> *filePathC = NULL ;</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordflow">while</span> (currentChar != <span class="stringliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">   35</span>    {</div>
<div class="line"><span class="lineno">   36</span>        currentCharIndex++;</div>
<div class="line"><span class="lineno">   37</span>        currentChar = pwchar[currentCharIndex];</div>
<div class="line"><span class="lineno">   38</span>    }</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> charCount = currentCharIndex + 1;</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    <span class="comment">// allocate a new block of memory size char (1 byte) instead of wide char (2 bytes)</span></div>
<div class="line"><span class="lineno">   43</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( filePathC, <span class="keywordtype">char</span>, charCount );</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( filePathC, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; charCount; i++)</div>
<div class="line"><span class="lineno">   47</span>    {</div>
<div class="line"><span class="lineno">   48</span>        <span class="comment">// convert to char (1 byte)</span></div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordtype">char</span> character = pwchar[i];</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>        *filePathC = character;</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>        filePathC += <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    }</div>
<div class="line"><span class="lineno">   56</span>    filePathC += <span class="stringliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    filePathC -= (<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * charCount);</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">return</span> filePathC;</div>
<div class="line"><span class="lineno">   61</span>}</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">neterrno</span> <span class="preprocessor">WSAGetLastError</span><span class="preprocessor">(</span><span class="preprocessor">)</span></div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">netstrerror</span><span class="preprocessor">(</span> <span class="preprocessor">code</span> <span class="preprocessor">)</span><span class="preprocessor">(</span><span class="preprocessor">{</span></div>
<div class="line"><span class="lineno">   66</span>                                <span class="keywordtype">wchar_t</span> <span class="preprocessor">*</span><span class="preprocessor">s</span> <span class="preprocessor">=</span> <span class="preprocessor">NULL</span><span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">   67</span>                                <span class="preprocessor">FormatMessageW</span><span class="preprocessor">(</span><span class="preprocessor">FORMAT_MESSAGE_ALLOCATE_BUFFER</span> <span class="preprocessor">|</span> <span class="preprocessor">FORMAT_MESSAGE_FROM_SYSTEM</span> <span class="preprocessor">|</span> <span class="preprocessor">FORMAT_MESSAGE_IGNORE_INSERTS</span><span class="preprocessor">,</span></div>
<div class="line"><span class="lineno">   68</span>                                                                <span class="preprocessor">NULL</span><span class="preprocessor">,</span> <span class="preprocessor">code</span> <span class="preprocessor">,</span></div>
<div class="line"><span class="lineno">   69</span>                                                                <span class="preprocessor">MAKELANGID</span><span class="preprocessor">(</span><span class="preprocessor">LANG_NEUTRAL</span><span class="preprocessor">,</span> <span class="preprocessor">SUBLANG_DEFAULT</span><span class="preprocessor">)</span><span class="preprocessor">,</span></div>
<div class="line"><span class="lineno">   70</span>                                                                <span class="preprocessor">(</span><span class="preprocessor">LPWSTR</span><span class="preprocessor">)</span><span class="preprocessor">&amp;</span><span class="preprocessor">s</span><span class="preprocessor">,</span> 0<span class="preprocessor">,</span> <span class="preprocessor">NULL</span><span class="preprocessor">)</span><span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">   71</span>                                                                <span class="keywordtype">char</span> <span class="preprocessor">*</span><span class="preprocessor">netstr</span> <span class="preprocessor">=</span> <span class="preprocessor">wchar_to_char</span><span class="preprocessor">(</span> <span class="preprocessor">s</span> <span class="preprocessor">)</span><span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">   72</span>                                                                <span class="preprocessor">LocalFree</span><span class="preprocessor">(</span> <span class="preprocessor">s</span> <span class="preprocessor">)</span><span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">   73</span>                                                                <span class="preprocessor">netstr</span> <span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">   74</span>                                                                <span class="preprocessor">}</span><span class="preprocessor">)</span></div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span><span class="comment">/* if __GNUC__ &gt; 4 || (__GNUC__ == 4 &amp;&amp; __GNUC_MINOR__ &gt; 5) */</span></div>
<div class="line"><span class="lineno">   78</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">__GNUC__</span> <span class="preprocessor">&lt;=</span> 6 <span class="preprocessor">&amp;&amp;</span> <span class="preprocessor">__GNUC_MINOR__</span> <span class="preprocessor">&lt;=</span> 3</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span><span class="comment">/*--------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">   81</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   82</span><span class="comment">  By Marco Ladino - mladinox.. jan/2016</span></div>
<div class="line"><span class="lineno">   83</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   84</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   85</span><span class="comment">  MinGW 3.45 thru 4.5 versions, don&#39;t have the socket functions:</span></div>
<div class="line"><span class="lineno">   86</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   87</span><span class="comment">  --&gt; inet_ntop(..)</span></div>
<div class="line"><span class="lineno">   88</span><span class="comment">  --&gt; inet_pton(..)</span></div>
<div class="line"><span class="lineno">   89</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   90</span><span class="comment">  But with this adapted code using the original functions from FreeBSD,</span></div>
<div class="line"><span class="lineno">   91</span><span class="comment">  one can to use it in the C/C++ Applications, without problem..!</span></div>
<div class="line"><span class="lineno">   92</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   93</span><span class="comment">  This implementation, include tests for IPV4 and IPV6 addresses,</span></div>
<div class="line"><span class="lineno">   94</span><span class="comment">  and is full C/C++ compatible..</span></div>
<div class="line"><span class="lineno">   95</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   96</span><span class="comment">  --------------------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span><span class="comment">/*              $OpenBSD: strlcpy.c,v 1.11 2006/05/05 15:27:38 millert Exp $    */</span></div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span><span class="comment">/*-</span></div>
<div class="line"><span class="lineno">  102</span><span class="comment"> * Copyright (c) 1998 Todd C. Miller &lt;Todd.Miller@courtesan.com&gt;</span></div>
<div class="line"><span class="lineno">  103</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno">  104</span><span class="comment"> * Permission to use, copy, modify, and distribute this software for any</span></div>
<div class="line"><span class="lineno">  105</span><span class="comment"> * purpose with or without fee is hereby granted, provided that the above</span></div>
<div class="line"><span class="lineno">  106</span><span class="comment"> * copyright notice and this permission notice appear in all copies.</span></div>
<div class="line"><span class="lineno">  107</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno">  108</span><span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span></div>
<div class="line"><span class="lineno">  109</span><span class="comment"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span></div>
<div class="line"><span class="lineno">  110</span><span class="comment"> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span></div>
<div class="line"><span class="lineno">  111</span><span class="comment"> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span></div>
<div class="line"><span class="lineno">  112</span><span class="comment"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span></div>
<div class="line"><span class="lineno">  113</span><span class="comment"> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span></div>
<div class="line"><span class="lineno">  114</span><span class="comment"> * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span></div>
<div class="line"><span class="lineno">  115</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span><span class="comment">//mladinox:: include &lt;sys/cdefs.h&gt;</span></div>
<div class="line"><span class="lineno">  118</span><span class="comment">//mladinox:: __FBSDID(&quot;$FreeBSD: stable/9/sys/libkern/strlcpy.c 243811 2012-12-03 18:08:44Z delphij $&quot;);</span></div>
<div class="line"><span class="lineno">  119</span><span class="comment">//mladinox:: include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="lineno">  120</span><span class="comment">//mladinox:: include &lt;sys/libkern.h&gt;</span></div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">  123</span><span class="comment"> * Copy src to string dst of size siz.  At most siz-1 characters</span></div>
<div class="line"><span class="lineno">  124</span><span class="comment"> * will be copied.  Always NUL terminates (unless siz == 0).</span></div>
<div class="line"><span class="lineno">  125</span><span class="comment"> * Returns strlen(src); if retval &gt;= siz, truncation occurred.</span></div>
<div class="line"><span class="lineno">  126</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  127</span>size_t strlcpy(<span class="keywordtype">char</span> *dst, <span class="keyword">const</span> <span class="keywordtype">char</span> *src, size_t siz)</div>
<div class="line"><span class="lineno">  128</span>{</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordtype">char</span> *d = dst;</div>
<div class="line"><span class="lineno">  130</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = src;</div>
<div class="line"><span class="lineno">  131</span>    size_t n = siz;</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>    <span class="comment">/* Copy as many bytes as will fit */</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">if</span> (n != 0)</div>
<div class="line"><span class="lineno">  135</span>    {</div>
<div class="line"><span class="lineno">  136</span>        <span class="keywordflow">while</span> (--n != 0)</div>
<div class="line"><span class="lineno">  137</span>        {</div>
<div class="line"><span class="lineno">  138</span>            <span class="keywordflow">if</span> ((*d++ = *s++) == <span class="stringliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  139</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  140</span>        }</div>
<div class="line"><span class="lineno">  141</span>    }</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    <span class="comment">/* Not enough room in dst, add NUL and traverse rest of src */</span></div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">if</span> (n == 0)</div>
<div class="line"><span class="lineno">  145</span>    {</div>
<div class="line"><span class="lineno">  146</span>        <span class="keywordflow">if</span> (siz != 0)</div>
<div class="line"><span class="lineno">  147</span>            *d = <span class="stringliteral">&#39;\0&#39;</span>;                          <span class="comment">/* NUL-terminate dst */</span></div>
<div class="line"><span class="lineno">  148</span>        <span class="keywordflow">while</span> (*s++)</div>
<div class="line"><span class="lineno">  149</span>            ;</div>
<div class="line"><span class="lineno">  150</span>    }</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">return</span>(s - src - 1);        <span class="comment">/* count does not include NUL */</span></div>
<div class="line"><span class="lineno">  153</span>}</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">  157</span><span class="comment"> * Copyright (c) 2004 by Internet Systems Consortium, Inc. (&quot;ISC&quot;)</span></div>
<div class="line"><span class="lineno">  158</span><span class="comment"> * Copyright (c) 1996-1999 by Internet Software Consortium.</span></div>
<div class="line"><span class="lineno">  159</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno">  160</span><span class="comment"> * Permission to use, copy, modify, and distribute this software for any</span></div>
<div class="line"><span class="lineno">  161</span><span class="comment"> * purpose with or without fee is hereby granted, provided that the above</span></div>
<div class="line"><span class="lineno">  162</span><span class="comment"> * copyright notice and this permission notice appear in all copies.</span></div>
<div class="line"><span class="lineno">  163</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno">  164</span><span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ISC DISCLAIMS ALL WARRANTIES</span></div>
<div class="line"><span class="lineno">  165</span><span class="comment"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span></div>
<div class="line"><span class="lineno">  166</span><span class="comment"> * MERCHANTABILITY AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR</span></div>
<div class="line"><span class="lineno">  167</span><span class="comment"> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span></div>
<div class="line"><span class="lineno">  168</span><span class="comment"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span></div>
<div class="line"><span class="lineno">  169</span><span class="comment"> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT</span></div>
<div class="line"><span class="lineno">  170</span><span class="comment"> * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span></div>
<div class="line"><span class="lineno">  171</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span><span class="comment">//mladinox:: if defined(LIBC_SCCS) &amp;&amp; !defined(lint)</span></div>
<div class="line"><span class="lineno">  175</span><span class="comment">//mladinox:: static const char rcsid[] = &quot;$Id: inet_ntop.c,v 1.3.18.2 2005/11/03 23:02:22 marka Exp $&quot;;</span></div>
<div class="line"><span class="lineno">  176</span><span class="comment">//mladinox:: endif /* LIBC_SCCS and not lint */</span></div>
<div class="line"><span class="lineno">  177</span><span class="comment">//mladinox:: include &lt;sys/cdefs.h&gt;</span></div>
<div class="line"><span class="lineno">  178</span><span class="comment">//mladinox:: __FBSDID(&quot;$FreeBSD: stable/9/sys/libkern/inet_ntop.c 213103 2010-09-24 15:01:45Z attilio $&quot;);</span></div>
<div class="line"><span class="lineno">  179</span><span class="comment">//mladinox:: include &lt;sys/param.h&gt;</span></div>
<div class="line"><span class="lineno">  180</span><span class="comment">//mladinox:: include &lt;sys/socket.h&gt;</span></div>
<div class="line"><span class="lineno">  181</span><span class="comment">//mladinox:: include &lt;sys/systm.h&gt;</span></div>
<div class="line"><span class="lineno">  182</span><span class="comment">//mladinox:: include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span><span class="comment">/*%</span></div>
<div class="line"><span class="lineno">  185</span><span class="comment"> * WARNING: Don&#39;t even consider trying to compile this on a system where</span></div>
<div class="line"><span class="lineno">  186</span><span class="comment"> * sizeof(int) &lt; 4.  sizeof(int) &gt; 4 is fine; all the world&#39;s not a VAX.</span></div>
<div class="line"><span class="lineno">  187</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span><span class="keyword">static</span> <span class="keywordtype">char</span>     *inet_ntop4(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">char</span> *dst, socklen_t size);</div>
<div class="line"><span class="lineno">  190</span><span class="keyword">static</span> <span class="keywordtype">char</span>     *inet_ntop6(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">char</span> *dst, socklen_t size);</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span><span class="comment">/* char *</span></div>
<div class="line"><span class="lineno">  193</span><span class="comment"> * inet_ntop(af, src, dst, size)</span></div>
<div class="line"><span class="lineno">  194</span><span class="comment"> *              convert a network format address to presentation format.</span></div>
<div class="line"><span class="lineno">  195</span><span class="comment"> * return:</span></div>
<div class="line"><span class="lineno">  196</span><span class="comment"> *              pointer to presentation format address (`dst&#39;), or NULL (see errno).</span></div>
<div class="line"><span class="lineno">  197</span><span class="comment"> * author:</span></div>
<div class="line"><span class="lineno">  198</span><span class="comment"> *              Paul Vixie, 1996.</span></div>
<div class="line"><span class="lineno">  199</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  200</span><span class="keywordtype">char</span> *inet_ntop(<span class="keywordtype">int</span> af, <span class="keyword">const</span> <span class="keywordtype">void</span> *src, <span class="keywordtype">char</span> *dst, socklen_t size)</div>
<div class="line"><span class="lineno">  201</span>{</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">switch</span> (af)</div>
<div class="line"><span class="lineno">  203</span>    {</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">case</span> AF_INET:</div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">return</span> (inet_ntop4((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)src, dst, size));</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">case</span> AF_INET6:</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">return</span> (inet_ntop6((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)src, dst, size));</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><span class="lineno">  210</span>    }</div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">/* NOTREACHED */</span></div>
<div class="line"><span class="lineno">  212</span>}</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span><span class="comment">/* const char *</span></div>
<div class="line"><span class="lineno">  215</span><span class="comment"> * inet_ntop4(src, dst, size)</span></div>
<div class="line"><span class="lineno">  216</span><span class="comment"> *              format an IPv4 address</span></div>
<div class="line"><span class="lineno">  217</span><span class="comment"> * return:</span></div>
<div class="line"><span class="lineno">  218</span><span class="comment"> *              `dst&#39; (as a const)</span></div>
<div class="line"><span class="lineno">  219</span><span class="comment"> * notes:</span></div>
<div class="line"><span class="lineno">  220</span><span class="comment"> *              (1) uses no statics</span></div>
<div class="line"><span class="lineno">  221</span><span class="comment"> *              (2) takes a u_char* not an in_addr as input</span></div>
<div class="line"><span class="lineno">  222</span><span class="comment"> * author:</span></div>
<div class="line"><span class="lineno">  223</span><span class="comment"> *              Paul Vixie, 1996.</span></div>
<div class="line"><span class="lineno">  224</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  225</span><span class="keyword">static</span> <span class="keywordtype">char</span> *inet_ntop4(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">char</span> *dst, socklen_t size)</div>
<div class="line"><span class="lineno">  226</span>{</div>
<div class="line"><span class="lineno">  227</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> fmt[] = <span class="stringliteral">&quot;%u.%u.%u.%u&quot;</span>;</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordtype">char</span> tmp[<span class="keyword">sizeof</span> <span class="stringliteral">&quot;255.255.255.255&quot;</span>];</div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordtype">int</span> l;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>    l = snprintf(tmp, <span class="keyword">sizeof</span>(tmp), fmt, src[0], src[1], src[2], src[3]);</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> (l &lt;= 0 || (socklen_t) l &gt;= size)</div>
<div class="line"><span class="lineno">  233</span>    {</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><span class="lineno">  235</span>    }</div>
<div class="line"><span class="lineno">  236</span>    strlcpy(dst, tmp, size);</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">return</span> (dst);</div>
<div class="line"><span class="lineno">  238</span>}</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span><span class="comment">/* const char *</span></div>
<div class="line"><span class="lineno">  241</span><span class="comment"> * inet_ntop6(src, dst, size)</span></div>
<div class="line"><span class="lineno">  242</span><span class="comment"> *              convert IPv6 binary address into presentation (printable) format</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment"> * author:</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment"> *              Paul Vixie, 1996.</span></div>
<div class="line"><span class="lineno">  245</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  246</span><span class="keyword">static</span> <span class="keywordtype">char</span> *inet_ntop6(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">char</span> *dst, socklen_t size)</div>
<div class="line"><span class="lineno">  247</span>{</div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  249</span><span class="comment">     * Note that int32_t and int16_t need only be &quot;at least&quot; large enough</span></div>
<div class="line"><span class="lineno">  250</span><span class="comment">     * to contain a value of the specified size.  On some systems, like</span></div>
<div class="line"><span class="lineno">  251</span><span class="comment">     * Crays, there is no such thing as an integer variable with 16 bits.</span></div>
<div class="line"><span class="lineno">  252</span><span class="comment">     * Keep this in mind if you think this function should have been coded</span></div>
<div class="line"><span class="lineno">  253</span><span class="comment">     * to use pointer overlays.  All the world&#39;s not a VAX.</span></div>
<div class="line"><span class="lineno">  254</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordtype">char</span> tmp[<span class="keyword">sizeof</span> <span class="stringliteral">&quot;ffff:ffff:ffff:ffff:ffff:ffff:255.255.255.255&quot;</span>], *tp;</div>
<div class="line"><span class="lineno">  256</span>    <span class="keyword">struct</span></div>
<div class="line"><span class="lineno">  257</span>    {</div>
<div class="line"><span class="lineno">  258</span>        <span class="keywordtype">int</span> base, len;</div>
<div class="line"><span class="lineno">  259</span>    } best, cur;</div>
<div class="line"><span class="lineno">  260</span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">NS_IN6ADDRSZ</span>            16</div>
<div class="line"><span class="lineno">  261</span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">NS_INT16SZ</span>              2</div>
<div class="line"><span class="lineno">  262</span>    u_int words[NS_IN6ADDRSZ / NS_INT16SZ];</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">     * Preprocess:</span></div>
<div class="line"><span class="lineno">  267</span><span class="comment">     *          Copy the input (bytewise) array into a wordwise array.</span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">     *          Find the longest run of 0x00&#39;s in src[] for :: shorthanding.</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  270</span>    memset(words, <span class="stringliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span> words);</div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">for</span> (i = 0; i &lt; NS_IN6ADDRSZ; i++)</div>
<div class="line"><span class="lineno">  272</span>        words[i / 2] |= (src[i] &lt;&lt; ((1 - (i % 2)) &lt;&lt; 3));</div>
<div class="line"><span class="lineno">  273</span>    best.base = -1;</div>
<div class="line"><span class="lineno">  274</span>    best.len = 0;</div>
<div class="line"><span class="lineno">  275</span>    cur.base = -1;</div>
<div class="line"><span class="lineno">  276</span>    cur.len = 0;</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">for</span> (i = 0; i &lt; (NS_IN6ADDRSZ / NS_INT16SZ); i++)</div>
<div class="line"><span class="lineno">  278</span>    {</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">if</span> (words[i] == 0)</div>
<div class="line"><span class="lineno">  280</span>        {</div>
<div class="line"><span class="lineno">  281</span>            <span class="keywordflow">if</span> (cur.base == -1)</div>
<div class="line"><span class="lineno">  282</span>                cur.base = i, cur.len = 1;</div>
<div class="line"><span class="lineno">  283</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  284</span>                cur.len++;</div>
<div class="line"><span class="lineno">  285</span>        }</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  287</span>        {</div>
<div class="line"><span class="lineno">  288</span>            <span class="keywordflow">if</span> (cur.base != -1)</div>
<div class="line"><span class="lineno">  289</span>            {</div>
<div class="line"><span class="lineno">  290</span>                <span class="keywordflow">if</span> (best.base == -1 || cur.len &gt; best.len)</div>
<div class="line"><span class="lineno">  291</span>                    best = cur;</div>
<div class="line"><span class="lineno">  292</span>                cur.base = -1;</div>
<div class="line"><span class="lineno">  293</span>            }</div>
<div class="line"><span class="lineno">  294</span>        }</div>
<div class="line"><span class="lineno">  295</span>    }</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">if</span> (cur.base != -1)</div>
<div class="line"><span class="lineno">  297</span>    {</div>
<div class="line"><span class="lineno">  298</span>        <span class="keywordflow">if</span> (best.base == -1 || cur.len &gt; best.len)</div>
<div class="line"><span class="lineno">  299</span>            best = cur;</div>
<div class="line"><span class="lineno">  300</span>    }</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">if</span> (best.base != -1 &amp;&amp; best.len &lt; 2)</div>
<div class="line"><span class="lineno">  302</span>        best.base = -1;</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">     * Format the result.</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  307</span>    tp = tmp;</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">for</span> (i = 0; i &lt; (NS_IN6ADDRSZ / NS_INT16SZ); i++)</div>
<div class="line"><span class="lineno">  309</span>    {</div>
<div class="line"><span class="lineno">  310</span>        <span class="comment">/* Are we inside the best run of 0x00&#39;s? */</span></div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">if</span> (best.base != -1 &amp;&amp; i &gt;= best.base &amp;&amp;</div>
<div class="line"><span class="lineno">  312</span>                i &lt; (best.base + best.len))</div>
<div class="line"><span class="lineno">  313</span>        {</div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordflow">if</span> (i == best.base)</div>
<div class="line"><span class="lineno">  315</span>                *tp++ = <span class="stringliteral">&#39;:&#39;</span>;</div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  317</span>        }</div>
<div class="line"><span class="lineno">  318</span>        <span class="comment">/* Are we following an initial run of 0x00s or any real hex? */</span></div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">if</span> (i != 0)</div>
<div class="line"><span class="lineno">  320</span>            *tp++ = <span class="stringliteral">&#39;:&#39;</span>;</div>
<div class="line"><span class="lineno">  321</span>        <span class="comment">/* Is this address an encapsulated IPv4? */</span></div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">if</span> (i == 6 &amp;&amp; best.base == 0 &amp;&amp; (best.len == 6 ||</div>
<div class="line"><span class="lineno">  323</span>                                         (best.len == 7 &amp;&amp; words[7] != 0x0001) ||</div>
<div class="line"><span class="lineno">  324</span>                                         (best.len == 5 &amp;&amp; words[5] == 0xffff)))</div>
<div class="line"><span class="lineno">  325</span>        {</div>
<div class="line"><span class="lineno">  326</span>            <span class="keywordflow">if</span> (!inet_ntop4(src+12, tp, <span class="keyword">sizeof</span> tmp - (tp - tmp)))</div>
<div class="line"><span class="lineno">  327</span>                <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><span class="lineno">  328</span>            tp += strlen(tp);</div>
<div class="line"><span class="lineno">  329</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  330</span>        }</div>
<div class="line"><span class="lineno">  331</span>        tp += sprintf(tp, <span class="stringliteral">&quot;%x&quot;</span>, words[i]);</div>
<div class="line"><span class="lineno">  332</span>    }</div>
<div class="line"><span class="lineno">  333</span>    <span class="comment">/* Was it a trailing run of 0x00&#39;s? */</span></div>
<div class="line"><span class="lineno">  334</span>    <span class="keywordflow">if</span> (best.base != -1 &amp;&amp; (best.base + best.len) ==</div>
<div class="line"><span class="lineno">  335</span>            (NS_IN6ADDRSZ / NS_INT16SZ))</div>
<div class="line"><span class="lineno">  336</span>        *tp++ = <span class="stringliteral">&#39;:&#39;</span>;</div>
<div class="line"><span class="lineno">  337</span>    *tp++ = <span class="stringliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">     * Check for overflow, copy, and we&#39;re done.</span></div>
<div class="line"><span class="lineno">  341</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">if</span> ((socklen_t)(tp - tmp) &gt; size)</div>
<div class="line"><span class="lineno">  343</span>    {</div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><span class="lineno">  345</span>    }</div>
<div class="line"><span class="lineno">  346</span>    strcpy(dst, tmp);</div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordflow">return</span> (dst);</div>
<div class="line"><span class="lineno">  348</span>}</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span><span class="comment">//----------------</span></div>
<div class="line"><span class="lineno">  352</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment"> * Copyright (c) 2004 by Internet Systems Consortium, Inc. (&quot;ISC&quot;)</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment"> * Copyright (c) 1996,1999 by Internet Software Consortium.</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno">  356</span><span class="comment"> * Permission to use, copy, modify, and distribute this software for any</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment"> * purpose with or without fee is hereby granted, provided that the above</span></div>
<div class="line"><span class="lineno">  358</span><span class="comment"> * copyright notice and this permission notice appear in all copies.</span></div>
<div class="line"><span class="lineno">  359</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno">  360</span><span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ISC DISCLAIMS ALL WARRANTIES</span></div>
<div class="line"><span class="lineno">  361</span><span class="comment"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span></div>
<div class="line"><span class="lineno">  362</span><span class="comment"> * MERCHANTABILITY AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR</span></div>
<div class="line"><span class="lineno">  363</span><span class="comment"> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span></div>
<div class="line"><span class="lineno">  364</span><span class="comment"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span></div>
<div class="line"><span class="lineno">  365</span><span class="comment"> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT</span></div>
<div class="line"><span class="lineno">  366</span><span class="comment"> * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span></div>
<div class="line"><span class="lineno">  367</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span><span class="comment">//mladinox:: if defined(LIBC_SCCS) &amp;&amp; !defined(lint)</span></div>
<div class="line"><span class="lineno">  370</span><span class="comment">//mladinox:: static const char rcsid[] = &quot;$Id: inet_pton.c,v 1.3.18.2 2005/07/28 07:38:07 marka Exp $&quot;;</span></div>
<div class="line"><span class="lineno">  371</span><span class="comment">//mladinox:: endif /* LIBC_SCCS and not lint */</span></div>
<div class="line"><span class="lineno">  372</span><span class="comment">//mladinox:: include &lt;sys/cdefs.h&gt;</span></div>
<div class="line"><span class="lineno">  373</span><span class="comment">//mladinox:: __FBSDID(&quot;$FreeBSD: stable/9/sys/libkern/inet_pton.c 213103 2010-09-24 15:01:45Z attilio $&quot;);</span></div>
<div class="line"><span class="lineno">  374</span><span class="comment">//mladinox:: include &lt;sys/param.h&gt;</span></div>
<div class="line"><span class="lineno">  375</span><span class="comment">//mladinox:: include &lt;sys/socket.h&gt;</span></div>
<div class="line"><span class="lineno">  376</span><span class="comment">//mladinox:: include &lt;sys/systm.h&gt;</span></div>
<div class="line"><span class="lineno">  377</span><span class="comment">//mladinox:: include &lt;netinet/in.h&gt;</span></div>
<div class="line"><span class="lineno">  378</span><span class="comment">//mladinox:: if __FreeBSD_version &lt; 700000</span></div>
<div class="line"><span class="lineno">  379</span><span class="comment">//mladinox:: define strchr index</span></div>
<div class="line"><span class="lineno">  380</span><span class="comment">//mladinox:: endif</span></div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span><span class="comment">/*%</span></div>
<div class="line"><span class="lineno">  383</span><span class="comment"> * WARNING: Don&#39;t even consider trying to compile this on a system where</span></div>
<div class="line"><span class="lineno">  384</span><span class="comment"> * sizeof(int) &lt; 4.  sizeof(int) &gt; 4 is fine; all the world&#39;s not a VAX.</span></div>
<div class="line"><span class="lineno">  385</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span><span class="keyword">static</span> <span class="keywordtype">int</span>      inet_pton4(<span class="keyword">const</span> <span class="keywordtype">char</span> *src, u_char *dst);</div>
<div class="line"><span class="lineno">  388</span><span class="keyword">static</span> <span class="keywordtype">int</span>      inet_pton6(<span class="keyword">const</span> <span class="keywordtype">char</span> *src, u_char *dst);</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span><span class="comment">/* int</span></div>
<div class="line"><span class="lineno">  391</span><span class="comment"> * inet_pton(af, src, dst)</span></div>
<div class="line"><span class="lineno">  392</span><span class="comment"> *              convert from presentation format (which usually means ASCII printable)</span></div>
<div class="line"><span class="lineno">  393</span><span class="comment"> *              to network format (which is usually some kind of binary format).</span></div>
<div class="line"><span class="lineno">  394</span><span class="comment"> * return:</span></div>
<div class="line"><span class="lineno">  395</span><span class="comment"> *              1 if the address was valid for the specified address family</span></div>
<div class="line"><span class="lineno">  396</span><span class="comment"> *              0 if the address wasn&#39;t valid (`dst&#39; is untouched in this case)</span></div>
<div class="line"><span class="lineno">  397</span><span class="comment"> *              -1 if some other error occurred (`dst&#39; is untouched in this case, too)</span></div>
<div class="line"><span class="lineno">  398</span><span class="comment"> * author:</span></div>
<div class="line"><span class="lineno">  399</span><span class="comment"> *              Paul Vixie, 1996.</span></div>
<div class="line"><span class="lineno">  400</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  401</span><span class="keywordtype">int</span> inet_pton(<span class="keywordtype">int</span> af, <span class="keyword">const</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">void</span> *dst)</div>
<div class="line"><span class="lineno">  402</span>{</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">switch</span> (af)</div>
<div class="line"><span class="lineno">  404</span>    {</div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordflow">case</span> AF_INET:</div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">return</span> (inet_pton4(src, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)dst));</div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordflow">case</span> AF_INET6:</div>
<div class="line"><span class="lineno">  408</span>        <span class="keywordflow">return</span> (inet_pton6(src, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)dst));</div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  410</span>        <span class="keywordflow">return</span> (-1);</div>
<div class="line"><span class="lineno">  411</span>    }</div>
<div class="line"><span class="lineno">  412</span>    <span class="comment">/* NOTREACHED */</span></div>
<div class="line"><span class="lineno">  413</span>}</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span><span class="comment">/* int</span></div>
<div class="line"><span class="lineno">  416</span><span class="comment"> * inet_pton4(src, dst)</span></div>
<div class="line"><span class="lineno">  417</span><span class="comment"> *              like inet_aton() but without all the hexadecimal and shorthand.</span></div>
<div class="line"><span class="lineno">  418</span><span class="comment"> * return:</span></div>
<div class="line"><span class="lineno">  419</span><span class="comment"> *              1 if `src&#39; is a valid dotted quad, else 0.</span></div>
<div class="line"><span class="lineno">  420</span><span class="comment"> * notice:</span></div>
<div class="line"><span class="lineno">  421</span><span class="comment"> *              does not touch `dst&#39; unless it&#39;s returning 1.</span></div>
<div class="line"><span class="lineno">  422</span><span class="comment"> * author:</span></div>
<div class="line"><span class="lineno">  423</span><span class="comment"> *              Paul Vixie, 1996.</span></div>
<div class="line"><span class="lineno">  424</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  425</span><span class="keyword">static</span> <span class="keywordtype">int</span> inet_pton4(<span class="keyword">const</span> <span class="keywordtype">char</span> *src, u_char *dst)</div>
<div class="line"><span class="lineno">  426</span>{</div>
<div class="line"><span class="lineno">  427</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> digits[] = <span class="stringliteral">&quot;0123456789&quot;</span>;</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordtype">int</span> saw_digit, octets, ch;</div>
<div class="line"><span class="lineno">  429</span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">NS_INADDRSZ</span>             4</div>
<div class="line"><span class="lineno">  430</span>    u_char tmp[NS_INADDRSZ], *tp;</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    saw_digit = 0;</div>
<div class="line"><span class="lineno">  433</span>    octets = 0;</div>
<div class="line"><span class="lineno">  434</span>    *(tp = tmp) = 0;</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">while</span> ((ch = *src++) != <span class="stringliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  436</span>    {</div>
<div class="line"><span class="lineno">  437</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *pch;</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">if</span> ((pch = strchr(digits, ch)) != NULL)</div>
<div class="line"><span class="lineno">  440</span>        {</div>
<div class="line"><span class="lineno">  441</span>            u_int uiNew = *tp * 10 + (pch - digits);</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>            <span class="keywordflow">if</span> (saw_digit &amp;&amp; *tp == 0)</div>
<div class="line"><span class="lineno">  444</span>                <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordflow">if</span> (uiNew &gt; 255)</div>
<div class="line"><span class="lineno">  446</span>                <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  447</span>            *tp = uiNew;</div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">if</span> (!saw_digit)</div>
<div class="line"><span class="lineno">  449</span>            {</div>
<div class="line"><span class="lineno">  450</span>                <span class="keywordflow">if</span> (++octets &gt; 4)</div>
<div class="line"><span class="lineno">  451</span>                    <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  452</span>                saw_digit = 1;</div>
<div class="line"><span class="lineno">  453</span>            }</div>
<div class="line"><span class="lineno">  454</span>        }</div>
<div class="line"><span class="lineno">  455</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <span class="stringliteral">&#39;.&#39;</span> &amp;&amp; saw_digit)</div>
<div class="line"><span class="lineno">  456</span>        {</div>
<div class="line"><span class="lineno">  457</span>            <span class="keywordflow">if</span> (octets == 4)</div>
<div class="line"><span class="lineno">  458</span>                <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  459</span>            *++tp = 0;</div>
<div class="line"><span class="lineno">  460</span>            saw_digit = 0;</div>
<div class="line"><span class="lineno">  461</span>        }</div>
<div class="line"><span class="lineno">  462</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  463</span>            <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  464</span>    }</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">if</span> (octets &lt; 4)</div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  467</span>    memcpy(dst, tmp, NS_INADDRSZ);</div>
<div class="line"><span class="lineno">  468</span>    <span class="keywordflow">return</span> (1);</div>
<div class="line"><span class="lineno">  469</span>}</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span><span class="comment">/* int</span></div>
<div class="line"><span class="lineno">  472</span><span class="comment"> * inet_pton6(src, dst)</span></div>
<div class="line"><span class="lineno">  473</span><span class="comment"> *              convert presentation level address to network order binary form.</span></div>
<div class="line"><span class="lineno">  474</span><span class="comment"> * return:</span></div>
<div class="line"><span class="lineno">  475</span><span class="comment"> *              1 if `src&#39; is a valid [RFC1884 2.2] address, else 0.</span></div>
<div class="line"><span class="lineno">  476</span><span class="comment"> * notice:</span></div>
<div class="line"><span class="lineno">  477</span><span class="comment"> *              (1) does not touch `dst&#39; unless it&#39;s returning 1.</span></div>
<div class="line"><span class="lineno">  478</span><span class="comment"> *              (2) :: in a full address is silently ignored.</span></div>
<div class="line"><span class="lineno">  479</span><span class="comment"> * credit:</span></div>
<div class="line"><span class="lineno">  480</span><span class="comment"> *              inspired by Mark Andrews.</span></div>
<div class="line"><span class="lineno">  481</span><span class="comment"> * author:</span></div>
<div class="line"><span class="lineno">  482</span><span class="comment"> *              Paul Vixie, 1996.</span></div>
<div class="line"><span class="lineno">  483</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  484</span><span class="keyword">static</span> <span class="keywordtype">int</span> inet_pton6(<span class="keyword">const</span> <span class="keywordtype">char</span> *src, u_char *dst)</div>
<div class="line"><span class="lineno">  485</span>{</div>
<div class="line"><span class="lineno">  486</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> xdigits_l[] = <span class="stringliteral">&quot;0123456789abcdef&quot;</span>,</div>
<div class="line"><span class="lineno">  487</span>                                    xdigits_u[] = <span class="stringliteral">&quot;0123456789ABCDEF&quot;</span>;</div>
<div class="line"><span class="lineno">  488</span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">NS_IN6ADDRSZ</span>            16</div>
<div class="line"><span class="lineno">  489</span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">NS_INT16SZ</span>              2</div>
<div class="line"><span class="lineno">  490</span>    u_char tmp[NS_IN6ADDRSZ], *tp, *endp, *colonp;</div>
<div class="line"><span class="lineno">  491</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *curtok;</div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordtype">int</span> ch, seen_xdigits;</div>
<div class="line"><span class="lineno">  493</span>    u_int val;</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    memset((tp = tmp), <span class="stringliteral">&#39;\0&#39;</span>, NS_IN6ADDRSZ);</div>
<div class="line"><span class="lineno">  496</span>    endp = tp + NS_IN6ADDRSZ;</div>
<div class="line"><span class="lineno">  497</span>    colonp = NULL;</div>
<div class="line"><span class="lineno">  498</span>    <span class="comment">/* Leading :: requires some special handling. */</span></div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordflow">if</span> (*src == <span class="stringliteral">&#39;:&#39;</span>)</div>
<div class="line"><span class="lineno">  500</span>        <span class="keywordflow">if</span> (*++src != <span class="stringliteral">&#39;:&#39;</span>)</div>
<div class="line"><span class="lineno">  501</span>            <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  502</span>    curtok = src;</div>
<div class="line"><span class="lineno">  503</span>    seen_xdigits = 0;</div>
<div class="line"><span class="lineno">  504</span>    val = 0;</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordflow">while</span> ((ch = *src++) != <span class="stringliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  506</span>    {</div>
<div class="line"><span class="lineno">  507</span><span class="keyword">const</span> <span class="keywordtype">char</span> *xdigits :</div>
<div class="line"><span class="lineno">  508</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *pch ;</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordflow">if</span> ((pch = strchr((xdigits = xdigits_l), ch)) == NULL)</div>
<div class="line"><span class="lineno">  511</span>            pch = strchr((xdigits = xdigits_u), ch);</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">if</span> (pch != NULL)</div>
<div class="line"><span class="lineno">  513</span>        {</div>
<div class="line"><span class="lineno">  514</span>            val &lt;&lt;= 4;</div>
<div class="line"><span class="lineno">  515</span>            val |= (pch - xdigits);</div>
<div class="line"><span class="lineno">  516</span>            <span class="keywordflow">if</span> (++seen_xdigits &gt; 4)</div>
<div class="line"><span class="lineno">  517</span>                <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  518</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  519</span>        }</div>
<div class="line"><span class="lineno">  520</span>        <span class="keywordflow">if</span> (ch == <span class="stringliteral">&#39;:&#39;</span>)</div>
<div class="line"><span class="lineno">  521</span>        {</div>
<div class="line"><span class="lineno">  522</span>            curtok = src;</div>
<div class="line"><span class="lineno">  523</span>            <span class="keywordflow">if</span> (!seen_xdigits)</div>
<div class="line"><span class="lineno">  524</span>            {</div>
<div class="line"><span class="lineno">  525</span>                <span class="keywordflow">if</span> (colonp)</div>
<div class="line"><span class="lineno">  526</span>                    <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  527</span>                colonp = tp;</div>
<div class="line"><span class="lineno">  528</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  529</span>            }</div>
<div class="line"><span class="lineno">  530</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*src == <span class="stringliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  531</span>            {</div>
<div class="line"><span class="lineno">  532</span>                <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  533</span>            }</div>
<div class="line"><span class="lineno">  534</span>            <span class="keywordflow">if</span> (tp + NS_INT16SZ &gt; endp)</div>
<div class="line"><span class="lineno">  535</span>                <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  536</span>            *tp++ = (u_char) (val &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><span class="lineno">  537</span>            *tp++ = (u_char) val &amp; 0xff;</div>
<div class="line"><span class="lineno">  538</span>            seen_xdigits = 0;</div>
<div class="line"><span class="lineno">  539</span>            val = 0;</div>
<div class="line"><span class="lineno">  540</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  541</span>        }</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">if</span> (ch == <span class="stringliteral">&#39;.&#39;</span> &amp;&amp; ((tp + NS_INADDRSZ) &lt;= endp) &amp;&amp;</div>
<div class="line"><span class="lineno">  543</span>                inet_pton4(curtok, tp) &gt; 0)</div>
<div class="line"><span class="lineno">  544</span>        {</div>
<div class="line"><span class="lineno">  545</span>            tp += NS_INADDRSZ;</div>
<div class="line"><span class="lineno">  546</span>            seen_xdigits = 0;</div>
<div class="line"><span class="lineno">  547</span>            <span class="keywordflow">break</span>;              <span class="comment">/*%&lt; &#39;\\0&#39; was seen by inet_pton4(). */</span></div>
<div class="line"><span class="lineno">  548</span>        }</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  550</span>    }</div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">if</span> (seen_xdigits)</div>
<div class="line"><span class="lineno">  552</span>    {</div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">if</span> (tp + NS_INT16SZ &gt; endp)</div>
<div class="line"><span class="lineno">  554</span>            <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  555</span>        *tp++ = (u_char) (val &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><span class="lineno">  556</span>        *tp++ = (u_char) val &amp; 0xff;</div>
<div class="line"><span class="lineno">  557</span>    }</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">if</span> (colonp != NULL)</div>
<div class="line"><span class="lineno">  559</span>    {</div>
<div class="line"><span class="lineno">  560</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  561</span><span class="comment">         * Since some memmove()&#39;s erroneously fail to handle</span></div>
<div class="line"><span class="lineno">  562</span><span class="comment">         * overlapping regions, we&#39;ll do the shift by hand.</span></div>
<div class="line"><span class="lineno">  563</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  564</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> n = tp - colonp;</div>
<div class="line"><span class="lineno">  565</span>        <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">if</span> (tp == endp)</div>
<div class="line"><span class="lineno">  568</span>            <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">for</span> (i = 1; i &lt;= n; i++)</div>
<div class="line"><span class="lineno">  570</span>        {</div>
<div class="line"><span class="lineno">  571</span>            endp[- i] = colonp[n - i];</div>
<div class="line"><span class="lineno">  572</span>            colonp[n - i] = 0;</div>
<div class="line"><span class="lineno">  573</span>        }</div>
<div class="line"><span class="lineno">  574</span>        tp = endp;</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">if</span> (tp != endp)</div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">return</span> (0);</div>
<div class="line"><span class="lineno">  578</span>    memcpy(dst, tmp, NS_IN6ADDRSZ);</div>
<div class="line"><span class="lineno">  579</span>    <span class="keywordflow">return</span> (1);</div>
<div class="line"><span class="lineno">  580</span>}</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span><span class="preprocessor">#</span><span class="preprocessor">endif</span> <span class="comment">/* if GCC_VERSION &lt;= 4.5 */</span></div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span><span class="preprocessor">#</span><span class="preprocessor">else</span> <span class="comment">/* ifdef __windows__ */</span></div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">sys</span><span class="preprocessor">/</span><span class="preprocessor">types</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">  587</span><span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">sys</span><span class="preprocessor">/</span><span class="preprocessor">wait</span><span class="preprocessor">.</span><span class="preprocessor">h</span><span class="preprocessor">&gt;</span></div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span><span class="comment">/*! Keep it compatible with bsd like */</span></div>
<div class="line"><span class="lineno"><a class="line" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">  590</a></span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">neterrno</span> <span class="preprocessor">errno</span></div>
<div class="line"><span class="lineno">  591</span><span class="comment">/*! BSD style errno string NO WORKING ON REDHAT */</span></div>
<div class="line"><span class="lineno">  592</span><span class="comment">/* #define netstrerror( code )({ \</span></div>
<div class="line"><span class="lineno">  593</span><span class="comment">   size_t errmsglen = 512 ; // strerrorlen_s( code ) + 1  ; \</span></div>
<div class="line"><span class="lineno">  594</span><span class="comment">   char *errmsg = NULL ; \</span></div>
<div class="line"><span class="lineno">  595</span><span class="comment">   Malloc( errmsg , char , errmsglen ); \</span></div>
<div class="line"><span class="lineno">  596</span><span class="comment">   if( errmsg ) \</span></div>
<div class="line"><span class="lineno">  597</span><span class="comment">   { \</span></div>
<div class="line"><span class="lineno">  598</span><span class="comment">   strerror_s( errmsg , errmsglen , code ); \</span></div>
<div class="line"><span class="lineno">  599</span><span class="comment">   } \</span></div>
<div class="line"><span class="lineno">  600</span><span class="comment">   errmsg ; \</span></div>
<div class="line"><span class="lineno">  601</span><span class="comment">   }) */</span></div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno"><a class="line" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">  603</a></span><span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">netstrerror</span><span class="preprocessor">(</span> <span class="preprocessor">code</span> <span class="preprocessor">)</span><span class="preprocessor">(</span><span class="preprocessor">{</span></div>
<div class="line"><span class="lineno">  604</span>                                <span class="preprocessor">char</span> <span class="preprocessor">*</span><span class="preprocessor">errmsg</span> <span class="preprocessor">=</span> <span class="preprocessor">NULL</span> <span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">  605</span>                                <span class="preprocessor">errno</span> <span class="preprocessor">=</span> 0 <span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">  606</span>                                <span class="preprocessor">errmsg</span> <span class="preprocessor">=</span> <span class="preprocessor">strdup</span><span class="preprocessor">(</span> <span class="preprocessor">strerror</span><span class="preprocessor">(</span> <span class="preprocessor">code</span> <span class="preprocessor">)</span> <span class="preprocessor">)</span><span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">  607</span>                                <span class="preprocessor">if</span><span class="preprocessor">(</span> <span class="preprocessor">errno</span> <span class="preprocessor">==</span> <span class="preprocessor">ENOMEM</span> <span class="preprocessor">)</span></div>
<div class="line"><span class="lineno">  608</span>                                <span class="preprocessor">{</span></div>
<div class="line"><span class="lineno">  609</span>                                <span class="preprocessor">errmsg</span> <span class="preprocessor">=</span> <span class="preprocessor">NULL</span> <span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">  610</span>                                <span class="preprocessor">}</span></div>
<div class="line"><span class="lineno">  611</span>                                <span class="preprocessor">errmsg</span> <span class="preprocessor">;</span></div>
<div class="line"><span class="lineno">  612</span>                                <span class="preprocessor">}</span><span class="preprocessor">)</span></div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno"><a class="line" href="n__network_8c.html#a6d493e1a8e3717c37b3186b2f63acbb2">  614</a></span><span class="keywordtype">void</span> netw_sigchld_handler( <span class="keywordtype">int</span> sig )</div>
<div class="line"><span class="lineno">  615</span>{</div>
<div class="line"><span class="lineno">  616</span>    <span class="comment">// waitpid() might overwrite errno, so we save and restore it:</span></div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordtype">int</span> saved_errno = errno;</div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">while</span>(waitpid(-1, NULL, WNOHANG) &gt; 0);</div>
<div class="line"><span class="lineno">  619</span>    errno = saved_errno;</div>
<div class="line"><span class="lineno">  620</span>    n_log( LOG_DEBUG, <span class="stringliteral">&quot;Signal %d&quot;</span>, sig );</div>
<div class="line"><span class="lineno">  621</span>}</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span><span class="preprocessor">#</span><span class="preprocessor">endif</span> <span class="comment">/* ifndef windows */</span></div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span><span class="comment">/*!\fn NETWORK *netw_new( int send_list_limit , int recv_list_limit )</span></div>
<div class="line"><span class="lineno">  626</span><span class="comment"> *\brief Return an empty allocated network ready to be netw_closed</span></div>
<div class="line"><span class="lineno">  627</span><span class="comment"> *\param send_list_limit Thread engine number of tosend message limit</span></div>
<div class="line"><span class="lineno">  628</span><span class="comment"> *\param recv_list_limit Thread engine number of received message limit</span></div>
<div class="line"><span class="lineno">  629</span><span class="comment"> *\return NULL or a new empty network</span></div>
<div class="line"><span class="lineno">  630</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">  631</a></span><a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *<a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">netw_new</a>( <span class="keywordtype">int</span> send_list_limit, <span class="keywordtype">int</span> recv_list_limit )</div>
<div class="line"><span class="lineno">  632</span>{</div>
<div class="line"><span class="lineno">  633</span>    <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw = NULL ;</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( netw, <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a>, 1 );</div>
<div class="line"><span class="lineno">  636</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>    <span class="comment">/* netw itself */</span></div>
<div class="line"><span class="lineno">  639</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a1db8130fdbab7a8cc7d88c9f40ef7c77">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a1db8130fdbab7a8cc7d88c9f40ef7c77">nb_pending</a> = -1 ;</div>
<div class="line"><span class="lineno">  640</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af8205e18871cd24122c77e82b3310179">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af8205e18871cd24122c77e82b3310179">mode</a> = -1 ;</div>
<div class="line"><span class="lineno">  641</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">user_id</a> = -1 ;</div>
<div class="line"><span class="lineno">  642</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">nb_running_threads</a> = 0 ;</div>
<div class="line"><span class="lineno">  643</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">state</a> = NETW_EXITED ;</div>
<div class="line"><span class="lineno">  644</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">threaded_engine_status</a> = NETW_THR_ENGINE_STOPPED ;</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="comment">/* netw -&gt; link */</span></div>
<div class="line"><span class="lineno">  647</span>    netw -&gt; link . sock = -1 ;</div>
<div class="line"><span class="lineno">  648</span>    netw -&gt; link . port =</div>
<div class="line"><span class="lineno">  649</span>        netw -&gt; link . ip = NULL ;</div>
<div class="line"><span class="lineno">  650</span>    memset( &amp;netw -&gt; link . hints, 0, <span class="keyword">sizeof</span>( <span class="keyword">struct</span> addrinfo ) );</div>
<div class="line"><span class="lineno">  651</span>    memset( &amp;netw -&gt; link . raddr, 0, <span class="keyword">sizeof</span>( <span class="keyword">struct</span> sockaddr_storage ) );</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <span class="comment">/*initiliaze mutexs*/</span></div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">if</span> ( pthread_mutex_init( &amp;netw -&gt; sendbolt, NULL ) != 0 )</div>
<div class="line"><span class="lineno">  655</span>    {</div>
<div class="line"><span class="lineno">  656</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error initializing netw -&gt; sendbolt&quot;</span> );</div>
<div class="line"><span class="lineno">  657</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( netw );</div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  659</span>    }</div>
<div class="line"><span class="lineno">  660</span>    <span class="comment">/*initiliaze mutexs*/</span></div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordflow">if</span> ( pthread_mutex_init( &amp;netw -&gt; recvbolt, NULL ) != 0 )</div>
<div class="line"><span class="lineno">  662</span>    {</div>
<div class="line"><span class="lineno">  663</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error initializing netw -&gt; recvbolt&quot;</span> );</div>
<div class="line"><span class="lineno">  664</span>        pthread_mutex_destroy( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno">  665</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( netw );</div>
<div class="line"><span class="lineno">  666</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  667</span>    }</div>
<div class="line"><span class="lineno">  668</span>    <span class="comment">/*initiliaze mutexs*/</span></div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> ( pthread_mutex_init( &amp;netw -&gt; eventbolt, NULL ) != 0 )</div>
<div class="line"><span class="lineno">  670</span>    {</div>
<div class="line"><span class="lineno">  671</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error initializing netw -&gt; eventbolt&quot;</span> );</div>
<div class="line"><span class="lineno">  672</span>        pthread_mutex_destroy( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno">  673</span>        pthread_mutex_destroy( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno">  674</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( netw );</div>
<div class="line"><span class="lineno">  675</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  676</span>    }</div>
<div class="line"><span class="lineno">  677</span>    <span class="comment">/* initialize send sem bolt */</span></div>
<div class="line"><span class="lineno">  678</span>    <span class="keywordflow">if</span>( sem_init(&amp;netw -&gt; send_blocker, 0, 0 ) != 0 )</div>
<div class="line"><span class="lineno">  679</span>    {</div>
<div class="line"><span class="lineno">  680</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error initializing netw -&gt; eventbolt&quot;</span> );</div>
<div class="line"><span class="lineno">  681</span>        pthread_mutex_destroy( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno">  682</span>        pthread_mutex_destroy( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno">  683</span>        pthread_mutex_destroy( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno">  684</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( netw );</div>
<div class="line"><span class="lineno">  685</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  686</span>    }</div>
<div class="line"><span class="lineno">  687</span>    <span class="comment">/*initialize queues */</span></div>
<div class="line"><span class="lineno">  688</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a> = <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">new_generic_list</a><a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">(</a> recv_list_limit <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">)</a>;</div>
<div class="line"><span class="lineno">  689</span>    <span class="keywordflow">if</span>( ! netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a> )</div>
<div class="line"><span class="lineno">  690</span>    {</div>
<div class="line"><span class="lineno">  691</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error when creating receive list with %d item limit&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> recv_list_limit );</div>
<div class="line"><span class="lineno">  692</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno">  693</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  694</span>    }</div>
<div class="line"><span class="lineno">  695</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a> = <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">new_generic_list</a><a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">(</a> send_list_limit <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">)</a>;</div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">if</span>( !netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a> )</div>
<div class="line"><span class="lineno">  697</span>    {</div>
<div class="line"><span class="lineno">  698</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error when creating send list with %d item limit&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> send_list_limit );</div>
<div class="line"><span class="lineno">  699</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno">  700</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  701</span>    }</div>
<div class="line"><span class="lineno">  702</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">pools</a> = <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">new_generic_list</a><a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">(</a> -1 <a class="code hl_function" href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">)</a>;</div>
<div class="line"><span class="lineno">  703</span>    <span class="keywordflow">if</span>( !netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">pools</a> )</div>
<div class="line"><span class="lineno">  704</span>    {</div>
<div class="line"><span class="lineno">  705</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error when creating pools list&quot;</span> );</div>
<div class="line"><span class="lineno">  706</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno">  707</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno">  708</span>    }</div>
<div class="line"><span class="lineno">  709</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac8f7cfa2ad7bb499e28b80cd54a1aba0">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac8f7cfa2ad7bb499e28b80cd54a1aba0">addr_infos_loaded</a> = 0 ;</div>
<div class="line"><span class="lineno">  710</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a72517eff4bde08ad4366b5f6248931d6">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a72517eff4bde08ad4366b5f6248931d6">send_queue_consecutive_wait</a> = 0 ;</div>
<div class="line"><span class="lineno">  711</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a23deb42defc105bed87f798888fa9243">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a23deb42defc105bed87f798888fa9243">so_reuseaddr</a> = -1 ;</div>
<div class="line"><span class="lineno">  712</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a8a60485e1460f7cda5522b9382c43018">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a8a60485e1460f7cda5522b9382c43018">tcpnodelay</a> = -1 ;</div>
<div class="line"><span class="lineno">  713</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aae099d39c28749fe6ca1c3c834f16700">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aae099d39c28749fe6ca1c3c834f16700">so_sndbuf</a> = -1 ;</div>
<div class="line"><span class="lineno">  714</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af9cdd850de1d747671ba20c804bd7715">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af9cdd850de1d747671ba20c804bd7715">so_rcvbuf</a> = -1 ;</div>
<div class="line"><span class="lineno">  715</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a7dba80b8f74427985ad4cb4e3504eddb">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a7dba80b8f74427985ad4cb4e3504eddb">so_rcvtimeo</a> = -1 ;</div>
<div class="line"><span class="lineno">  716</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aaf963860be7e103f162fe2cdbf681ec4">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aaf963860be7e103f162fe2cdbf681ec4">so_sndtimeo</a> = -1 ;</div>
<div class="line"><span class="lineno">  717</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ae0c060a264b61e2c11147a101159ca5b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ae0c060a264b61e2c11147a101159ca5b">so_linger</a> = -1 ;</div>
<div class="line"><span class="lineno">  718</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">deplete_timeout</a> = -1 ;</div>
<div class="line"><span class="lineno">  719</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a0eca3f4b7ee3a85432baa0cdb49361a3">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a0eca3f4b7ee3a85432baa0cdb49361a3">crypto_mode</a> = NETW_CRYPTO_NONE ;</div>
<div class="line"><span class="lineno">  720</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aec612b7a36948836e9593464af149d4d">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aec612b7a36948836e9593464af149d4d">crypto_algo</a> = NETW_ENCRYPT_NONE ;</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    netw -&gt; send_data = &amp;send_data;</div>
<div class="line"><span class="lineno">  723</span>    netw -&gt; recv_data = &amp;recv_data;</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>    <span class="comment">/* blocking by default */</span></div>
<div class="line"><span class="lineno">  726</span>    netw -&gt; link . is_blocking = 1 ;</div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordflow">return</span> netw ;</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>} <span class="comment">/* netw_new() */</span></div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span><span class="comment">/*!\fn void *get_in_addr(struct addrinfo *sa)</span></div>
<div class="line"><span class="lineno">  734</span><span class="comment"> *\brief get sockaddr, IPv4 or IPv6</span></div>
<div class="line"><span class="lineno">  735</span><span class="comment"> *\param sa addrinfo to get</span></div>
<div class="line"><span class="lineno">  736</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="n__network_8c.html#ab995208f051c8975b80f13ff2cfeae32">  737</a></span><span class="keywordtype">char</span> *<a class="code hl_function" href="n__network_8c.html#ab995208f051c8975b80f13ff2cfeae32">get_in_addr</a>(<span class="keyword">struct</span> sockaddr *sa)</div>
<div class="line"><span class="lineno">  738</span>{</div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordflow">return</span> sa-&gt;sa_family == AF_INET</div>
<div class="line"><span class="lineno">  740</span>           ? (<span class="keywordtype">char</span> *)&amp;(((<span class="keyword">struct</span> sockaddr_in *)sa)-&gt;sin_addr)</div>
<div class="line"><span class="lineno">  741</span>           : (<span class="keywordtype">char</span> *)&amp;(((<span class="keyword">struct</span> sockaddr_in6 *)sa)-&gt;sin6_addr);</div>
<div class="line"><span class="lineno">  742</span>}</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span><span class="comment">/*!\fn int netw_init_wsa( int mode , int v1 , int v2 )</span></div>
<div class="line"><span class="lineno">  746</span><span class="comment"> *\brief Do not directly use, internal api. Initialize winsock dll loading on windows if needed.</span></div>
<div class="line"><span class="lineno">  747</span><span class="comment"> *\param mode 1 for opening 0 for close 2 for status</span></div>
<div class="line"><span class="lineno">  748</span><span class="comment"> *\param v1 First digit of version requested</span></div>
<div class="line"><span class="lineno">  749</span><span class="comment"> *\param v2 Second digit of version requested</span></div>
<div class="line"><span class="lineno">  750</span><span class="comment"> *\return TRUE on success FALSE on error</span></div>
<div class="line"><span class="lineno">  751</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">  752</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">netw_init_wsa</a>( <span class="keywordtype">int</span> mode, <span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2 )</div>
<div class="line"><span class="lineno">  753</span>{</div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordtype">int</span> compiler_warning_suppressor = 0 ;</div>
<div class="line"><span class="lineno">  755</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">!</span><span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">__linux__</span> <span class="preprocessor">)</span> <span class="preprocessor">&amp;&amp;</span> <span class="preprocessor">!</span><span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">__sun</span> <span class="preprocessor">)</span> <span class="preprocessor">&amp;&amp;</span> <span class="preprocessor">!</span><span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">_AIX</span> <span class="preprocessor">)</span></div>
<div class="line"><span class="lineno">  756</span>    <span class="keyword">static</span> WSADATA WSAdata; <span class="comment">/*WSA world*/</span></div>
<div class="line"><span class="lineno">  757</span>    <span class="keyword">static</span> <span class="keywordtype">int</span> WSA_IS_INITIALIZED = 0; <span class="comment">/*status checking*/</span></div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordflow">switch</span> ( mode )</div>
<div class="line"><span class="lineno">  760</span>    {</div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  762</span>    <span class="comment">/*returning WSA status*/</span></div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordflow">case</span> 2 :</div>
<div class="line"><span class="lineno">  764</span>        <span class="keywordflow">return</span> WSA_IS_INITIALIZED;</div>
<div class="line"><span class="lineno">  765</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  766</span>    <span class="comment">/*loading WSA dll*/</span></div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">case</span> 1 :</div>
<div class="line"><span class="lineno">  768</span>        <span class="keywordflow">if</span> ( WSA_IS_INITIALIZED == 1 )</div>
<div class="line"><span class="lineno">  769</span>            <span class="keywordflow">return</span> TRUE; <span class="comment">/*already loaded*/</span></div>
<div class="line"><span class="lineno">  770</span>        <span class="keywordflow">if</span> ( ( WSAStartup( MAKEWORD( v1, v2 ), &amp;WSAdata ) ) != 0 )</div>
<div class="line"><span class="lineno">  771</span>        {</div>
<div class="line"><span class="lineno">  772</span>            WSA_IS_INITIALIZED = 0;</div>
<div class="line"><span class="lineno">  773</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno">  774</span>        }</div>
<div class="line"><span class="lineno">  775</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  776</span>        {</div>
<div class="line"><span class="lineno">  777</span>            WSA_IS_INITIALIZED = 1 ;</div>
<div class="line"><span class="lineno">  778</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  779</span>        }</div>
<div class="line"><span class="lineno">  780</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  781</span>    <span class="comment">/*unloading (closing) WSA */</span></div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">case</span> 0 :</div>
<div class="line"><span class="lineno">  783</span>        <span class="keywordflow">if</span> ( WSA_IS_INITIALIZED == 0 )</div>
<div class="line"><span class="lineno">  784</span>            <span class="keywordflow">return</span> TRUE; <span class="comment">/*already CLEANED or not loaded */</span></div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">if</span> ( WSACleanup() == 0 )</div>
<div class="line"><span class="lineno">  786</span>        {</div>
<div class="line"><span class="lineno">  787</span>            WSA_IS_INITIALIZED = 0;</div>
<div class="line"><span class="lineno">  788</span>            <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  789</span>        }</div>
<div class="line"><span class="lineno">  790</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  791</span>    } <span class="comment">/*switch(...)*/</span></div>
<div class="line"><span class="lineno">  792</span><span class="preprocessor">#</span><span class="preprocessor">endif</span> <span class="comment">/* ifndef __linux__ __sun _AIX */</span></div>
<div class="line"><span class="lineno">  793</span>    compiler_warning_suppressor = mode + v1 + v2 ;</div>
<div class="line"><span class="lineno">  794</span>    compiler_warning_suppressor = TRUE ;</div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">return</span> compiler_warning_suppressor ;</div>
<div class="line"><span class="lineno">  796</span>} <span class="comment">/*netw_init_wsa(...)*/</span></div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span><span class="comment">/*!\fn int netw_set_blocking( NETWORK *netw , unsigned long int is_blocking )</span></div>
<div class="line"><span class="lineno">  801</span><span class="comment"> *\brief Modify blocking socket mode</span></div>
<div class="line"><span class="lineno">  802</span><span class="comment"> *\param netw The network to configure</span></div>
<div class="line"><span class="lineno">  803</span><span class="comment"> *\param is_blocking 0 NON BLOCk , 1 BLOCK</span></div>
<div class="line"><span class="lineno">  804</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno">  805</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">  806</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">netw_set_blocking</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> is_blocking )</div>
<div class="line"><span class="lineno">  807</span>{</div>
<div class="line"><span class="lineno">  808</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>    <span class="keywordtype">int</span> error = 0 ;</div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">defined</span><span class="preprocessor">(</span><span class="preprocessor">__linux__</span><span class="preprocessor">)</span> <span class="preprocessor">||</span> <span class="preprocessor">defined</span><span class="preprocessor">(</span><span class="preprocessor">__sun</span><span class="preprocessor">)</span></div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordtype">int</span> flags = fcntl( netw -&gt; link . sock, F_GETFL, 0 );</div>
<div class="line"><span class="lineno">  816</span>    <span class="keywordflow">if</span> ( (flags &amp;O_NONBLOCK) &amp;&amp; !is_blocking )</div>
<div class="line"><span class="lineno">  817</span>    {</div>
<div class="line"><span class="lineno">  818</span>        n_log( LOG_DEBUG, <span class="stringliteral">&quot;socket %d was already in non-blocking mode&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno">  819</span>        <span class="comment">/* in case we missed it, let&#39;s update the link mode */</span></div>
<div class="line"><span class="lineno">  820</span>        netw -&gt; link. is_blocking = 0 ;</div>
<div class="line"><span class="lineno">  821</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  822</span>    }</div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordflow">if</span> (!(flags &amp;O_NONBLOCK) &amp;&amp;  is_blocking )</div>
<div class="line"><span class="lineno">  824</span>    {</div>
<div class="line"><span class="lineno">  825</span>        <span class="comment">/* in case we missed it, let&#39;s update the link mode */</span></div>
<div class="line"><span class="lineno">  826</span>        netw -&gt; link. is_blocking = 1 ;</div>
<div class="line"><span class="lineno">  827</span>        n_log( LOG_DEBUG, <span class="stringliteral">&quot;socket %d was already in blocking mode&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno">  828</span>        <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno">  829</span>    }</div>
<div class="line"><span class="lineno">  830</span>    <span class="keywordflow">if</span>( fcntl(netw -&gt; link . sock, F_SETFL, is_blocking ? flags ^ O_NONBLOCK : flags | O_NONBLOCK) == -1 )</div>
<div class="line"><span class="lineno">  831</span>    {</div>
<div class="line"><span class="lineno">  832</span>        error = neterrno ;</div>
<div class="line"><span class="lineno">  833</span>        errmsg = netstrerror( error );</div>
<div class="line"><span class="lineno">  834</span>        n_log( LOG_ERR, <span class="stringliteral">&quot;couldn&#39;t set blocking mode %d on %d: %s&quot;</span>, is_blocking, netw -&gt; link . sock, _str( errmsg ) );</div>
<div class="line"><span class="lineno">  835</span>        FreeNoLog( errmsg );</div>
<div class="line"><span class="lineno">  836</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  837</span>    }</div>
<div class="line"><span class="lineno">  838</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">!</span><span class="preprocessor">defined</span><span class="preprocessor">(</span><span class="preprocessor">__linux__</span><span class="preprocessor">)</span> <span class="preprocessor">&amp;&amp;</span> <span class="preprocessor">!</span><span class="preprocessor">defined</span><span class="preprocessor">(</span><span class="preprocessor">__sun</span><span class="preprocessor">)</span></div>
<div class="line"><span class="lineno">  841</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> blocking = 1 - is_blocking ;</div>
<div class="line"><span class="lineno">  842</span>    <span class="keywordtype">int</span> res = ioctlsocket( netw -&gt; link . sock, FIONBIO, &amp;blocking );</div>
<div class="line"><span class="lineno">  843</span>    error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno">  844</span>    <span class="keywordflow">if</span>( res != NO_ERROR )</div>
<div class="line"><span class="lineno">  845</span>    {</div>
<div class="line"><span class="lineno">  846</span>        errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno">  847</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;ioctlsocket failed with error: %ld , neterrno: %s&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> res<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno">  848</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno">  849</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno">  850</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  851</span>    }</div>
<div class="line"><span class="lineno">  852</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno">  853</span>    netw -&gt; link. is_blocking = is_blocking ;</div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno">  855</span>} <span class="comment">/* netw_set_blocking */</span></div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span><span class="comment">/*!\fn int netw_setsockopt( NETWORK *netw  , int optname , int value )</span></div>
<div class="line"><span class="lineno">  860</span><span class="comment"> *\brief Modify common socket options on the given netw</span></div>
<div class="line"><span class="lineno">  861</span><span class="comment"> *\param netw The socket to configure</span></div>
<div class="line"><span class="lineno">  862</span><span class="comment"> *\param optname NETWORK_DEPLETE_TIMEOUT,NETWORK_CONSECUTIVE_SEND_TIMEOUT ,SO_REUSEADDR,TCP_NODELAY,SO_SNDBUF,SO_RCVBUF,SO_LINGER,SO_RCVTIMEO,SO_SNDTIMEO. Please refer to man setsockopt for details</span></div>
<div class="line"><span class="lineno">  863</span><span class="comment"> *\value The value of the socket parameter</span></div>
<div class="line"><span class="lineno">  864</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno">  865</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa5ed966d8c5844ded549eda41e38c0be">  866</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa5ed966d8c5844ded549eda41e38c0be">netw_setsockopt</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> optname, <span class="keywordtype">int</span> value )</div>
<div class="line"><span class="lineno">  867</span>{</div>
<div class="line"><span class="lineno">  868</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>    <span class="keywordtype">int</span> error = 0 ;</div>
<div class="line"><span class="lineno">  871</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>    <span class="keywordflow">switch</span>( optname )</div>
<div class="line"><span class="lineno">  874</span>    {</div>
<div class="line"><span class="lineno">  875</span>    <span class="keywordflow">case</span> TCP_NODELAY :</div>
<div class="line"><span class="lineno">  876</span>        <span class="keywordflow">if</span>( value &gt;= 0 )</div>
<div class="line"><span class="lineno">  877</span>        {</div>
<div class="line"><span class="lineno">  878</span>            <span class="comment">/* disable naggle algorithm */</span></div>
<div class="line"><span class="lineno">  879</span>            <span class="keywordflow">if</span> ( setsockopt( netw -&gt; link . sock, IPPROTO_TCP, TCP_NODELAY, ( <span class="keyword">const</span> <span class="keywordtype">char</span> * ) &amp;value, <span class="keyword">sizeof</span>( value ) ) == -1 )</div>
<div class="line"><span class="lineno">  880</span>            {</div>
<div class="line"><span class="lineno">  881</span>                error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno">  882</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno">  883</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from setsockopt(TCP_NODELAY) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno">  884</span>                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno">  885</span>                <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  886</span>            }</div>
<div class="line"><span class="lineno">  887</span>        }</div>
<div class="line"><span class="lineno">  888</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a8a60485e1460f7cda5522b9382c43018">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a8a60485e1460f7cda5522b9382c43018">tcpnodelay</a> = value ;</div>
<div class="line"><span class="lineno">  889</span>        <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno">  890</span>    <span class="keywordflow">case</span> SO_SNDBUF :</div>
<div class="line"><span class="lineno">  891</span>        <span class="comment">/* socket sending buffer size */</span></div>
<div class="line"><span class="lineno">  892</span>        <span class="keywordflow">if</span>( value &gt;= 0 )</div>
<div class="line"><span class="lineno">  893</span>        {</div>
<div class="line"><span class="lineno">  894</span>            <span class="keywordflow">if</span> ( setsockopt ( netw -&gt; link . sock, SOL_SOCKET, SO_SNDBUF, ( <span class="keyword">const</span> <span class="keywordtype">char</span> * ) &amp;value, <span class="keyword">sizeof</span>( value ) ) == -1 )</div>
<div class="line"><span class="lineno">  895</span>            {</div>
<div class="line"><span class="lineno">  896</span>                error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno">  897</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno">  898</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from setsockopt(SO_SNDBUF) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno">  899</span>                <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  900</span>            }</div>
<div class="line"><span class="lineno">  901</span>        }</div>
<div class="line"><span class="lineno">  902</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aae099d39c28749fe6ca1c3c834f16700">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aae099d39c28749fe6ca1c3c834f16700">so_sndbuf</a> = value ;</div>
<div class="line"><span class="lineno">  903</span>        <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno">  904</span>    <span class="keywordflow">case</span> SO_RCVBUF :</div>
<div class="line"><span class="lineno">  905</span>        <span class="comment">/* socket receiving buffer */</span></div>
<div class="line"><span class="lineno">  906</span>        <span class="keywordflow">if</span>( value &gt;= 0 )</div>
<div class="line"><span class="lineno">  907</span>        {</div>
<div class="line"><span class="lineno">  908</span>            <span class="keywordflow">if</span> ( setsockopt ( netw -&gt; link . sock, SOL_SOCKET, SO_RCVBUF, ( <span class="keyword">const</span> <span class="keywordtype">char</span> * ) &amp;value, <span class="keyword">sizeof</span>( value ) ) == -1 )</div>
<div class="line"><span class="lineno">  909</span>            {</div>
<div class="line"><span class="lineno">  910</span>                error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno">  911</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno">  912</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from setsockopt(SO_RCVBUF) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno">  913</span>                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno">  914</span>                <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  915</span>            }</div>
<div class="line"><span class="lineno">  916</span>        }</div>
<div class="line"><span class="lineno">  917</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af9cdd850de1d747671ba20c804bd7715">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af9cdd850de1d747671ba20c804bd7715">so_rcvbuf</a> = value ;</div>
<div class="line"><span class="lineno">  918</span>        <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordflow">case</span> SO_REUSEADDR :</div>
<div class="line"><span class="lineno">  920</span>        <span class="comment">/* lose the pesky &quot;Address already in use&quot; error message*/</span></div>
<div class="line"><span class="lineno">  921</span>        <span class="comment">/* Disabled SO_REUSEPORT because not widely supported */</span></div>
<div class="line"><span class="lineno">  922</span>        <span class="keywordflow">if</span> ( setsockopt( netw -&gt; link . sock, SOL_SOCKET, SO_REUSEADDR, (<span class="keywordtype">char</span> *)&amp;value, <span class="keyword">sizeof</span>( value  ) ) == -1 )</div>
<div class="line"><span class="lineno">  923</span>        {</div>
<div class="line"><span class="lineno">  924</span>            error=<a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno">  925</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno">  926</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from setsockopt(SO_REUSEADDR) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno">  927</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno">  928</span>            <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  929</span>        }</div>
<div class="line"><span class="lineno">  930</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a23deb42defc105bed87f798888fa9243">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a23deb42defc105bed87f798888fa9243">so_reuseaddr</a> = value ;</div>
<div class="line"><span class="lineno">  931</span>        <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno">  932</span>    <span class="keywordflow">case</span> SO_LINGER :</div>
<div class="line"><span class="lineno">  933</span>    {</div>
<div class="line"><span class="lineno">  934</span>        <span class="keyword">struct</span> linger ling;</div>
<div class="line"><span class="lineno">  935</span>        <span class="keywordflow">if</span>( value &lt; 0 )</div>
<div class="line"><span class="lineno">  936</span>        {</div>
<div class="line"><span class="lineno">  937</span>            ling.l_onoff=0;</div>
<div class="line"><span class="lineno">  938</span>            ling.l_linger=0;</div>
<div class="line"><span class="lineno">  939</span>        }</div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( value == 0 )</div>
<div class="line"><span class="lineno">  941</span>        {</div>
<div class="line"><span class="lineno">  942</span>            ling.l_onoff=1;</div>
<div class="line"><span class="lineno">  943</span>            ling.l_linger=0;</div>
<div class="line"><span class="lineno">  944</span>        }</div>
<div class="line"><span class="lineno">  945</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  946</span>        {</div>
<div class="line"><span class="lineno">  947</span>            ling.l_onoff=1;</div>
<div class="line"><span class="lineno">  948</span>            ling.l_linger=value;</div>
<div class="line"><span class="lineno">  949</span>        }</div>
<div class="line"><span class="lineno">  950</span><span class="preprocessor">#</span><span class="preprocessor">ifndef</span> __windows__</div>
<div class="line"><span class="lineno">  951</span>        <span class="keywordflow">if</span>( setsockopt(netw -&gt; link . sock, SOL_SOCKET, SO_LINGER, &amp;ling, <span class="keyword">sizeof</span>( ling ) ) == -1 )</div>
<div class="line"><span class="lineno">  952</span>        {</div>
<div class="line"><span class="lineno">  953</span>            error=neterrno ;</div>
<div class="line"><span class="lineno">  954</span>            errmsg = netstrerror( error );</div>
<div class="line"><span class="lineno">  955</span>            n_log( LOG_ERR, <span class="stringliteral">&quot;Error from setsockopt(SO_LINGER) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock,_str( errmsg ) );</div>
<div class="line"><span class="lineno">  956</span>            FreeNoLog( errmsg );</div>
<div class="line"><span class="lineno">  957</span>            <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  958</span>        }</div>
<div class="line"><span class="lineno">  959</span><span class="preprocessor">#</span><span class="preprocessor">else</span></div>
<div class="line"><span class="lineno">  960</span>        <span class="keywordflow">if</span>( setsockopt(netw -&gt; link . sock, SOL_SOCKET, SO_LINGER, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;ling, <span class="keyword">sizeof</span>( ling ) ) == -1 )</div>
<div class="line"><span class="lineno">  961</span>        {</div>
<div class="line"><span class="lineno">  962</span>            error=<a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno">  963</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno">  964</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from setsockopt(SO_LINGER) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock,<a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno">  965</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno">  966</span>            <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  967</span>        }</div>
<div class="line"><span class="lineno">  968</span><span class="preprocessor">#</span><span class="preprocessor">endif</span> <span class="comment">// __windows__</span></div>
<div class="line"><span class="lineno">  969</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ae0c060a264b61e2c11147a101159ca5b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ae0c060a264b61e2c11147a101159ca5b">so_linger</a> = value ;</div>
<div class="line"><span class="lineno">  970</span>    }</div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno">  972</span>    <span class="keywordflow">case</span> SO_RCVTIMEO :</div>
<div class="line"><span class="lineno">  973</span>        <span class="keywordflow">if</span>( value &gt;= 0 )</div>
<div class="line"><span class="lineno">  974</span>        {</div>
<div class="line"><span class="lineno">  975</span><span class="preprocessor">#</span><span class="preprocessor">ifndef</span> __windows__</div>
<div class="line"><span class="lineno">  976</span>            {</div>
<div class="line"><span class="lineno">  977</span>                <span class="keyword">struct</span> timeval tv;</div>
<div class="line"><span class="lineno">  978</span>                tv.tv_sec = value ;</div>
<div class="line"><span class="lineno">  979</span>                tv.tv_usec = 0;</div>
<div class="line"><span class="lineno">  980</span>                <span class="keywordflow">if</span>( setsockopt(netw -&gt; link . sock, SOL_SOCKET, SO_RCVTIMEO, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;tv, <span class="keyword">sizeof</span> tv) == -1 )</div>
<div class="line"><span class="lineno">  981</span>                {</div>
<div class="line"><span class="lineno">  982</span>                    error=neterrno ;</div>
<div class="line"><span class="lineno">  983</span>                    errmsg = netstrerror( error );</div>
<div class="line"><span class="lineno">  984</span>                    n_log( LOG_ERR, <span class="stringliteral">&quot;Error from setsockopt(SO_RCVTIMEO) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, _str( errmsg ) );</div>
<div class="line"><span class="lineno">  985</span>                    FreeNoLog( errmsg );</div>
<div class="line"><span class="lineno">  986</span>                    <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  987</span>                }</div>
<div class="line"><span class="lineno">  988</span>            }</div>
<div class="line"><span class="lineno">  989</span><span class="preprocessor">#</span><span class="preprocessor">else</span></div>
<div class="line"><span class="lineno">  990</span>            <span class="keywordflow">if</span>( setsockopt(netw -&gt; link . sock, SOL_SOCKET, SO_RCVTIMEO, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;value, <span class="keyword">sizeof</span> value ) == -1 )</div>
<div class="line"><span class="lineno">  991</span>            {</div>
<div class="line"><span class="lineno">  992</span>                error=<a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno">  993</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno">  994</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from setsockopt(SO_RCVTIMEO) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno">  995</span>                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno">  996</span>                <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno">  997</span>            }</div>
<div class="line"><span class="lineno">  998</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno">  999</span>        }</div>
<div class="line"><span class="lineno"> 1000</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a7dba80b8f74427985ad4cb4e3504eddb">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a7dba80b8f74427985ad4cb4e3504eddb">so_rcvtimeo</a> = value ;</div>
<div class="line"><span class="lineno"> 1001</span>        <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">case</span> SO_SNDTIMEO :</div>
<div class="line"><span class="lineno"> 1003</span>        <span class="keywordflow">if</span>( value &gt;= 0 )</div>
<div class="line"><span class="lineno"> 1004</span>        {</div>
<div class="line"><span class="lineno"> 1005</span><span class="preprocessor">#</span><span class="preprocessor">ifndef</span> __windows__</div>
<div class="line"><span class="lineno"> 1006</span>            {</div>
<div class="line"><span class="lineno"> 1007</span>                <span class="keyword">struct</span> timeval tv;</div>
<div class="line"><span class="lineno"> 1008</span>                tv.tv_sec = value ;</div>
<div class="line"><span class="lineno"> 1009</span>                tv.tv_usec = 0;</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>                <span class="keywordflow">if</span>( setsockopt(netw -&gt; link . sock, SOL_SOCKET, SO_SNDTIMEO, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;tv, <span class="keyword">sizeof</span> tv) == -1 )</div>
<div class="line"><span class="lineno"> 1012</span>                {</div>
<div class="line"><span class="lineno"> 1013</span>                    error=neterrno ;</div>
<div class="line"><span class="lineno"> 1014</span>                    errmsg = netstrerror( error );</div>
<div class="line"><span class="lineno"> 1015</span>                    n_log( LOG_ERR, <span class="stringliteral">&quot;Error from setsockopt(SO_SNDTIMEO) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, _str( errmsg ) );</div>
<div class="line"><span class="lineno"> 1016</span>                    FreeNoLog( errmsg );</div>
<div class="line"><span class="lineno"> 1017</span>                    <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1018</span>                }</div>
<div class="line"><span class="lineno"> 1019</span>            }</div>
<div class="line"><span class="lineno"> 1020</span><span class="preprocessor">#</span><span class="preprocessor">else</span></div>
<div class="line"><span class="lineno"> 1021</span>            <span class="keywordflow">if</span>( setsockopt(netw -&gt; link . sock, SOL_SOCKET, SO_SNDTIMEO, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;value, <span class="keyword">sizeof</span> value ) == -1 )</div>
<div class="line"><span class="lineno"> 1022</span>            {</div>
<div class="line"><span class="lineno"> 1023</span>                error=<a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1024</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1025</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from setsockopt(SO_SNDTIMEO) on socket %d. neterrno: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1026</span>                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1027</span>                <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1028</span>            }</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 1031</span>        }</div>
<div class="line"><span class="lineno"> 1032</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aaf963860be7e103f162fe2cdbf681ec4">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aaf963860be7e103f162fe2cdbf681ec4">so_sndtimeo</a> = value ;</div>
<div class="line"><span class="lineno"> 1033</span>        <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 1034</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#gae3f625db1d84d26e70b9201d2f3aa062">NETWORK_DEPLETE_TIMEOUT</a>:</div>
<div class="line"><span class="lineno"> 1035</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">deplete_timeout</a> = value ;</div>
<div class="line"><span class="lineno"> 1036</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#gadedaf21e22e67d0f7d27038e069fd6a6">NETWORK_CONSECUTIVE_SEND_TIMEOUT</a>:</div>
<div class="line"><span class="lineno"> 1038</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a72517eff4bde08ad4366b5f6248931d6">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a72517eff4bde08ad4366b5f6248931d6">send_queue_consecutive_wait</a> = value ;</div>
<div class="line"><span class="lineno"> 1039</span>        <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1042</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;%d is not a supported setsockopt&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> optname );</div>
<div class="line"><span class="lineno"> 1043</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1044</span>    }</div>
<div class="line"><span class="lineno"> 1045</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 1046</span>} <span class="comment">/* netw_set_sock_opt */</span></div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span> </div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span><span class="preprocessor">#</span><span class="preprocessor">ifdef</span> <span class="preprocessor">HAVE_OPENSSL</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="comment">/***************************************************************************</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="comment"> *                                  _   _ ____  _</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="comment"> *  Project                     ___| | | |  _ \| |</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="comment"> *                             / __| | | | |_) | |</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="comment"> *                            | (__| |_| |  _ &lt;| |___</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="comment"> *                             \___|\___/|_| \_\_____|</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="comment"> * Copyright (C) 1998 - 2019, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 1060</span><span class="comment"> * This software is licensed as described in the file COPYING, which</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="comment"> * you should have received as part of this distribution. The terms</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="comment"> * are also available at https://curl.haxx.se/docs/copyright.html.</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="comment"> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="comment"> * copies of the Software, and permit persons to whom the Software is</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="comment"> * furnished to do so, under the terms of the COPYING file.</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="comment"> * This software is distributed on an &quot;AS IS&quot; basis, WITHOUT WARRANTY OF ANY</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="comment"> * KIND, either express or implied.</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="comment"> ***************************************************************************/</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="comment">/* &lt;DESC&gt;</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="comment"> * Show the required mutex callback setups for GnuTLS and OpenSSL when using</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="comment"> * libcurl multi-threaded.</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="comment"> * &lt;/DESC&gt;</span></div>
<div class="line"><span class="lineno"> 1076</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="comment">/* A multi-threaded example that uses pthreads and fetches 4 remote files at</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="comment"> * once over HTTPS. The lock callbacks and stuff assume OpenSSL &lt;1.1 or GnuTLS</span></div>
<div class="line"><span class="lineno"> 1079</span><span class="comment"> * (libgcrypt) so far.</span></div>
<div class="line"><span class="lineno"> 1080</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="comment"> * OpenSSL docs for this:</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="comment"> *   https://www.openssl.org/docs/man1.0.2/man3/CRYPTO_num_locks.html</span></div>
<div class="line"><span class="lineno"> 1083</span><span class="comment"> * gcrypt docs for this:</span></div>
<div class="line"><span class="lineno"> 1084</span><span class="comment"> *   https://gnupg.org/documentation/manuals/gcrypt/Multi_002dThreading.html</span></div>
<div class="line"><span class="lineno"> 1085</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span><span class="comment">/* we have this global to let the callback get easy access to it */</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="keyword">static</span> pthread_mutex_t *lockarray;</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span><span class="keyword">static</span> <span class="keywordtype">void</span> lock_callback(<span class="keywordtype">int</span> mode, <span class="keywordtype">int</span> type, <span class="keywordtype">char</span> *file, <span class="keywordtype">int</span> line)</div>
<div class="line"><span class="lineno"> 1091</span>{</div>
<div class="line"><span class="lineno"> 1092</span>    (<span class="keywordtype">void</span>)file;</div>
<div class="line"><span class="lineno"> 1093</span>    (<span class="keywordtype">void</span>)line;</div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordflow">if</span>(mode &amp; CRYPTO_LOCK)</div>
<div class="line"><span class="lineno"> 1095</span>    {</div>
<div class="line"><span class="lineno"> 1096</span>        pthread_mutex_lock(&amp;(lockarray[type]));</div>
<div class="line"><span class="lineno"> 1097</span>    }</div>
<div class="line"><span class="lineno"> 1098</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1099</span>    {</div>
<div class="line"><span class="lineno"> 1100</span>        pthread_mutex_unlock(&amp;(lockarray[type]));</div>
<div class="line"><span class="lineno"> 1101</span>    }</div>
<div class="line"><span class="lineno"> 1102</span>}</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> thread_id(<span class="keywordtype">void</span>)</div>
<div class="line"><span class="lineno"> 1105</span>{</div>
<div class="line"><span class="lineno"> 1106</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ret;</div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>    ret = (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)pthread_self();</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno"> 1110</span>}</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span><span class="keyword">static</span> <span class="keywordtype">void</span> init_locks(<span class="keywordtype">void</span>)</div>
<div class="line"><span class="lineno"> 1113</span>{</div>
<div class="line"><span class="lineno"> 1114</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>    lockarray = (pthread_mutex_t *)OPENSSL_malloc(CRYPTO_num_locks() *</div>
<div class="line"><span class="lineno"> 1117</span>                <span class="keyword">sizeof</span>(pthread_mutex_t));</div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keywordflow">for</span>(i = 0; i&lt;CRYPTO_num_locks(); i++)</div>
<div class="line"><span class="lineno"> 1119</span>    {</div>
<div class="line"><span class="lineno"> 1120</span>        pthread_mutex_init(&amp;(lockarray[i]), NULL);</div>
<div class="line"><span class="lineno"> 1121</span>    }</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>    CRYPTO_set_id_callback((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> (*)())thread_id);</div>
<div class="line"><span class="lineno"> 1124</span>    CRYPTO_set_locking_callback((<span class="keywordtype">void</span> (*)())lock_callback);</div>
<div class="line"><span class="lineno"> 1125</span>}</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span><span class="keyword">static</span> <span class="keywordtype">void</span> kill_locks(<span class="keywordtype">void</span>)</div>
<div class="line"><span class="lineno"> 1128</span>{</div>
<div class="line"><span class="lineno"> 1129</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 1130</span> </div>
<div class="line"><span class="lineno"> 1131</span>    CRYPTO_set_locking_callback(NULL);</div>
<div class="line"><span class="lineno"> 1132</span>    <span class="keywordflow">for</span>(i = 0; i&lt;CRYPTO_num_locks(); i++)</div>
<div class="line"><span class="lineno"> 1133</span>        pthread_mutex_destroy(&amp;(lockarray[i]));</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>    OPENSSL_free(lockarray);</div>
<div class="line"><span class="lineno"> 1136</span>}</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span> </div>
<div class="line"><span class="lineno"> 1139</span><span class="comment">/*!\fn int netw_init_openssl( void )</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="comment"> *\brief Do not directly use, internal api. Initialize openssl</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="comment"> *\return TRUE</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="keywordtype">int</span> netw_init_openssl( <span class="keywordtype">void</span> )</div>
<div class="line"><span class="lineno"> 1144</span>{</div>
<div class="line"><span class="lineno"> 1145</span>    <span class="keyword">static</span> <span class="keywordtype">int</span> OPENSSL_IS_INITIALIZED = 0; <span class="comment">/*status checking*/</span></div>
<div class="line"><span class="lineno"> 1146</span> </div>
<div class="line"><span class="lineno"> 1147</span>    <span class="keywordflow">if</span> ( OPENSSL_IS_INITIALIZED == 1 )</div>
<div class="line"><span class="lineno"> 1148</span>        <span class="keywordflow">return</span> TRUE; <span class="comment">/*already loaded*/</span></div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span><span class="preprocessor">#</span><span class="preprocessor">ifdef</span> <span class="preprocessor">HAVE_OPENSSL</span></div>
<div class="line"><span class="lineno"> 1151</span>    SSL_library_init();</div>
<div class="line"><span class="lineno"> 1152</span>    SSL_load_error_strings();</div>
<div class="line"><span class="lineno"> 1153</span>    ERR_load_BIO_strings();</div>
<div class="line"><span class="lineno"> 1154</span>    OpenSSL_add_all_algorithms();</div>
<div class="line"><span class="lineno"> 1155</span>    OpenSSL_add_all_algorithms();</div>
<div class="line"><span class="lineno"> 1156</span>    init_locks();</div>
<div class="line"><span class="lineno"> 1157</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>    OPENSSL_IS_INITIALIZED = 1 ;</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 1162</span>} <span class="comment">/*netw_init_openssl(...)*/</span></div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span><span class="comment">/*!\fn int netw_unload_openssl( void )</span></div>
<div class="line"><span class="lineno"> 1165</span><span class="comment"> *\brief Do not directly use, internal api. Initialize openssl</span></div>
<div class="line"><span class="lineno"> 1166</span><span class="comment"> *\return TRUE</span></div>
<div class="line"><span class="lineno"> 1167</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"> 1168</span><span class="keywordtype">int</span> netw_init_openssl( <span class="keywordtype">void</span> )</div>
<div class="line"><span class="lineno"> 1169</span>{</div>
<div class="line"><span class="lineno"> 1170</span>    <span class="keyword">static</span> <span class="keywordtype">int</span> OPENSSL_IS_INITIALIZED = 0; <span class="comment">/*status checking*/</span></div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>    <span class="keywordflow">if</span> ( OPENSSL_IS_INITIALIZED == 1 )</div>
<div class="line"><span class="lineno"> 1173</span>        <span class="keywordflow">return</span> TRUE; <span class="comment">/*already loaded*/</span></div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span><span class="preprocessor">#</span><span class="preprocessor">ifdef</span> <span class="preprocessor">HAVE_OPENSSL</span></div>
<div class="line"><span class="lineno"> 1176</span>    SSL_load_error_strings();</div>
<div class="line"><span class="lineno"> 1177</span>    SSL_library_init();</div>
<div class="line"><span class="lineno"> 1178</span>    ERR_load_BIO_strings();</div>
<div class="line"><span class="lineno"> 1179</span>    OpenSSL_add_all_algorithms();</div>
<div class="line"><span class="lineno"> 1180</span>    OpenSSL_add_all_algorithms();</div>
<div class="line"><span class="lineno"> 1181</span>    init_locks();</div>
<div class="line"><span class="lineno"> 1182</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 1183</span> </div>
<div class="line"><span class="lineno"> 1184</span>    OPENSSL_IS_INITIALIZED = 1 ;</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 1187</span>} <span class="comment">/*netw_init_openssl(...)*/</span></div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span><span class="keywordtype">int</span> netw_set_crypto( NETWORK *netw, <span class="keywordtype">char</span> *key, <span class="keywordtype">char</span> *certificat, <span class="keywordtype">char</span> *vigenere )</div>
<div class="line"><span class="lineno"> 1190</span>{</div>
<div class="line"><span class="lineno"> 1191</span>    __n_assert( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>    <span class="keywordflow">if</span>( key &amp;&amp; strlen( key ) &gt; 0 )</div>
<div class="line"><span class="lineno"> 1194</span>    {</div>
<div class="line"><span class="lineno"> 1195</span>        netw -&gt; key = strdup( key );</div>
<div class="line"><span class="lineno"> 1196</span>    }</div>
<div class="line"><span class="lineno"> 1197</span>    <span class="keywordflow">if</span>( certificat &amp;&amp; strlen( certificat ) &gt; 0 )</div>
<div class="line"><span class="lineno"> 1198</span>    {</div>
<div class="line"><span class="lineno"> 1199</span>        netw -&gt; certificat = strdup( certificat );</div>
<div class="line"><span class="lineno"> 1200</span>    }</div>
<div class="line"><span class="lineno"> 1201</span>    <span class="keywordflow">if</span>( vigenere &amp;&amp; strlen( vigenere ) &gt; 0 )</div>
<div class="line"><span class="lineno"> 1202</span>    {</div>
<div class="line"><span class="lineno"> 1203</span>        netw -&gt; vigenere = strdup( vigenere );</div>
<div class="line"><span class="lineno"> 1204</span>    }</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>    netw_init_openssl();</div>
<div class="line"><span class="lineno"> 1207</span> </div>
<div class="line"><span class="lineno"> 1208</span>    netw -&gt; method = TLSv1_2_method();         <span class="comment">/* create new server-method instance */</span></div>
<div class="line"><span class="lineno"> 1209</span>    netw -&gt; ctx    = SSL_CTX_new(method);      <span class="comment">/* create new context from method */</span></div>
<div class="line"><span class="lineno"> 1210</span>    <span class="keywordflow">if</span> ( ctx == NULL )</div>
<div class="line"><span class="lineno"> 1211</span>    {</div>
<div class="line"><span class="lineno"> 1212</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> error = 0 ;</div>
<div class="line"><span class="lineno"> 1213</span>        <span class="keywordflow">while</span>( error = ERR_get_error() )</div>
<div class="line"><span class="lineno"> 1214</span>        {</div>
<div class="line"><span class="lineno"> 1215</span>            n_log( LOG_ERR, <span class="stringliteral">&quot;%s on socket %d&quot;</span>, ERR_reason_error_string( ERR_get_error(), NULL ) );</div>
<div class="line"><span class="lineno"> 1216</span>        }</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>        EVP_CIPHER_CTX_free( netw -&gt; ctx  );</div>
<div class="line"><span class="lineno"> 1219</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1220</span>    }</div>
<div class="line"><span class="lineno"> 1221</span> </div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>} <span class="comment">/* netw_set_crypto */</span></div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span><span class="preprocessor">#</span><span class="preprocessor">endif</span> <span class="comment">// HAVE_OPENSSL WIP</span></div>
<div class="line"><span class="lineno"> 1230</span> </div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span><span class="comment">/*!\fn int netw_connect_ex(NETWORK **netw , char *host , char *port, int send_list_limit , int recv_list_limit , int ip_version )</span></div>
<div class="line"><span class="lineno"> 1234</span><span class="comment"> *\brief Use this to connect a NETWORK to any listening one</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="comment"> *\param netw a NETWORK *object</span></div>
<div class="line"><span class="lineno"> 1236</span><span class="comment"> *\param host Host or IP to connect to</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="comment"> *\param port Port to use to connect</span></div>
<div class="line"><span class="lineno"> 1238</span><span class="comment"> *\param send_list_limit Internal sending list maximum number of item. 0 or negative for unrestricted</span></div>
<div class="line"><span class="lineno"> 1239</span><span class="comment"> *\param recv_list_limit Internal receiving list maximum number of item. 0 or negative for unrestricted</span></div>
<div class="line"><span class="lineno"> 1240</span><span class="comment"> *\param ip_version NETWORK_IPALL for both ipv4 and ipv6 , NETWORK_IPV4 or NETWORK_IPV6</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 1242</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b"> 1243</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">netw_connect_ex</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> **netw, <span class="keywordtype">char</span> *host, <span class="keywordtype">char</span> *port, <span class="keywordtype">int</span> send_list_limit, <span class="keywordtype">int</span> recv_list_limit, <span class="keywordtype">int</span> ip_version )</div>
<div class="line"><span class="lineno"> 1244</span>{</div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordtype">int</span> error = 0, net_status = 0;</div>
<div class="line"><span class="lineno"> 1246</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>    <span class="comment">/*do not work over an already used netw*/</span></div>
<div class="line"><span class="lineno"> 1249</span>    <span class="keywordflow">if</span>( (*netw) )</div>
<div class="line"><span class="lineno"> 1250</span>    {</div>
<div class="line"><span class="lineno"> 1251</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unable to allocate (*netw), already existing. You must use empty NETWORK *structs.&quot;</span> );</div>
<div class="line"><span class="lineno"> 1252</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1253</span>    }</div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>    <span class="comment">/*creating array*/</span></div>
<div class="line"><span class="lineno"> 1256</span>    (*netw) = <a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">netw_new</a><a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">(</a> send_list_limit<a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">,</a> recv_list_limit <a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">)</a>;</div>
<div class="line"><span class="lineno"> 1257</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw&amp;&amp;(*netw), <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment">/*checking WSA when under windows*/</span></div>
<div class="line"><span class="lineno"> 1260</span>    <span class="keywordflow">if</span> ( <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">netw_init_wsa</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">(</a> 1<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">,</a> 2<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">,</a> 2 <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">)</a> == FALSE )</div>
<div class="line"><span class="lineno"> 1261</span>    {</div>
<div class="line"><span class="lineno"> 1262</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unable to load WSA dll&#39;s&quot;</span> );</div>
<div class="line"><span class="lineno"> 1263</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( (*netw) );</div>
<div class="line"><span class="lineno"> 1264</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1265</span>    }</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span>    <span class="comment">/* choose ip version */</span></div>
<div class="line"><span class="lineno"> 1268</span>    <span class="keywordflow">if</span>( ip_version == <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga5f726a9a4d94caeeeff82e4449564d64">NETWORK_IPV4</a> )</div>
<div class="line"><span class="lineno"> 1269</span>    {</div>
<div class="line"><span class="lineno"> 1270</span>        (*netw) -&gt; link . hints . ai_family   = AF_INET ;     <span class="comment">/* Allow IPv4 */</span></div>
<div class="line"><span class="lineno"> 1271</span>    }</div>
<div class="line"><span class="lineno"> 1272</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ip_version == <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga3f93cb2837a5f8d836804f450415d7b8">NETWORK_IPV6</a> )</div>
<div class="line"><span class="lineno"> 1273</span>    {</div>
<div class="line"><span class="lineno"> 1274</span>        (*netw) -&gt; link . hints . ai_family   = AF_INET6 ;     <span class="comment">/* Allow IPv6 */</span></div>
<div class="line"><span class="lineno"> 1275</span>    }</div>
<div class="line"><span class="lineno"> 1276</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1277</span>    {</div>
<div class="line"><span class="lineno"> 1278</span>        <span class="comment">/* NETWORK_ALL or unknown value */</span></div>
<div class="line"><span class="lineno"> 1279</span>        (*netw) -&gt; link . hints . ai_family   = AF_UNSPEC;     <span class="comment">/* Allow IPv4 or IPv6 */</span></div>
<div class="line"><span class="lineno"> 1280</span>    }</div>
<div class="line"><span class="lineno"> 1281</span> </div>
<div class="line"><span class="lineno"> 1282</span>    (*netw) -&gt; link . hints . ai_socktype = SOCK_STREAM;</div>
<div class="line"><span class="lineno"> 1283</span>    (*netw) -&gt; link . hints . ai_protocol = IPPROTO_TCP;</div>
<div class="line"><span class="lineno"> 1284</span>    (*netw) -&gt; link . hints . ai_flags    = AI_PASSIVE;</div>
<div class="line"><span class="lineno"> 1285</span>    (*netw) -&gt; link . hints . ai_canonname = NULL;</div>
<div class="line"><span class="lineno"> 1286</span>    (*netw) -&gt; link . hints . ai_next = NULL;</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>    <span class="comment">/* Note: on some system, i.e Solaris, it WILL show leak in getaddrinfo.</span></div>
<div class="line"><span class="lineno"> 1289</span><span class="comment">     * Testing it inside a 1,100 loop showed not effect on the amount of leaked</span></div>
<div class="line"><span class="lineno"> 1290</span><span class="comment">     * memory */</span></div>
<div class="line"><span class="lineno"> 1291</span>    error = getaddrinfo( host, port, &amp;(*netw) -&gt; link . hints, &amp;(*netw) -&gt; link . rhost );</div>
<div class="line"><span class="lineno"> 1292</span>    <span class="keywordflow">if</span>( error != 0 )</div>
<div class="line"><span class="lineno"> 1293</span>    {</div>
<div class="line"><span class="lineno"> 1294</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error when resolving %s:%s getaddrinfo: %s&quot;</span>, host, port, gai_strerror( error ) );</div>
<div class="line"><span class="lineno"> 1295</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;(*netw) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1296</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1297</span>    }</div>
<div class="line"><span class="lineno"> 1298</span>    (*netw) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac8f7cfa2ad7bb499e28b80cd54a1aba0">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac8f7cfa2ad7bb499e28b80cd54a1aba0">addr_infos_loaded</a> = 1 ;</div>
<div class="line"><span class="lineno"> 1299</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( (*netw) -&gt; link . ip, <span class="keywordtype">char</span>, 64 );</div>
<div class="line"><span class="lineno"> 1300</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( (*netw) -&gt; link . ip, <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;(*netw ) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>; <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span>    <span class="comment">/* getaddrinfo() returns a list of address structures. Try each address until we successfully connect. If socket or connect fails, we close the socket and try the next address. */</span></div>
<div class="line"><span class="lineno"> 1303</span>    <span class="keyword">struct</span> addrinfo *rp = NULL ;</div>
<div class="line"><span class="lineno"> 1304</span>    <span class="keywordflow">for</span>( rp = (*netw) -&gt; link . rhost ; rp != NULL ; rp = rp -&gt; ai_next )</div>
<div class="line"><span class="lineno"> 1305</span>    {</div>
<div class="line"><span class="lineno"> 1306</span>        <span class="keywordtype">int</span> sock = socket( rp -&gt; ai_family, rp -&gt; ai_socktype, rp-&gt;ai_protocol );</div>
<div class="line"><span class="lineno"> 1307</span>        <span class="keywordflow">if</span>( sock == -1 )</div>
<div class="line"><span class="lineno"> 1308</span>        {</div>
<div class="line"><span class="lineno"> 1309</span>            error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1310</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1311</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error while trying to make a socket: %s&quot;</span>, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1312</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1313</span>            <span class="keywordflow">continue</span> ;</div>
<div class="line"><span class="lineno"> 1314</span>        }</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>        (*netw) -&gt; link . sock = sock ;</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span>        net_status = connect( sock, rp -&gt; ai_addr, rp -&gt; ai_addrlen );</div>
<div class="line"><span class="lineno"> 1319</span>        <span class="keywordflow">if</span>( net_status == -1 )</div>
<div class="line"><span class="lineno"> 1320</span>        {</div>
<div class="line"><span class="lineno"> 1321</span>            error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1322</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1323</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#gaeb4f36db01bd128c7afeac5889dac311">LOG_INFO</a>, <span class="stringliteral">&quot;connecting to %s:%s : %s&quot;</span>, host, port, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1324</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1325</span>            closesocket( sock );</div>
<div class="line"><span class="lineno"> 1326</span>            (*netw) -&gt; link . sock = -1 ;</div>
<div class="line"><span class="lineno"> 1327</span>            <span class="keywordflow">continue</span> ;</div>
<div class="line"><span class="lineno"> 1328</span>        }</div>
<div class="line"><span class="lineno"> 1329</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1330</span>        {</div>
<div class="line"><span class="lineno"> 1331</span>            <span class="comment">/*storing connected port and ip adress*/</span></div>
<div class="line"><span class="lineno"> 1332</span>            <span class="keywordflow">if</span>(!inet_ntop( rp-&gt;ai_family, get_in_addr( rp -&gt; ai_addr ), (*netw) -&gt; link . ip, 64 ) )</div>
<div class="line"><span class="lineno"> 1333</span>            {</div>
<div class="line"><span class="lineno"> 1334</span>                error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1335</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1336</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;inet_ntop: %p , %s&quot;</span>, rp, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1337</span>                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1338</span>            }</div>
<div class="line"><span class="lineno"> 1339</span>            <span class="keywordflow">break</span>;                  <span class="comment">/* Success */</span></div>
<div class="line"><span class="lineno"> 1340</span>        }</div>
<div class="line"><span class="lineno"> 1341</span>    }</div>
<div class="line"><span class="lineno"> 1342</span>    <span class="keywordflow">if</span>( rp == NULL )</div>
<div class="line"><span class="lineno"> 1343</span>    {</div>
<div class="line"><span class="lineno"> 1344</span>        <span class="comment">/* No address succeeded */</span></div>
<div class="line"><span class="lineno"> 1345</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Couldn&#39;t connect to %s:%s : no adress succeeded&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> host<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> port );</div>
<div class="line"><span class="lineno"> 1346</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;(*netw) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1347</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1348</span>    }</div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="line"><span class="lineno"> 1350</span>    (*netw)-&gt;link . port = strdup( port );</div>
<div class="line"><span class="lineno"> 1351</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( (*netw) -&gt; link . port, <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;(*netw ) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>; <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span><span class="preprocessor">#</span><span class="preprocessor">ifdef</span> <span class="preprocessor">HAVE_OPENSSL</span></div>
<div class="line"><span class="lineno"> 1354</span>    (*netw) -&gt; key = NULL ;</div>
<div class="line"><span class="lineno"> 1355</span>    (*netw) -&gt; certificat = NULL ;</div>
<div class="line"><span class="lineno"> 1356</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span>    (*netw) -&gt; vigenere_key = NULL ;</div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Connected to %s:%s&quot;</span>, (*netw) -&gt; link . ip, (*netw) -&gt; link . port );</div>
<div class="line"><span class="lineno"> 1362</span> </div>
<div class="line"><span class="lineno"> 1363</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> (*netw)<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_CLIENT|NETW_RUN|NETW_THR_ENGINE_STOPPED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 1366</span>} <span class="comment">/* netw_connect_ex(...)*/</span></div>
<div class="line"><span class="lineno"> 1367</span> </div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span> </div>
<div class="line"><span class="lineno"> 1370</span><span class="comment">/*!\fn int netw_connect( NETWORK **netw , char *host , char *port , int ip_version )</span></div>
<div class="line"><span class="lineno"> 1371</span><span class="comment"> *\brief Use this to connect a NETWORK to any listening one, unrestricted send/recv lists</span></div>
<div class="line"><span class="lineno"> 1372</span><span class="comment"> *\param netw a NETWORK *object</span></div>
<div class="line"><span class="lineno"> 1373</span><span class="comment"> *\param host Host or IP to connect to</span></div>
<div class="line"><span class="lineno"> 1374</span><span class="comment"> *\param port Port to use to connect</span></div>
<div class="line"><span class="lineno"> 1375</span><span class="comment"> *\param ip_version NETWORK_IPALL for both ipv4 and ipv6 , NETWORK_IPV4 or NETWORK_IPV6</span></div>
<div class="line"><span class="lineno"> 1376</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 1377</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gae18d52a130063ba1fd0a4cf4b6a2da20"> 1378</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gae18d52a130063ba1fd0a4cf4b6a2da20">netw_connect</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> **netw, <span class="keywordtype">char</span> *host, <span class="keywordtype">char</span> *port, <span class="keywordtype">int</span> ip_version )</div>
<div class="line"><span class="lineno"> 1379</span>{</div>
<div class="line"><span class="lineno"> 1380</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#gaeb4f36db01bd128c7afeac5889dac311">LOG_INFO</a>, <span class="stringliteral">&quot;Trying to connect to %s : %s&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( host )<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( port ) );</div>
<div class="line"><span class="lineno"> 1381</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">netw_connect_ex</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">(</a> &amp;(*netw)<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">,</a> host<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">,</a> port<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">,</a> -1<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">,</a> -1<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">,</a> ip_version <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">)</a>;</div>
<div class="line"><span class="lineno"> 1382</span>} <span class="comment">/* netw_connect() */</span></div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span> </div>
<div class="line"><span class="lineno"> 1386</span><span class="comment">/*!\fn int netw_get_state( NETWORK *netw , int *state , int *thr_engine_status )</span></div>
<div class="line"><span class="lineno"> 1387</span><span class="comment"> *\brief Get the state of a network</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="comment"> *\param netw The NETWORK *connection to query</span></div>
<div class="line"><span class="lineno"> 1389</span><span class="comment"> *\param state pointer to network status storage , NETW_RUN , NETW_EXIT_ASKED , NETW_EXITED</span></div>
<div class="line"><span class="lineno"> 1390</span><span class="comment"> *\param thr_engine_status pointer to network thread engine status storage ,NETW_THR_ENGINE_STARTED , NETW_THR_ENGINE_STOPPED</span></div>
<div class="line"><span class="lineno"> 1391</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 1392</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db"> 1393</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">netw_get_state</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> *state, <span class="keywordtype">int</span> *thr_engine_status )</div>
<div class="line"><span class="lineno"> 1394</span>{</div>
<div class="line"><span class="lineno"> 1395</span>    <span class="keywordflow">if</span>( netw )</div>
<div class="line"><span class="lineno"> 1396</span>    {</div>
<div class="line"><span class="lineno"> 1397</span>        pthread_mutex_lock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1398</span>        <span class="keywordflow">if</span>( state )</div>
<div class="line"><span class="lineno"> 1399</span>            (*state) = netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">state</a> ;</div>
<div class="line"><span class="lineno"> 1400</span>        <span class="keywordflow">if</span>( thr_engine_status )</div>
<div class="line"><span class="lineno"> 1401</span>            (*thr_engine_status) = netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">threaded_engine_status</a> ;</div>
<div class="line"><span class="lineno"> 1402</span>        pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1403</span>        <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 1404</span>    }</div>
<div class="line"><span class="lineno"> 1405</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1406</span>    {</div>
<div class="line"><span class="lineno"> 1407</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Can&#39;t get status of a NULL network&quot;</span> );</div>
<div class="line"><span class="lineno"> 1408</span>    }</div>
<div class="line"><span class="lineno"> 1409</span>    <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1410</span>} <span class="comment">/*netw_get_state() */</span></div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span> </div>
<div class="line"><span class="lineno"> 1414</span><span class="comment">/*!\fn int netw_set( NETWORK *netw , int flag )</span></div>
<div class="line"><span class="lineno"> 1415</span><span class="comment"> *\brief Restart or reset the specified network ability</span></div>
<div class="line"><span class="lineno"> 1416</span><span class="comment"> *\param netw The NETWORK *connection to modify</span></div>
<div class="line"><span class="lineno"> 1417</span><span class="comment"> *\param flag NETW_EMPTY_SENDBUF, NETW_EMPTY_RECVBUF, NETW_RUN , NETW_EXIT_ASKED , NETW_EXITED</span></div>
<div class="line"><span class="lineno"> 1418</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 1419</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33"> 1420</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> flag )</div>
<div class="line"><span class="lineno"> 1421</span>{</div>
<div class="line"><span class="lineno"> 1422</span>    <span class="keywordflow">if</span>( flag &amp; NETW_EMPTY_SENDBUF )</div>
<div class="line"><span class="lineno"> 1423</span>    {</div>
<div class="line"><span class="lineno"> 1424</span>        pthread_mutex_lock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1425</span>        <span class="keywordflow">if</span>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a> )</div>
<div class="line"><span class="lineno"> 1426</span>            <a class="code hl_function" href="group___l_i_s_t.html#ga1dafe7a250ddad51fadd375f057287e7">list_empty</a><a class="code hl_function" href="group___l_i_s_t.html#ga1dafe7a250ddad51fadd375f057287e7">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a> <a class="code hl_function" href="group___l_i_s_t.html#ga1dafe7a250ddad51fadd375f057287e7">)</a>;</div>
<div class="line"><span class="lineno"> 1427</span>        pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1428</span>    };</div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordflow">if</span>( flag &amp; NETW_EMPTY_RECVBUF )</div>
<div class="line"><span class="lineno"> 1430</span>    {</div>
<div class="line"><span class="lineno"> 1431</span>        pthread_mutex_lock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 1432</span>        <span class="keywordflow">if</span>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a> )</div>
<div class="line"><span class="lineno"> 1433</span>            <a class="code hl_function" href="group___l_i_s_t.html#ga1dafe7a250ddad51fadd375f057287e7">list_empty</a><a class="code hl_function" href="group___l_i_s_t.html#ga1dafe7a250ddad51fadd375f057287e7">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a> <a class="code hl_function" href="group___l_i_s_t.html#ga1dafe7a250ddad51fadd375f057287e7">)</a>;</div>
<div class="line"><span class="lineno"> 1434</span>        pthread_mutex_unlock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 1435</span>    }</div>
<div class="line"><span class="lineno"> 1436</span>    <span class="keywordflow">if</span>( flag &amp; NETW_DESTROY_SENDBUF )</div>
<div class="line"><span class="lineno"> 1437</span>    {</div>
<div class="line"><span class="lineno"> 1438</span>        pthread_mutex_lock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1439</span>        <span class="keywordflow">if</span>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a> )</div>
<div class="line"><span class="lineno"> 1440</span>            <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">list_destroy</a><a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">(</a> &amp;netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a> <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">)</a>;</div>
<div class="line"><span class="lineno"> 1441</span>        pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1442</span>    };</div>
<div class="line"><span class="lineno"> 1443</span>    <span class="keywordflow">if</span>( flag &amp; NETW_DESTROY_RECVBUF )</div>
<div class="line"><span class="lineno"> 1444</span>    {</div>
<div class="line"><span class="lineno"> 1445</span>        pthread_mutex_lock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 1446</span>        <span class="keywordflow">if</span>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a> )</div>
<div class="line"><span class="lineno"> 1447</span>            <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">list_destroy</a><a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">(</a> &amp;netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a> <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">)</a>;</div>
<div class="line"><span class="lineno"> 1448</span>        pthread_mutex_unlock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 1449</span>    }</div>
<div class="line"><span class="lineno"> 1450</span>    pthread_mutex_lock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordflow">if</span>( flag &amp; NETW_CLIENT )</div>
<div class="line"><span class="lineno"> 1452</span>    {</div>
<div class="line"><span class="lineno"> 1453</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af8205e18871cd24122c77e82b3310179">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af8205e18871cd24122c77e82b3310179">mode</a> = NETW_CLIENT ;</div>
<div class="line"><span class="lineno"> 1454</span>    }</div>
<div class="line"><span class="lineno"> 1455</span>    <span class="keywordflow">if</span>( flag &amp; NETW_SERVER )</div>
<div class="line"><span class="lineno"> 1456</span>    {</div>
<div class="line"><span class="lineno"> 1457</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af8205e18871cd24122c77e82b3310179">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af8205e18871cd24122c77e82b3310179">mode</a> = NETW_SERVER ;</div>
<div class="line"><span class="lineno"> 1458</span>    }</div>
<div class="line"><span class="lineno"> 1459</span>    <span class="keywordflow">if</span>( flag &amp; NETW_RUN )</div>
<div class="line"><span class="lineno"> 1460</span>    {</div>
<div class="line"><span class="lineno"> 1461</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">state</a> = NETW_RUN ;</div>
<div class="line"><span class="lineno"> 1462</span>    }</div>
<div class="line"><span class="lineno"> 1463</span>    <span class="keywordflow">if</span>( flag &amp; NETW_EXITED )</div>
<div class="line"><span class="lineno"> 1464</span>    {</div>
<div class="line"><span class="lineno"> 1465</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">state</a> = NETW_EXITED ;</div>
<div class="line"><span class="lineno"> 1466</span>    }</div>
<div class="line"><span class="lineno"> 1467</span>    <span class="keywordflow">if</span>( flag &amp; NETW_ERROR )</div>
<div class="line"><span class="lineno"> 1468</span>    {</div>
<div class="line"><span class="lineno"> 1469</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">state</a> = NETW_ERROR ;</div>
<div class="line"><span class="lineno"> 1470</span>    }</div>
<div class="line"><span class="lineno"> 1471</span>    <span class="keywordflow">if</span>( flag &amp; NETW_EXIT_ASKED )</div>
<div class="line"><span class="lineno"> 1472</span>    {</div>
<div class="line"><span class="lineno"> 1473</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">state</a> = NETW_EXIT_ASKED ;</div>
<div class="line"><span class="lineno"> 1474</span>    }</div>
<div class="line"><span class="lineno"> 1475</span>    <span class="keywordflow">if</span>( flag &amp; NETW_THR_ENGINE_STARTED )</div>
<div class="line"><span class="lineno"> 1476</span>    {</div>
<div class="line"><span class="lineno"> 1477</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">threaded_engine_status</a> = NETW_THR_ENGINE_STARTED ;</div>
<div class="line"><span class="lineno"> 1478</span>    }</div>
<div class="line"><span class="lineno"> 1479</span>    <span class="keywordflow">if</span>( flag &amp; NETW_THR_ENGINE_STOPPED )</div>
<div class="line"><span class="lineno"> 1480</span>    {</div>
<div class="line"><span class="lineno"> 1481</span>        netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">threaded_engine_status</a> = NETW_THR_ENGINE_STOPPED ;</div>
<div class="line"><span class="lineno"> 1482</span>    }</div>
<div class="line"><span class="lineno"> 1483</span>    pthread_mutex_unlock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 1484</span> </div>
<div class="line"><span class="lineno"> 1485</span>    sem_post( &amp;netw -&gt; send_blocker );</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1488</span>} <span class="comment">/* netw_set(...) */</span></div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span> </div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span><span class="comment">/*!\fn netw_close( NETWORK **netw )</span></div>
<div class="line"><span class="lineno"> 1493</span><span class="comment"> *\brief Closing a specified Network, destroy queues, free the structure</span></div>
<div class="line"><span class="lineno"> 1494</span><span class="comment"> *\param netw A NETWORK *network to close</span></div>
<div class="line"><span class="lineno"> 1495</span><span class="comment"> *\return TRUE on success , FALSE on failure</span></div>
<div class="line"><span class="lineno"> 1496</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a"> 1497</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> **netw )</div>
<div class="line"><span class="lineno"> 1498</span>{</div>
<div class="line"><span class="lineno"> 1499</span>    <span class="keywordtype">int</span> state = 0, thr_engine_status = 0 ;</div>
<div class="line"><span class="lineno"> 1500</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw&amp;&amp;(*netw), <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>    <a class="code hl_define" href="group___l_i_s_t.html#ga55cdaac0dd0f4f4d687607e6679a4634">list_foreach</a>( node, (*netw) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">pools</a> )</div>
<div class="line"><span class="lineno"> 1503</span>    {</div>
<div class="line"><span class="lineno"> 1504</span>        <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *pool = (<a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *)node <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">ptr</a> ;</div>
<div class="line"><span class="lineno"> 1505</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gafc7a91b4be2a997710a2b54037c25168">netw_pool_remove</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gafc7a91b4be2a997710a2b54037c25168">(</a> pool<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gafc7a91b4be2a997710a2b54037c25168">,</a> (*netw) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gafc7a91b4be2a997710a2b54037c25168">)</a>;</div>
<div class="line"><span class="lineno"> 1506</span>    }</div>
<div class="line"><span class="lineno"> 1507</span> </div>
<div class="line"><span class="lineno"> 1508</span>    <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">list_destroy</a><a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">(</a> &amp;(*netw) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">pools</a> <a class="code hl_function" href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">)</a>;</div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">netw_get_state</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">(</a> (*netw)<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;state<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;thr_engine_status <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">)</a>;</div>
<div class="line"><span class="lineno"> 1511</span>    <span class="keywordflow">if</span>( thr_engine_status == NETW_THR_ENGINE_STARTED )</div>
<div class="line"><span class="lineno"> 1512</span>    {</div>
<div class="line"><span class="lineno"> 1513</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga29159184519b3129c0154b1a2c2a3e2f">netw_stop_thr_engine</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga29159184519b3129c0154b1a2c2a3e2f">(</a> (*netw ) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga29159184519b3129c0154b1a2c2a3e2f">)</a>;</div>
<div class="line"><span class="lineno"> 1514</span>    }</div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span>    <span class="comment">/*closing connection*/</span></div>
<div class="line"><span class="lineno"> 1517</span>    <span class="comment">/* Now with end of send fix */</span></div>
<div class="line"><span class="lineno"> 1518</span>    <span class="keywordflow">if</span>( (*netw) -&gt; link . sock != INVALID_SOCKET )</div>
<div class="line"><span class="lineno"> 1519</span>    {</div>
<div class="line"><span class="lineno"> 1520</span>        closesocket( (*netw) -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 1521</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;socket %d closed&quot;</span>, (*netw) -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 1522</span>    }</div>
<div class="line"><span class="lineno"> 1523</span> </div>
<div class="line"><span class="lineno"> 1524</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( (*netw) -&gt; link . ip );</div>
<div class="line"><span class="lineno"> 1525</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( (*netw) -&gt; link . port );</div>
<div class="line"><span class="lineno"> 1526</span><span class="preprocessor">#</span><span class="preprocessor">ifdef</span> <span class="preprocessor">HAVE_OPENSSL</span></div>
<div class="line"><span class="lineno"> 1527</span>    FreeNoLog( (*netw) -&gt; key );</div>
<div class="line"><span class="lineno"> 1528</span>    FreeNoLog( (*netw) -&gt; certificat );</div>
<div class="line"><span class="lineno"> 1529</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 1530</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( (*netw) -&gt; vigenere_key );</div>
<div class="line"><span class="lineno"> 1531</span> </div>
<div class="line"><span class="lineno"> 1532</span>    <span class="keywordflow">if</span>( (*netw) -&gt; link . rhost )</div>
<div class="line"><span class="lineno"> 1533</span>    {</div>
<div class="line"><span class="lineno"> 1534</span>        freeaddrinfo( (*netw) -&gt; link . rhost );</div>
<div class="line"><span class="lineno"> 1535</span>    }</div>
<div class="line"><span class="lineno"> 1536</span> </div>
<div class="line"><span class="lineno"> 1537</span>    <span class="comment">/*list freeing*/</span></div>
<div class="line"><span class="lineno"> 1538</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> (*netw)<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_DESTROY_SENDBUF|NETW_DESTROY_RECVBUF <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>    pthread_mutex_destroy( &amp;(*netw) -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 1541</span>    pthread_mutex_destroy( &amp;(*netw) -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1542</span>    pthread_mutex_destroy( &amp;(*netw) -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 1543</span>    sem_destroy( &amp;(*netw) -&gt; send_blocker );</div>
<div class="line"><span class="lineno"> 1544</span> </div>
<div class="line"><span class="lineno"> 1545</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( (*netw) );</div>
<div class="line"><span class="lineno"> 1546</span> </div>
<div class="line"><span class="lineno"> 1547</span>    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1548</span>} <span class="comment">/* netw_close(...)*/</span></div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span><span class="comment">/*!\fn int deplete_send_buffer( int fd , long timeout )</span></div>
<div class="line"><span class="lineno"> 1553</span><span class="comment"> *\brief wait until the socket is empty or timeout, checking each 100 msec. Not as reliable as expected.</span></div>
<div class="line"><span class="lineno"> 1554</span><span class="comment"> *\param fd socket descriptor</span></div>
<div class="line"><span class="lineno"> 1555</span><span class="comment"> *\timeout timeout value in msec , zero or negative value =&gt; disabled</span></div>
<div class="line"><span class="lineno"> 1556</span><span class="comment"> *\return 0 or the amount of remaining datas in bytes</span></div>
<div class="line"><span class="lineno"> 1557</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="n__network_8c.html#a47e28ca4745f27fc86baf2ce2848d295"> 1558</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="n__network_8c.html#a47e28ca4745f27fc86baf2ce2848d295">deplete_send_buffer</a>( <span class="keywordtype">int</span> fd, <span class="keywordtype">long</span> timeout )</div>
<div class="line"><span class="lineno"> 1559</span>{</div>
<div class="line"><span class="lineno"> 1560</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">__linux__</span> <span class="preprocessor">)</span></div>
<div class="line"><span class="lineno"> 1561</span>    <span class="keywordtype">int</span> outstanding = 0 ;</div>
<div class="line"><span class="lineno"> 1562</span>    <span class="keywordflow">if</span>( timeout &lt;= 0 )</div>
<div class="line"><span class="lineno"> 1563</span>    {</div>
<div class="line"><span class="lineno"> 1564</span>        <span class="keywordflow">return</span> 0 ;</div>
<div class="line"><span class="lineno"> 1565</span>    }</div>
<div class="line"><span class="lineno"> 1566</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; timeout ; it += 100 )</div>
<div class="line"><span class="lineno"> 1567</span>    {</div>
<div class="line"><span class="lineno"> 1568</span>        outstanding = 0 ;</div>
<div class="line"><span class="lineno"> 1569</span>        ioctl(fd, SIOCOUTQ, &amp;outstanding);</div>
<div class="line"><span class="lineno"> 1570</span>        <span class="keywordflow">if</span>(!outstanding)</div>
<div class="line"><span class="lineno"> 1571</span>        {</div>
<div class="line"><span class="lineno"> 1572</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1573</span>        }</div>
<div class="line"><span class="lineno"> 1574</span>        usleep( 100000 );</div>
<div class="line"><span class="lineno"> 1575</span>    }</div>
<div class="line"><span class="lineno"> 1576</span>    <span class="keywordflow">return</span> outstanding ;</div>
<div class="line"><span class="lineno"> 1577</span><span class="preprocessor">#</span><span class="preprocessor">else</span></div>
<div class="line"><span class="lineno"> 1578</span>    (<span class="keywordtype">void</span>)fd;</div>
<div class="line"><span class="lineno"> 1579</span>    (<span class="keywordtype">void</span>)timeout;</div>
<div class="line"><span class="lineno"> 1580</span>    <span class="keywordflow">return</span> 0 ;</div>
<div class="line"><span class="lineno"> 1581</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 1582</span>}</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span><span class="comment">/*!\fn netw_wait_close( NETWORK **netw )</span></div>
<div class="line"><span class="lineno"> 1586</span><span class="comment"> *\brief Wait for peer closing a specified Network, destroy queues, free the structure. Default 30 seconds timeout</span></div>
<div class="line"><span class="lineno"> 1587</span><span class="comment"> *\warning Do not use on the accept socket itself (the server socket) as it will display false errors</span></div>
<div class="line"><span class="lineno"> 1588</span><span class="comment"> *\param netw A NETWORK *network to close</span></div>
<div class="line"><span class="lineno"> 1589</span><span class="comment"> *\return TRUE on success , FALSE on failure</span></div>
<div class="line"><span class="lineno"> 1590</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga60beb772aa298f36d1443a28e3ec5ec8"> 1591</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga60beb772aa298f36d1443a28e3ec5ec8">netw_wait_close</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> **netw )</div>
<div class="line"><span class="lineno"> 1592</span>{</div>
<div class="line"><span class="lineno"> 1593</span>    <span class="comment">// default 30 secs timeout</span></div>
<div class="line"><span class="lineno"> 1594</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga995d9aaabaca026d79f15a9823eaebaf">netw_wait_close_timed</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga995d9aaabaca026d79f15a9823eaebaf">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga995d9aaabaca026d79f15a9823eaebaf">,</a> 30 <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga995d9aaabaca026d79f15a9823eaebaf">)</a>;</div>
<div class="line"><span class="lineno"> 1595</span>} <span class="comment">/* netw_wait_close(...)*/</span></div>
<div class="line"><span class="lineno"> 1596</span> </div>
<div class="line"><span class="lineno"> 1597</span> </div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span><span class="comment">/*!\fn netw_wait_close_timed( NETWORK **netw , int timeout )</span></div>
<div class="line"><span class="lineno"> 1600</span><span class="comment"> *\brief Wait for peer closing a specified Network, destroy queues, free the structure</span></div>
<div class="line"><span class="lineno"> 1601</span><span class="comment"> *\warning Do not use on the accept socket itself (the server socket) as it will display false errors</span></div>
<div class="line"><span class="lineno"> 1602</span><span class="comment"> *\param netw A NETWORK *network to close</span></div>
<div class="line"><span class="lineno"> 1603</span><span class="comment"> *\param timeout timeout in seconds before force close engine</span></div>
<div class="line"><span class="lineno"> 1604</span><span class="comment"> *\return TRUE on success , FALSE on failure</span></div>
<div class="line"><span class="lineno"> 1605</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga995d9aaabaca026d79f15a9823eaebaf"> 1606</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga995d9aaabaca026d79f15a9823eaebaf">netw_wait_close_timed</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> **netw, <span class="keywordtype">int</span> timeout )</div>
<div class="line"><span class="lineno"> 1607</span>{</div>
<div class="line"><span class="lineno"> 1608</span>    <span class="keywordtype">int</span> state = 0, thr_engine_status = 0 ;</div>
<div class="line"><span class="lineno"> 1609</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw&amp;&amp;(*netw), <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1610</span> </div>
<div class="line"><span class="lineno"> 1611</span>    <span class="keywordtype">int</span> error = 0,</div>
<div class="line"><span class="lineno"> 1612</span>        countdown = 0 ;</div>
<div class="line"><span class="lineno"> 1613</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 1614</span>    <span class="keywordtype">int</span> nb_running = 0 ;</div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>    countdown = timeout ;</div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">netw_get_state</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">(</a> (*netw)<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;state<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;thr_engine_status <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">)</a>;</div>
<div class="line"><span class="lineno"> 1619</span>    <span class="keywordflow">if</span>( thr_engine_status == NETW_THR_ENGINE_STARTED )</div>
<div class="line"><span class="lineno"> 1620</span>    {</div>
<div class="line"><span class="lineno"> 1621</span>        <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 1622</span>        {</div>
<div class="line"><span class="lineno"> 1623</span>            pthread_mutex_lock( &amp;(*netw) -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 1624</span>            nb_running = (*netw) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">nb_running_threads</a> ;</div>
<div class="line"><span class="lineno"> 1625</span>            pthread_mutex_unlock( &amp;(*netw) -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 1626</span>            sleep( 1 );</div>
<div class="line"><span class="lineno"> 1627</span>            countdown -- ;</div>
<div class="line"><span class="lineno"> 1628</span>        }</div>
<div class="line"><span class="lineno"> 1629</span>        <span class="keywordflow">while</span>( nb_running &gt; 0 &amp;&amp; countdown &gt; 0 );</div>
<div class="line"><span class="lineno"> 1630</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">netw_get_state</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">(</a> (*netw)<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;state<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;thr_engine_status <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">)</a>;</div>
<div class="line"><span class="lineno"> 1631</span>        <span class="keywordflow">if</span>( countdown == 0 &amp;&amp; nb_running &gt; 0 )</div>
<div class="line"><span class="lineno"> 1632</span>        {</div>
<div class="line"><span class="lineno"> 1633</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;netw %d: %d threads are still running after %d seconds, netw is in state %s (%d)&quot;</span>, (*netw) -&gt; link . sock, nb_running, timeout, <a class="code hl_define" href="group___e_n_u_m_s.html#gaea85b76e3e616598be8af94c93581532">N_ENUM_ENTRY</a>(__netw_code_type,toString)(state), state );</div>
<div class="line"><span class="lineno"> 1634</span>        }</div>
<div class="line"><span class="lineno"> 1635</span>    }</div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span>    <span class="comment">/* wait for close fix */</span></div>
<div class="line"><span class="lineno"> 1638</span>    <span class="keywordflow">if</span>( (*netw) -&gt; link . sock != INVALID_SOCKET )</div>
<div class="line"><span class="lineno"> 1639</span>    {</div>
<div class="line"><span class="lineno"> 1640</span>        <span class="comment">/* inform peer that we have finished */</span></div>
<div class="line"><span class="lineno"> 1641</span>        shutdown( (*netw) -&gt; link . sock, SHUT_WR );</div>
<div class="line"><span class="lineno"> 1642</span>        <span class="keywordtype">int</span> remaining = deplete_send_buffer( (*netw) -&gt; link . sock, (*netw) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">deplete_timeout</a> );</div>
<div class="line"><span class="lineno"> 1643</span>        <span class="keywordflow">if</span>( remaining &gt; 0 )</div>
<div class="line"><span class="lineno"> 1644</span>        {</div>
<div class="line"><span class="lineno"> 1645</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;socket %d (%s:%s) %d octets still in send buffer before closing after a wait of %d seconds&quot;</span>, (*netw) -&gt; link . sock, (*netw) -&gt; link . ip, (*netw) -&gt; link . port, remaining, (<span class="keywordtype">int</span>)(*netw) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">deplete_timeout</a> );</div>
<div class="line"><span class="lineno"> 1646</span>        }</div>
<div class="line"><span class="lineno"> 1647</span>        <span class="comment">/* wait for fin ack */</span></div>
<div class="line"><span class="lineno"> 1648</span>        <span class="keywordtype">char</span> buffer[ 4096 ] = <span class="stringliteral">&quot;&quot;</span> ;</div>
<div class="line"><span class="lineno"> 1649</span>        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; timeout ; it += 100 )</div>
<div class="line"><span class="lineno"> 1650</span>        {</div>
<div class="line"><span class="lineno"> 1651</span>            <span class="keywordtype">int</span> res = 0 ;</div>
<div class="line"><span class="lineno"> 1652</span>            res = recv( (*netw) -&gt; link . sock, buffer, 4096, NETFLAGS );</div>
<div class="line"><span class="lineno"> 1653</span>            <span class="keywordflow">if</span>( !res )</div>
<div class="line"><span class="lineno"> 1654</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1655</span>            <span class="keywordflow">if</span>( res &lt; 0 )</div>
<div class="line"><span class="lineno"> 1656</span>            {</div>
<div class="line"><span class="lineno"> 1657</span>                error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1658</span>                <span class="keywordflow">if</span>( error != ENOTCONN &amp;&amp; error != 10057 &amp;&amp; error != EINTR &amp;&amp; error != ECONNRESET ) <span class="comment">// no an error if already closed</span></div>
<div class="line"><span class="lineno"> 1659</span>                {</div>
<div class="line"><span class="lineno"> 1660</span>                    errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1661</span>                    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;read returned error %d when closing socket %d (%s:%s): %s&quot;</span>, error, (*netw) -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( (*netw) -&gt; link . ip ), (*netw) -&gt; link . port,  <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1662</span>                    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1663</span>                }</div>
<div class="line"><span class="lineno"> 1664</span>                <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 1665</span>            }</div>
<div class="line"><span class="lineno"> 1666</span>            usleep( 100000 );</div>
<div class="line"><span class="lineno"> 1667</span>        }</div>
<div class="line"><span class="lineno"> 1668</span>    }</div>
<div class="line"><span class="lineno"> 1669</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;(*netw) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1670</span> </div>
<div class="line"><span class="lineno"> 1671</span>} <span class="comment">/* netw_wait_close_timed(...)*/</span></div>
<div class="line"><span class="lineno"> 1672</span> </div>
<div class="line"><span class="lineno"> 1673</span> </div>
<div class="line"><span class="lineno"> 1674</span> </div>
<div class="line"><span class="lineno"> 1675</span><span class="comment">/*!\fn int netw_make_listening( NETWORK **netw , char *addr , char *port , int nbpending  , int ip_version )</span></div>
<div class="line"><span class="lineno"> 1676</span><span class="comment"> *\brief Make a NETWORK be a Listening network</span></div>
<div class="line"><span class="lineno"> 1677</span><span class="comment"> *\param netw A NETWORK **network to make listening</span></div>
<div class="line"><span class="lineno"> 1678</span><span class="comment"> *\param addr Adress to bind, NULL for automatic address filling</span></div>
<div class="line"><span class="lineno"> 1679</span><span class="comment"> *\param port For choosing a PORT to listen to</span></div>
<div class="line"><span class="lineno"> 1680</span><span class="comment"> *\param nbpending Number of pending connection when listening</span></div>
<div class="line"><span class="lineno"> 1681</span><span class="comment"> *\param ip_version NETWORK_IPALL for both ipv4 and ipv6 , NETWORK_IPV4 or NETWORK_IPV6</span></div>
<div class="line"><span class="lineno"> 1682</span><span class="comment"> *\return TRUE on success, FALSE on error</span></div>
<div class="line"><span class="lineno"> 1683</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga52afd4f5662c9c8f334d224ae2cdbdf2"> 1684</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga52afd4f5662c9c8f334d224ae2cdbdf2">netw_make_listening</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> **netw, <span class="keywordtype">char</span> *addr, <span class="keywordtype">char</span> *port, <span class="keywordtype">int</span> nbpending, <span class="keywordtype">int</span> ip_version )</div>
<div class="line"><span class="lineno"> 1685</span>{</div>
<div class="line"><span class="lineno"> 1686</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( port, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>    <span class="keywordtype">int</span> error = 0 ;</div>
<div class="line"><span class="lineno"> 1689</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 1690</span> </div>
<div class="line"><span class="lineno"> 1691</span>    <span class="keywordflow">if</span>( *netw )</div>
<div class="line"><span class="lineno"> 1692</span>    {</div>
<div class="line"><span class="lineno"> 1693</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Cannot use an allocated network. Please pass a NULL network to modify&quot;</span> );</div>
<div class="line"><span class="lineno"> 1694</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1695</span>    }</div>
<div class="line"><span class="lineno"> 1696</span> </div>
<div class="line"><span class="lineno"> 1697</span>    <span class="comment">/*checking WSA when under windows*/</span></div>
<div class="line"><span class="lineno"> 1698</span>    <span class="keywordflow">if</span> ( <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">netw_init_wsa</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">(</a> 1<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">,</a> 2<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">,</a> 2 <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">)</a> == FALSE )</div>
<div class="line"><span class="lineno"> 1699</span>    {</div>
<div class="line"><span class="lineno"> 1700</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unable to load WSA dll&#39;s&quot;</span> );</div>
<div class="line"><span class="lineno"> 1701</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1702</span>    }</div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>    (*netw) = <a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">netw_new</a><a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">(</a> -1<a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">,</a> -1 <a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">)</a>;</div>
<div class="line"><span class="lineno"> 1705</span>    (*netw) -&gt; link . port = strdup( port );</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="comment">/*creating array*/</span></div>
<div class="line"><span class="lineno"> 1707</span>    <span class="keywordflow">if</span>( ip_version == <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga5f726a9a4d94caeeeff82e4449564d64">NETWORK_IPV4</a> )</div>
<div class="line"><span class="lineno"> 1708</span>    {</div>
<div class="line"><span class="lineno"> 1709</span>        (*netw) -&gt; link . hints . ai_family   = AF_INET ;     <span class="comment">/* Allow IPv4 */</span></div>
<div class="line"><span class="lineno"> 1710</span>    }</div>
<div class="line"><span class="lineno"> 1711</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ip_version == <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga3f93cb2837a5f8d836804f450415d7b8">NETWORK_IPV6</a> )</div>
<div class="line"><span class="lineno"> 1712</span>    {</div>
<div class="line"><span class="lineno"> 1713</span>        (*netw) -&gt; link . hints . ai_family   = AF_INET6 ;     <span class="comment">/* Allow IPv6 */</span></div>
<div class="line"><span class="lineno"> 1714</span>    }</div>
<div class="line"><span class="lineno"> 1715</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1716</span>    {</div>
<div class="line"><span class="lineno"> 1717</span>        <span class="comment">/* NETWORK_ALL or unknown value */</span></div>
<div class="line"><span class="lineno"> 1718</span>        (*netw) -&gt; link . hints . ai_family   = AF_UNSPEC;     <span class="comment">/* Allow IPv4 or IPv6 */</span></div>
<div class="line"><span class="lineno"> 1719</span>    }</div>
<div class="line"><span class="lineno"> 1720</span>    <span class="keywordflow">if</span>( !addr )</div>
<div class="line"><span class="lineno"> 1721</span>    {</div>
<div class="line"><span class="lineno"> 1722</span>        (*netw) -&gt; link . hints . ai_flags    = AI_PASSIVE;    <span class="comment">/* For wildcard IP address */</span></div>
<div class="line"><span class="lineno"> 1723</span>    }</div>
<div class="line"><span class="lineno"> 1724</span>    (*netw) -&gt; link . hints . ai_socktype = SOCK_STREAM;</div>
<div class="line"><span class="lineno"> 1725</span>    (*netw) -&gt; link . hints . ai_protocol = IPPROTO_TCP;</div>
<div class="line"><span class="lineno"> 1726</span>    (*netw) -&gt; link . hints . ai_canonname = NULL;</div>
<div class="line"><span class="lineno"> 1727</span>    (*netw) -&gt; link . hints . ai_next = NULL;</div>
<div class="line"><span class="lineno"> 1728</span> </div>
<div class="line"><span class="lineno"> 1729</span>    error = getaddrinfo( addr, port, &amp;(*netw) -&gt; link . hints, &amp;(*netw) -&gt; link . rhost );</div>
<div class="line"><span class="lineno"> 1730</span>    <span class="keywordflow">if</span>( error != 0)</div>
<div class="line"><span class="lineno"> 1731</span>    {</div>
<div class="line"><span class="lineno"> 1732</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error when resolving %s:%s getaddrinfo: %s&quot;</span>, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( addr ),  port, gai_strerror( error ) );</div>
<div class="line"><span class="lineno"> 1733</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;(*netw) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1734</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1735</span>    }</div>
<div class="line"><span class="lineno"> 1736</span>    (*netw) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac8f7cfa2ad7bb499e28b80cd54a1aba0">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac8f7cfa2ad7bb499e28b80cd54a1aba0">addr_infos_loaded</a> = 1 ;</div>
<div class="line"><span class="lineno"> 1737</span> </div>
<div class="line"><span class="lineno"> 1738</span>    <span class="comment">/* getaddrinfo() returns a list of address structures.</span></div>
<div class="line"><span class="lineno"> 1739</span><span class="comment">       Try each address until we successfully connect(2).</span></div>
<div class="line"><span class="lineno"> 1740</span><span class="comment">       If socket(2) (or connect(2)) fails, we (close the socket</span></div>
<div class="line"><span class="lineno"> 1741</span><span class="comment">       and) try the next address. */</span></div>
<div class="line"><span class="lineno"> 1742</span>    <span class="keyword">struct</span> addrinfo *rp = NULL ;</div>
<div class="line"><span class="lineno"> 1743</span>    <span class="keywordflow">for</span>( rp = (*netw) -&gt; link . rhost ; rp != NULL ; rp = rp -&gt; ai_next )</div>
<div class="line"><span class="lineno"> 1744</span>    {</div>
<div class="line"><span class="lineno"> 1745</span>        (*netw) -&gt; link . sock = socket( rp -&gt; ai_family, rp -&gt; ai_socktype, rp-&gt;ai_protocol );</div>
<div class="line"><span class="lineno"> 1746</span>        <span class="keywordflow">if</span>( (*netw) -&gt; link . sock == INVALID_SOCKET )</div>
<div class="line"><span class="lineno"> 1747</span>        {</div>
<div class="line"><span class="lineno"> 1748</span>            error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1749</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1750</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error while trying to make a socket: %s&quot;</span>, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1751</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1752</span>            <span class="keywordflow">continue</span> ;</div>
<div class="line"><span class="lineno"> 1753</span>        }</div>
<div class="line"><span class="lineno"> 1754</span>        netw_setsockopt( (*netw), SO_REUSEADDR, 1 );</div>
<div class="line"><span class="lineno"> 1755</span>        <span class="keywordflow">if</span>( bind( (*netw) -&gt; link . sock, rp -&gt; ai_addr, rp -&gt; ai_addrlen ) == 0 )</div>
<div class="line"><span class="lineno"> 1756</span>        {</div>
<div class="line"><span class="lineno"> 1757</span>            <span class="keywordtype">char</span> *ip = NULL ;</div>
<div class="line"><span class="lineno"> 1758</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( ip, <span class="keywordtype">char</span>, 64 );</div>
<div class="line"><span class="lineno"> 1759</span>            <span class="keywordflow">if</span>( !ip )</div>
<div class="line"><span class="lineno"> 1760</span>            {</div>
<div class="line"><span class="lineno"> 1761</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error allocating 64 bytes for ip&quot;</span> );</div>
<div class="line"><span class="lineno"> 1762</span>                netw_close( &amp;(*netw) );</div>
<div class="line"><span class="lineno"> 1763</span>                <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1764</span>            }</div>
<div class="line"><span class="lineno"> 1765</span>            <span class="keywordflow">if</span>( !inet_ntop( rp -&gt; ai_family, get_in_addr( rp -&gt; ai_addr ), ip, 64 ) )</div>
<div class="line"><span class="lineno"> 1766</span>            {</div>
<div class="line"><span class="lineno"> 1767</span>                error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1768</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1769</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;inet_ntop: %p , %s&quot;</span>, (*netw) -&gt; link . raddr, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1770</span>                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1771</span>            }</div>
<div class="line"><span class="lineno"> 1772</span>            <span class="comment">/*n_log( LOG_DEBUG, &quot;Socket %d successfully binded to %s %s&quot;,  (*netw) -&gt; link . sock, _str( ip ) , _str( port ) );*/</span></div>
<div class="line"><span class="lineno"> 1773</span>            (*netw) -&gt; link . ip = ip ;</div>
<div class="line"><span class="lineno"> 1774</span>            <span class="keywordflow">break</span>;                  <span class="comment">/* Success */</span></div>
<div class="line"><span class="lineno"> 1775</span>        }</div>
<div class="line"><span class="lineno"> 1776</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1777</span>        errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1778</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error from bind() on port %s neterrno: %s&quot;</span>, port, <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ), error );</div>
<div class="line"><span class="lineno"> 1779</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1780</span>        closesocket( (*netw) -&gt; link .sock );</div>
<div class="line"><span class="lineno"> 1781</span>    }</div>
<div class="line"><span class="lineno"> 1782</span>    <span class="keywordflow">if</span>( rp == NULL )</div>
<div class="line"><span class="lineno"> 1783</span>    {</div>
<div class="line"><span class="lineno"> 1784</span>        <span class="comment">/* No address succeeded */</span></div>
<div class="line"><span class="lineno"> 1785</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Couldn&#39;t get a socket for listening on port %s&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> port );</div>
<div class="line"><span class="lineno"> 1786</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;(*netw) <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1787</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1788</span>    }</div>
<div class="line"><span class="lineno"> 1789</span> </div>
<div class="line"><span class="lineno"> 1790</span>    <span class="comment">/* nb_pending connections*/</span></div>
<div class="line"><span class="lineno"> 1791</span>    ( *netw ) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a1db8130fdbab7a8cc7d88c9f40ef7c77">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a1db8130fdbab7a8cc7d88c9f40ef7c77">nb_pending</a> = nbpending ;</div>
<div class="line"><span class="lineno"> 1792</span>    listen( ( *netw ) -&gt; link . sock, ( *netw ) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a1db8130fdbab7a8cc7d88c9f40ef7c77">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a1db8130fdbab7a8cc7d88c9f40ef7c77">nb_pending</a> );</div>
<div class="line"><span class="lineno"> 1793</span> </div>
<div class="line"><span class="lineno"> 1794</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> (*netw)<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_SERVER|NETW_RUN|NETW_THR_ENGINE_STOPPED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 1795</span> </div>
<div class="line"><span class="lineno"> 1796</span>    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 1797</span>} <span class="comment">/* netw_make_listening(...)*/</span></div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span> </div>
<div class="line"><span class="lineno"> 1800</span> </div>
<div class="line"><span class="lineno"> 1801</span><span class="comment">/*!\fn NETWORK *netw_accept_from_ex( NETWORK *from , int send_list_limit , int recv_list_limit , int non_blocking , int *retval )</span></div>
<div class="line"><span class="lineno"> 1802</span><span class="comment"> *\brief make a normal &#39;accept&#39; . Network &#39;from&#39; must be allocated with netw_make_listening.</span></div>
<div class="line"><span class="lineno"> 1803</span><span class="comment"> *\param from the network from where we accept</span></div>
<div class="line"><span class="lineno"> 1804</span><span class="comment"> *\param send_list_limit Internal sending list maximum number of item. 0 or negative for unrestricted</span></div>
<div class="line"><span class="lineno"> 1805</span><span class="comment"> *\param recv_list_limit Internal receiving list maximum number of item. 0 or negative for unrestricted</span></div>
<div class="line"><span class="lineno"> 1806</span><span class="comment"> *\param non_blocking set to -1 to make it non blocking, to 0 for blocking, else it&#39;s the select timeout value in msecs.</span></div>
<div class="line"><span class="lineno"> 1807</span><span class="comment"> *\param retval EAGAIN ou EWOULDBLOCK or neterrno (use netstrerr( retval) to obtain a string describing the code )</span></div>
<div class="line"><span class="lineno"> 1808</span><span class="comment"> *\return NULL on failure, if not a pointer to the connected network</span></div>
<div class="line"><span class="lineno"> 1809</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga80624fa0de793761e9ea5cebff424c68"> 1810</a></span><a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga80624fa0de793761e9ea5cebff424c68">netw_accept_from_ex</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *from, <span class="keywordtype">int</span> send_list_limit, <span class="keywordtype">int</span> recv_list_limit, <span class="keywordtype">int</span> non_blocking, <span class="keywordtype">int</span> *retval )</div>
<div class="line"><span class="lineno"> 1811</span>{</div>
<div class="line"><span class="lineno"> 1812</span>    <span class="keywordtype">int</span> tmp = 0, error = 0;</div>
<div class="line"><span class="lineno"> 1813</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 1814</span> </div>
<div class="line"><span class="lineno"> 1815</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">__linux__</span> <span class="preprocessor">)</span> <span class="preprocessor">||</span> <span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">__sun</span> <span class="preprocessor">)</span> <span class="preprocessor">||</span> <span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">_AIX</span> <span class="preprocessor">)</span></div>
<div class="line"><span class="lineno"> 1816</span>    socklen_t sin_size = 0 ;</div>
<div class="line"><span class="lineno"> 1817</span><span class="preprocessor">#</span><span class="preprocessor">else</span></div>
<div class="line"><span class="lineno"> 1818</span>    <span class="keywordtype">int</span> sin_size = 0 ;</div>
<div class="line"><span class="lineno"> 1819</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 1820</span> </div>
<div class="line"><span class="lineno"> 1821</span>    <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw = NULL ;</div>
<div class="line"><span class="lineno"> 1822</span> </div>
<div class="line"><span class="lineno"> 1823</span>    <span class="comment">/*checking WSA when under windows*/</span></div>
<div class="line"><span class="lineno"> 1824</span>    <span class="keywordflow">if</span>( <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">netw_init_wsa</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">(</a> 1<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">,</a> 2<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">,</a> 2 <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">)</a> == FALSE )</div>
<div class="line"><span class="lineno"> 1825</span>    {</div>
<div class="line"><span class="lineno"> 1826</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unable to load WSA dll&#39;s&quot;</span> );</div>
<div class="line"><span class="lineno"> 1827</span>        <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno"> 1828</span>    }</div>
<div class="line"><span class="lineno"> 1829</span> </div>
<div class="line"><span class="lineno"> 1830</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( from, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno"> 1831</span> </div>
<div class="line"><span class="lineno"> 1832</span>    netw = <a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">netw_new</a><a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">(</a> send_list_limit<a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">,</a> recv_list_limit <a class="code hl_function" href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">)</a>;</div>
<div class="line"><span class="lineno"> 1833</span> </div>
<div class="line"><span class="lineno"> 1834</span>    sin_size = <span class="keyword">sizeof</span>( netw -&gt; link . raddr );</div>
<div class="line"><span class="lineno"> 1835</span> </div>
<div class="line"><span class="lineno"> 1836</span>    <span class="keywordflow">if</span>( non_blocking &gt; 0 )</div>
<div class="line"><span class="lineno"> 1837</span>    {</div>
<div class="line"><span class="lineno"> 1838</span>        <span class="keywordtype">int</span> secs = non_blocking/1000 ;</div>
<div class="line"><span class="lineno"> 1839</span>        <span class="keywordtype">int</span> usecs = (non_blocking%1000)*1000;</div>
<div class="line"><span class="lineno"> 1840</span>        <span class="keyword">struct</span> timeval select_timeout = { secs, usecs };</div>
<div class="line"><span class="lineno"> 1841</span> </div>
<div class="line"><span class="lineno"> 1842</span>        fd_set accept_set ;</div>
<div class="line"><span class="lineno"> 1843</span>        FD_SET( from -&gt; link . sock, &amp;accept_set );</div>
<div class="line"><span class="lineno"> 1844</span>        FD_ZERO( &amp;accept_set );</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>        <span class="keywordtype">int</span> ret = select( from -&gt; link . sock + 1, &amp;accept_set, NULL, NULL, &amp;select_timeout );</div>
<div class="line"><span class="lineno"> 1847</span>        <span class="keywordflow">if</span>( ret == -1 )</div>
<div class="line"><span class="lineno"> 1848</span>        {</div>
<div class="line"><span class="lineno"> 1849</span>            error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1850</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1851</span>            <span class="keywordflow">if</span>( retval != NULL )</div>
<div class="line"><span class="lineno"> 1852</span>                (*retval) = error ;</div>
<div class="line"><span class="lineno"> 1853</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error on select with timeout %ds (%d.%ds), neterrno: %s&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> non_blocking<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> secs<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> usecs<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1854</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1855</span>            <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1856</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1857</span>        }</div>
<div class="line"><span class="lineno"> 1858</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ret == 0 )</div>
<div class="line"><span class="lineno"> 1859</span>        {</div>
<div class="line"><span class="lineno"> 1860</span>            <span class="comment">/* that one produce waaaay too much logs under a lot of cases */</span></div>
<div class="line"><span class="lineno"> 1861</span>            <span class="comment">/* n_log( LOG_DEBUG , &quot;No connection waiting on %d&quot; , from -&gt; link . sock ); */</span></div>
<div class="line"><span class="lineno"> 1862</span>            <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1863</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1864</span>        }</div>
<div class="line"><span class="lineno"> 1865</span>        <span class="keywordflow">if</span>( FD_ISSET(  from -&gt; link . sock, &amp;accept_set ) )</div>
<div class="line"><span class="lineno"> 1866</span>        {</div>
<div class="line"><span class="lineno"> 1867</span>            <span class="comment">//n_log( LOG_DEBUG, &quot;select accept call on %d&quot;, from -&gt; link . sock );</span></div>
<div class="line"><span class="lineno"> 1868</span>            tmp = accept( from -&gt; link . sock, (<span class="keyword">struct</span> sockaddr * )&amp;netw -&gt; link . raddr, &amp;sin_size );</div>
<div class="line"><span class="lineno"> 1869</span>            <span class="keywordflow">if</span> ( tmp &lt; 0 )</div>
<div class="line"><span class="lineno"> 1870</span>            {</div>
<div class="line"><span class="lineno"> 1871</span>                error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1872</span>                errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1873</span>                <span class="keywordflow">if</span>( retval != NULL )</div>
<div class="line"><span class="lineno"> 1874</span>                    (*retval) = error ;</div>
<div class="line"><span class="lineno"> 1875</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;error accepting on %d, %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1876</span>                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1877</span>                <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1878</span>                <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1879</span>            }</div>
<div class="line"><span class="lineno"> 1880</span>        }</div>
<div class="line"><span class="lineno"> 1881</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1882</span>        {</div>
<div class="line"><span class="lineno"> 1883</span>            <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1884</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1885</span>        }</div>
<div class="line"><span class="lineno"> 1886</span>        netw -&gt; link . is_blocking = 1 ;</div>
<div class="line"><span class="lineno"> 1887</span>    }</div>
<div class="line"><span class="lineno"> 1888</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( non_blocking == -1 )</div>
<div class="line"><span class="lineno"> 1889</span>    {</div>
<div class="line"><span class="lineno"> 1890</span>        <span class="keywordflow">if</span>( from -&gt; link . is_blocking  == 1 )</div>
<div class="line"><span class="lineno"> 1891</span>        {</div>
<div class="line"><span class="lineno"> 1892</span>            <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">netw_set_blocking</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">(</a> from<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">,</a> 0 <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">)</a>;</div>
<div class="line"><span class="lineno"> 1893</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#gaeb4f36db01bd128c7afeac5889dac311">LOG_INFO</a>, <span class="stringliteral">&quot;changed to non blocking accept call on %d&quot;</span>, from -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 1894</span>        }</div>
<div class="line"><span class="lineno"> 1895</span>        tmp = accept( from -&gt; link . sock, (<span class="keyword">struct</span> sockaddr *)&amp;netw -&gt; link . raddr, &amp;sin_size );</div>
<div class="line"><span class="lineno"> 1896</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1897</span>        <span class="keywordflow">if</span>( retval != NULL )</div>
<div class="line"><span class="lineno"> 1898</span>            (*retval) = error ;</div>
<div class="line"><span class="lineno"> 1899</span> </div>
<div class="line"><span class="lineno"> 1900</span>        <span class="keywordflow">if</span> ( tmp &lt; 0 )</div>
<div class="line"><span class="lineno"> 1901</span>        {</div>
<div class="line"><span class="lineno"> 1902</span>            <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1903</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1904</span>        }</div>
<div class="line"><span class="lineno"> 1905</span>        netw -&gt; link . is_blocking = 0 ;</div>
<div class="line"><span class="lineno"> 1906</span>    }</div>
<div class="line"><span class="lineno"> 1907</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1908</span>    {</div>
<div class="line"><span class="lineno"> 1909</span>        <span class="keywordflow">if</span>( from -&gt; link . is_blocking  == 0 )</div>
<div class="line"><span class="lineno"> 1910</span>        {</div>
<div class="line"><span class="lineno"> 1911</span>            <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">netw_set_blocking</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">(</a> from<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">,</a> 1 <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">)</a>;</div>
<div class="line"><span class="lineno"> 1912</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;changed to blocking accept call on %d&quot;</span>, from -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 1913</span>        }</div>
<div class="line"><span class="lineno"> 1914</span>        tmp = accept( from -&gt; link . sock, (<span class="keyword">struct</span> sockaddr *)&amp;netw -&gt; link . raddr, &amp;sin_size );</div>
<div class="line"><span class="lineno"> 1915</span>        <span class="keywordflow">if</span> ( tmp &lt; 0 )</div>
<div class="line"><span class="lineno"> 1916</span>        {</div>
<div class="line"><span class="lineno"> 1917</span>            error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1918</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1919</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;error accepting on %d, %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1920</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1921</span>            <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1922</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1923</span>        }</div>
<div class="line"><span class="lineno"> 1924</span>    }</div>
<div class="line"><span class="lineno"> 1925</span> </div>
<div class="line"><span class="lineno"> 1926</span>    netw -&gt; link . sock = tmp ;</div>
<div class="line"><span class="lineno"> 1927</span>    netw -&gt; link . port = strdup( from -&gt; link . port );</div>
<div class="line"><span class="lineno"> 1928</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( netw -&gt; link . ip, <span class="keywordtype">char</span>, 64 );</div>
<div class="line"><span class="lineno"> 1929</span>    <span class="keywordflow">if</span>( !netw -&gt; link . ip )</div>
<div class="line"><span class="lineno"> 1930</span>    {</div>
<div class="line"><span class="lineno"> 1931</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Error allocating 64 bytes for ip&quot;</span> );</div>
<div class="line"><span class="lineno"> 1932</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">(</a> &amp;netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">)</a>;</div>
<div class="line"><span class="lineno"> 1933</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 1934</span>    }</div>
<div class="line"><span class="lineno"> 1935</span>    <span class="keywordflow">if</span>( !inet_ntop( netw -&gt; link . raddr . ss_family, get_in_addr( ((<span class="keyword">struct</span> sockaddr *)&amp;netw -&gt; link . raddr) ), netw -&gt; link . ip, 64 ) )</div>
<div class="line"><span class="lineno"> 1936</span>    {</div>
<div class="line"><span class="lineno"> 1937</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 1938</span>        errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 1939</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;inet_ntop: %p , %s&quot;</span>, netw -&gt; link . raddr, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 1940</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 1941</span>    }</div>
<div class="line"><span class="lineno"> 1942</span>    netw_setsockopt( netw, SO_REUSEADDR, 1 );</div>
<div class="line"><span class="lineno"> 1943</span> </div>
<div class="line"><span class="lineno"> 1944</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_SERVER|NETW_RUN|NETW_THR_ENGINE_STOPPED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 1945</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Connection accepted from %s:%s&quot;</span>, netw-&gt; link . ip, netw -&gt; link . port );</div>
<div class="line"><span class="lineno"> 1946</span> </div>
<div class="line"><span class="lineno"> 1947</span>    <span class="keywordflow">return</span> netw;</div>
<div class="line"><span class="lineno"> 1948</span>} <span class="comment">/* netw_accept_from_ex(...) */</span></div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span> </div>
<div class="line"><span class="lineno"> 1951</span> </div>
<div class="line"><span class="lineno"> 1952</span><span class="comment">/*!\fn NETWORK *netw_accept_from( NETWORK *from )</span></div>
<div class="line"><span class="lineno"> 1953</span><span class="comment"> *\brief make a normal blocking &#39;accept&#39; . Network &#39;from&#39; must be allocated with netw_make_listening.</span></div>
<div class="line"><span class="lineno"> 1954</span><span class="comment"> *\param from The network from which to obtaion the connection</span></div>
<div class="line"><span class="lineno"> 1955</span><span class="comment"> *\return NULL</span></div>
<div class="line"><span class="lineno"> 1956</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gab99090cbf623f95556ea610e690b50d9"> 1957</a></span><a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gab99090cbf623f95556ea610e690b50d9">netw_accept_from</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *from )</div>
<div class="line"><span class="lineno"> 1958</span>{</div>
<div class="line"><span class="lineno"> 1959</span>    <span class="keywordflow">return</span> netw_accept_from_ex( from, 0, 0, 0, NULL );</div>
<div class="line"><span class="lineno"> 1960</span>} <span class="comment">/* network_accept_from( ... ) */</span></div>
<div class="line"><span class="lineno"> 1961</span> </div>
<div class="line"><span class="lineno"> 1962</span> </div>
<div class="line"><span class="lineno"> 1963</span> </div>
<div class="line"><span class="lineno"> 1964</span><span class="comment">/*!\fn NETWORK *netw_accept_nonblock_from( NETWORK *from , int blocking )</span></div>
<div class="line"><span class="lineno"> 1965</span><span class="comment"> *\brief make a normal blocking &#39;accept&#39; . Network &#39;from&#39; must be allocated with netw_make_listening.</span></div>
<div class="line"><span class="lineno"> 1966</span><span class="comment"> *\param from The network from which to obtaion the connection</span></div>
<div class="line"><span class="lineno"> 1967</span><span class="comment"> *\param blocking set to -1 to make it non blocking, to 0 for blocking, else it&#39;s the select timeout value in mseconds.</span></div>
<div class="line"><span class="lineno"> 1968</span><span class="comment"> *\return NULL</span></div>
<div class="line"><span class="lineno"> 1969</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga32138772c399518190a14e81164fc469"> 1970</a></span><a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga32138772c399518190a14e81164fc469">netw_accept_nonblock_from</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *from, <span class="keywordtype">int</span> blocking )</div>
<div class="line"><span class="lineno"> 1971</span>{</div>
<div class="line"><span class="lineno"> 1972</span>    <span class="keywordflow">return</span> netw_accept_from_ex( from, 0, 0, blocking, NULL );</div>
<div class="line"><span class="lineno"> 1973</span>} <span class="comment">/* network_accept_from( ... ) */</span></div>
<div class="line"><span class="lineno"> 1974</span> </div>
<div class="line"><span class="lineno"> 1975</span> </div>
<div class="line"><span class="lineno"> 1976</span><span class="comment">/*!\fn int netw_add_msg( NETWORK *netw , N_STR *msg )</span></div>
<div class="line"><span class="lineno"> 1977</span><span class="comment"> *\brief Add a message to send in aimed NETWORK</span></div>
<div class="line"><span class="lineno"> 1978</span><span class="comment"> *\param netw NETWORK where add the message</span></div>
<div class="line"><span class="lineno"> 1979</span><span class="comment"> *\param msg  the message to add</span></div>
<div class="line"><span class="lineno"> 1980</span><span class="comment"> *\return TRUE if success FALSE on error</span></div>
<div class="line"><span class="lineno"> 1981</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502"> 1982</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, N_STR *msg )</div>
<div class="line"><span class="lineno"> 1983</span>{</div>
<div class="line"><span class="lineno"> 1984</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1985</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( msg, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1986</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( msg <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">data</a>, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 1987</span> </div>
<div class="line"><span class="lineno"> 1988</span>    <span class="keywordflow">if</span>( msg <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">length</a> &lt;= 0 )</div>
<div class="line"><span class="lineno"> 1989</span>    {</div>
<div class="line"><span class="lineno"> 1990</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Empty messages are not supported. msg(%p)-&gt;lenght=%d&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> msg<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> msg <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">length</a> );</div>
<div class="line"><span class="lineno"> 1991</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 1992</span>    }</div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>    pthread_mutex_lock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1995</span> </div>
<div class="line"><span class="lineno"> 1996</span>    <span class="keywordflow">if</span>( <a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">list_push</a><a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a><a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">,</a> msg<a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">,</a> <a class="code hl_function" href="group___n___s_t_r.html#ga0a864a4ce4997389f2e5e2e16c51a30a">free_nstr_ptr</a> <a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">)</a> == FALSE )</div>
<div class="line"><span class="lineno"> 1997</span>    {</div>
<div class="line"><span class="lineno"> 1998</span>        pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 1999</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2000</span>    }</div>
<div class="line"><span class="lineno"> 2001</span> </div>
<div class="line"><span class="lineno"> 2002</span>    pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2003</span> </div>
<div class="line"><span class="lineno"> 2004</span>    sem_post( &amp;netw -&gt; send_blocker );</div>
<div class="line"><span class="lineno"> 2005</span> </div>
<div class="line"><span class="lineno"> 2006</span>    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2007</span>} <span class="comment">/* netw_add_msg(...) */</span></div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span> </div>
<div class="line"><span class="lineno"> 2010</span> </div>
<div class="line"><span class="lineno"> 2011</span><span class="comment">/*!\fn int netw_add_msg_ex( NETWORK *netw , char *str , unsigned int length )</span></div>
<div class="line"><span class="lineno"> 2012</span><span class="comment"> *\brief Add a message to send in aimed NETWORK</span></div>
<div class="line"><span class="lineno"> 2013</span><span class="comment"> *\param netw NETWORK where add the message</span></div>
<div class="line"><span class="lineno"> 2014</span><span class="comment"> *\param str  the message to add</span></div>
<div class="line"><span class="lineno"> 2015</span><span class="comment"> *\param length  the size of the message to add</span></div>
<div class="line"><span class="lineno"> 2016</span><span class="comment"> *\return TRUE if success FALSE on error</span></div>
<div class="line"><span class="lineno"> 2017</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gafd17b2ed695976a31b4cdee5091e0ef7"> 2018</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gafd17b2ed695976a31b4cdee5091e0ef7">netw_add_msg_ex</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">char</span> *str, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length )</div>
<div class="line"><span class="lineno"> 2019</span>{</div>
<div class="line"><span class="lineno"> 2020</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2021</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( str, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2022</span>    <span class="keywordflow">if</span>( length == 0 )</div>
<div class="line"><span class="lineno"> 2023</span>    {</div>
<div class="line"><span class="lineno"> 2024</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2025</span>    }</div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>    N_STR *nstr = NULL ;</div>
<div class="line"><span class="lineno"> 2028</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( nstr, N_STR, 1 );</div>
<div class="line"><span class="lineno"> 2029</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( nstr, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2030</span> </div>
<div class="line"><span class="lineno"> 2031</span>    <span class="keywordflow">if</span>( length == 0 )</div>
<div class="line"><span class="lineno"> 2032</span>    {</div>
<div class="line"><span class="lineno"> 2033</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Empty messages are not supported. msg(%p)-&gt;lenght=%d&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> str<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> length );</div>
<div class="line"><span class="lineno"> 2034</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2035</span>    }</div>
<div class="line"><span class="lineno"> 2036</span> </div>
<div class="line"><span class="lineno"> 2037</span>    nstr <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">data</a> = str ;</div>
<div class="line"><span class="lineno"> 2038</span>    nstr <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">written</a> = nstr <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">length</a> = length ;</div>
<div class="line"><span class="lineno"> 2039</span> </div>
<div class="line"><span class="lineno"> 2040</span>    pthread_mutex_lock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2041</span>    <span class="keywordflow">if</span>( <a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">list_push</a><a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a><a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">,</a> nstr<a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">,</a> <a class="code hl_function" href="group___n___s_t_r.html#ga0a864a4ce4997389f2e5e2e16c51a30a">free_nstr_ptr</a> <a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">)</a> == FALSE )</div>
<div class="line"><span class="lineno"> 2042</span>    {</div>
<div class="line"><span class="lineno"> 2043</span>        pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2044</span>        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2045</span>    }</div>
<div class="line"><span class="lineno"> 2046</span>    pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2047</span> </div>
<div class="line"><span class="lineno"> 2048</span>    sem_post( &amp;netw -&gt; send_blocker );</div>
<div class="line"><span class="lineno"> 2049</span> </div>
<div class="line"><span class="lineno"> 2050</span>    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2051</span>} <span class="comment">/* netw_add_msg_ex(...) */</span></div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span> </div>
<div class="line"><span class="lineno"> 2054</span> </div>
<div class="line"><span class="lineno"> 2055</span> </div>
<div class="line"><span class="lineno"> 2056</span><span class="comment">/*!\fn N_STR *netw_get_msg( NETWORK *netw )</span></div>
<div class="line"><span class="lineno"> 2057</span><span class="comment"> *\brief Get a message from aimed NETWORK</span></div>
<div class="line"><span class="lineno"> 2058</span><span class="comment"> *\param netw NETWORK where get the msg</span></div>
<div class="line"><span class="lineno"> 2059</span><span class="comment"> *\return NULL or a filled N_STR</span></div>
<div class="line"><span class="lineno"> 2060</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga0d0992b4eac986d7757ecddbc66e3b90"> 2061</a></span>N_STR *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga0d0992b4eac986d7757ecddbc66e3b90">netw_get_msg</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw )</div>
<div class="line"><span class="lineno"> 2062</span>{</div>
<div class="line"><span class="lineno"> 2063</span>    N_STR * ptr = NULL ;</div>
<div class="line"><span class="lineno"> 2064</span> </div>
<div class="line"><span class="lineno"> 2065</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno"> 2066</span> </div>
<div class="line"><span class="lineno"> 2067</span>    pthread_mutex_lock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 2068</span> </div>
<div class="line"><span class="lineno"> 2069</span>    ptr = <a class="code hl_define" href="group___l_i_s_t.html#ga1109e1a0b5996fb3c362ad243e2f8f80">list_shift</a>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a>, N_STR );</div>
<div class="line"><span class="lineno"> 2070</span> </div>
<div class="line"><span class="lineno"> 2071</span>    pthread_mutex_unlock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 2072</span> </div>
<div class="line"><span class="lineno"> 2073</span>    <span class="keywordflow">return</span> ptr ;</div>
<div class="line"><span class="lineno"> 2074</span>} <span class="comment">/* netw_get_msg(...)*/</span></div>
<div class="line"><span class="lineno"> 2075</span> </div>
<div class="line"><span class="lineno"> 2076</span> </div>
<div class="line"><span class="lineno"> 2077</span> </div>
<div class="line"><span class="lineno"> 2078</span><span class="comment">/*!\fn N_STR *netw_wait_msg( NETWORK *netw , long refresh , long timeout )</span></div>
<div class="line"><span class="lineno"> 2079</span><span class="comment"> *\brief Wait a message from aimed NETWORK. Recheck each usec until a valid</span></div>
<div class="line"><span class="lineno"> 2080</span><span class="comment"> *\param netw The link on which we wait a message</span></div>
<div class="line"><span class="lineno"> 2081</span><span class="comment"> *\param refresh The time in usec between each check until there is a message</span></div>
<div class="line"><span class="lineno"> 2082</span><span class="comment"> *\param timeout in usecs , maximum amount of time to wait before return. Pass a value &lt;= 0 to disable.</span></div>
<div class="line"><span class="lineno"> 2083</span><span class="comment"> *\return NULL or a filled N_STR</span></div>
<div class="line"><span class="lineno"> 2084</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gace3b069637ff0f12809eca2fb1a0b696"> 2085</a></span>N_STR *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gace3b069637ff0f12809eca2fb1a0b696">netw_wait_msg</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">long</span> refresh, <span class="keywordtype">long</span> timeout )</div>
<div class="line"><span class="lineno"> 2086</span>{</div>
<div class="line"><span class="lineno"> 2087</span>    N_STR *nstrptr = NULL ;</div>
<div class="line"><span class="lineno"> 2088</span>    <span class="keywordtype">int</span> timed = 0 ;</div>
<div class="line"><span class="lineno"> 2089</span>    <span class="keywordtype">long</span> secs = 0 ;</div>
<div class="line"><span class="lineno"> 2090</span>    <span class="keywordtype">long</span> usecs = 0 ;</div>
<div class="line"><span class="lineno"> 2091</span> </div>
<div class="line"><span class="lineno"> 2092</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno"> 2093</span> </div>
<div class="line"><span class="lineno"> 2094</span>    usecs = refresh ;</div>
<div class="line"><span class="lineno"> 2095</span>    <span class="keywordflow">if</span>( refresh &gt; 999999 )</div>
<div class="line"><span class="lineno"> 2096</span>    {</div>
<div class="line"><span class="lineno"> 2097</span>        secs = refresh / 1000000 ;</div>
<div class="line"><span class="lineno"> 2098</span>        usecs = refresh % 1000000 ;</div>
<div class="line"><span class="lineno"> 2099</span>    }</div>
<div class="line"><span class="lineno"> 2100</span> </div>
<div class="line"><span class="lineno"> 2101</span>    <span class="keywordflow">if</span>( timeout &gt; 0 )</div>
<div class="line"><span class="lineno"> 2102</span>        timed = timeout ;</div>
<div class="line"><span class="lineno"> 2103</span> </div>
<div class="line"><span class="lineno"> 2104</span>    <span class="keywordtype">int</span> state = NETW_RUN, thr_state = 0 ;</div>
<div class="line"><span class="lineno"> 2105</span> </div>
<div class="line"><span class="lineno"> 2106</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 2107</span>    {</div>
<div class="line"><span class="lineno"> 2108</span>        nstrptr = <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga0d0992b4eac986d7757ecddbc66e3b90">netw_get_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga0d0992b4eac986d7757ecddbc66e3b90">(</a> netw <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga0d0992b4eac986d7757ecddbc66e3b90">)</a>;</div>
<div class="line"><span class="lineno"> 2109</span>        <span class="keywordflow">if</span>( nstrptr )</div>
<div class="line"><span class="lineno"> 2110</span>            <span class="keywordflow">return</span> nstrptr ;</div>
<div class="line"><span class="lineno"> 2111</span> </div>
<div class="line"><span class="lineno"> 2112</span>        <span class="keywordflow">if</span>( timed &gt; 0 )</div>
<div class="line"><span class="lineno"> 2113</span>        {</div>
<div class="line"><span class="lineno"> 2114</span>            timeout -= refresh ;</div>
<div class="line"><span class="lineno"> 2115</span>            <span class="keywordflow">if</span>( timeout &lt; 0 )</div>
<div class="line"><span class="lineno"> 2116</span>            {</div>
<div class="line"><span class="lineno"> 2117</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;timed out for netw %d (%s)&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ) );</div>
<div class="line"><span class="lineno"> 2118</span>                <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 2119</span>            }</div>
<div class="line"><span class="lineno"> 2120</span>        }</div>
<div class="line"><span class="lineno"> 2121</span>        <span class="keywordflow">if</span>(secs &gt; 0)</div>
<div class="line"><span class="lineno"> 2122</span>            sleep( secs );</div>
<div class="line"><span class="lineno"> 2123</span>        <span class="keywordflow">if</span>( usecs &gt;0 )</div>
<div class="line"><span class="lineno"> 2124</span>            u_sleep( usecs );</div>
<div class="line"><span class="lineno"> 2125</span> </div>
<div class="line"><span class="lineno"> 2126</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">netw_get_state</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;state<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;thr_state <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">)</a>;</div>
<div class="line"><span class="lineno"> 2127</span>    }</div>
<div class="line"><span class="lineno"> 2128</span>    <span class="keywordflow">while</span>( state == NETW_RUN );</div>
<div class="line"><span class="lineno"> 2129</span> </div>
<div class="line"><span class="lineno"> 2130</span>    <span class="keywordflow">if</span>( timed &gt; 0 &amp;&amp; timeout &lt;= 0 )</div>
<div class="line"><span class="lineno"> 2131</span>    {</div>
<div class="line"><span class="lineno"> 2132</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;netw %d state %s (%d): no message after waiting %ds&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___e_n_u_m_s.html#gaea85b76e3e616598be8af94c93581532">N_ENUM_ENTRY</a>(__netw_code_type,toString)(state), state, timeout );</div>
<div class="line"><span class="lineno"> 2133</span>    }</div>
<div class="line"><span class="lineno"> 2134</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2135</span>    {</div>
<div class="line"><span class="lineno"> 2136</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;netw %d exited with state %s (%d)&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___e_n_u_m_s.html#gaea85b76e3e616598be8af94c93581532">N_ENUM_ENTRY</a>(__netw_code_type,toString)(state), state, timeout );</div>
<div class="line"><span class="lineno"> 2137</span>    }</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span>    <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno"> 2140</span>} <span class="comment">/* netw_wait_msg(...) */</span></div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span> </div>
<div class="line"><span class="lineno"> 2143</span> </div>
<div class="line"><span class="lineno"> 2144</span><span class="comment">/*!\fn netw_start_thr_engine( NETWORK *netw )</span></div>
<div class="line"><span class="lineno"> 2145</span><span class="comment"> *\brief Start the NETWORK netw Threaded Engine. Create a sending &amp; receiving thread.</span></div>
<div class="line"><span class="lineno"> 2146</span><span class="comment"> *\param netw The aimed NETWORK connection to start receiving data</span></div>
<div class="line"><span class="lineno"> 2147</span><span class="comment"> *\return TRUE on success FALSE on failure</span></div>
<div class="line"><span class="lineno"> 2148</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga5ba0555c5ccd261227c3c1216923d563"> 2149</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga5ba0555c5ccd261227c3c1216923d563">netw_start_thr_engine</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw )</div>
<div class="line"><span class="lineno"> 2150</span>{</div>
<div class="line"><span class="lineno"> 2151</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2152</span> </div>
<div class="line"><span class="lineno"> 2153</span>    pthread_mutex_lock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2154</span>    <span class="keywordflow">if</span>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">threaded_engine_status</a> == NETW_THR_ENGINE_STARTED )</div>
<div class="line"><span class="lineno"> 2155</span>    {</div>
<div class="line"><span class="lineno"> 2156</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;THR Engine already started for network %p (%s)&quot;</span>, netw, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ) );</div>
<div class="line"><span class="lineno"> 2157</span>        pthread_mutex_unlock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2158</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2159</span>    }</div>
<div class="line"><span class="lineno"> 2160</span> </div>
<div class="line"><span class="lineno"> 2161</span>    <span class="keywordflow">if</span>( pthread_create(  &amp;netw -&gt; recv_thr,   NULL,  netw_recv_func,  (<span class="keywordtype">void</span> *) netw ) != 0 )</div>
<div class="line"><span class="lineno"> 2162</span>    {</div>
<div class="line"><span class="lineno"> 2163</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unable to create recv_thread for network %p (%s)&quot;</span>, netw, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ) );</div>
<div class="line"><span class="lineno"> 2164</span>        pthread_mutex_unlock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2165</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2166</span>    }</div>
<div class="line"><span class="lineno"> 2167</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">nb_running_threads</a> ++ ;</div>
<div class="line"><span class="lineno"> 2168</span>    <span class="keywordflow">if</span>( pthread_create(  &amp;netw -&gt; send_thr,   NULL,  netw_send_func,  (<span class="keywordtype">void</span> *) netw ) != 0 )</div>
<div class="line"><span class="lineno"> 2169</span>    {</div>
<div class="line"><span class="lineno"> 2170</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Unable to create send_thread for network %p (%s)&quot;</span>, netw, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ) );</div>
<div class="line"><span class="lineno"> 2171</span>        pthread_mutex_unlock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2172</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2173</span>    }</div>
<div class="line"><span class="lineno"> 2174</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">nb_running_threads</a> ++ ;</div>
<div class="line"><span class="lineno"> 2175</span> </div>
<div class="line"><span class="lineno"> 2176</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">threaded_engine_status</a> = NETW_THR_ENGINE_STARTED ;</div>
<div class="line"><span class="lineno"> 2177</span> </div>
<div class="line"><span class="lineno"> 2178</span>    pthread_mutex_unlock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2179</span> </div>
<div class="line"><span class="lineno"> 2180</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 2181</span>}  <span class="comment">/* netw_create_recv_thread(....) */</span></div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span> </div>
<div class="line"><span class="lineno"> 2184</span> </div>
<div class="line"><span class="lineno"> 2185</span><span class="comment">/*!\fn void *netw_send_func( void *NET )</span></div>
<div class="line"><span class="lineno"> 2186</span><span class="comment"> *\brief Thread send function</span></div>
<div class="line"><span class="lineno"> 2187</span><span class="comment"> *\param NET the NETWORK connection to use, casted into (void*)</span></div>
<div class="line"><span class="lineno"> 2188</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga2ef0aab7ff9fb531466a536773b53683"> 2189</a></span><span class="keywordtype">void</span> *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga2ef0aab7ff9fb531466a536773b53683">netw_send_func</a>( <span class="keywordtype">void</span> *NET )</div>
<div class="line"><span class="lineno"> 2190</span>{</div>
<div class="line"><span class="lineno"> 2191</span>    <span class="keywordtype">int</span> DONE = 0,</div>
<div class="line"><span class="lineno"> 2192</span>        state = 0,</div>
<div class="line"><span class="lineno"> 2193</span>        net_status = 0 ;</div>
<div class="line"><span class="lineno"> 2194</span> </div>
<div class="line"><span class="lineno"> 2195</span>    NSTRBYTE nboctet = 0 ;</div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span>    <span class="keywordtype">char</span> nboct[ 5 ] = <span class="stringliteral">&quot;&quot;</span> ;</div>
<div class="line"><span class="lineno"> 2198</span> </div>
<div class="line"><span class="lineno"> 2199</span>    N_STR *ptr = NULL ;</div>
<div class="line"><span class="lineno"> 2200</span> </div>
<div class="line"><span class="lineno"> 2201</span>    <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw = (<a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *) NET ;</div>
<div class="line"><span class="lineno"> 2202</span> </div>
<div class="line"><span class="lineno"> 2203</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno"> 2204</span> </div>
<div class="line"><span class="lineno"> 2205</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 2206</span>    {</div>
<div class="line"><span class="lineno"> 2207</span> </div>
<div class="line"><span class="lineno"> 2208</span>        <span class="comment">/* do not consume cpu for nothing, reduce delay */</span></div>
<div class="line"><span class="lineno"> 2209</span>        sem_wait( &amp;netw -&gt; send_blocker );</div>
<div class="line"><span class="lineno"> 2210</span>        <span class="keywordtype">int</span> message_sent = 0 ;</div>
<div class="line"><span class="lineno"> 2211</span>        <span class="keywordflow">while</span>( message_sent == 0 &amp;&amp; !DONE )</div>
<div class="line"><span class="lineno"> 2212</span>        {</div>
<div class="line"><span class="lineno"> 2213</span>            netw_get_state( netw, &amp;state, NULL );</div>
<div class="line"><span class="lineno"> 2214</span>            <span class="keywordflow">if</span>( state&amp;NETW_ERROR )</div>
<div class="line"><span class="lineno"> 2215</span>            {</div>
<div class="line"><span class="lineno"> 2216</span>                DONE = 666 ;</div>
<div class="line"><span class="lineno"> 2217</span>            }</div>
<div class="line"><span class="lineno"> 2218</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( state&amp;NETW_EXITED )</div>
<div class="line"><span class="lineno"> 2219</span>            {</div>
<div class="line"><span class="lineno"> 2220</span>                DONE = 100 ;</div>
<div class="line"><span class="lineno"> 2221</span>            }</div>
<div class="line"><span class="lineno"> 2222</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( state&amp;NETW_EXIT_ASKED )</div>
<div class="line"><span class="lineno"> 2223</span>            {</div>
<div class="line"><span class="lineno"> 2224</span>                DONE = 100 ;</div>
<div class="line"><span class="lineno"> 2225</span>                <span class="comment">/* sending state */</span></div>
<div class="line"><span class="lineno"> 2226</span>                nboctet = htonl( NETW_EXIT_ASKED );</div>
<div class="line"><span class="lineno"> 2227</span>                memcpy( nboct, &amp;nboctet, <span class="keyword">sizeof</span>( NSTRBYTE ) );</div>
<div class="line"><span class="lineno"> 2228</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;%d Sending Quit !&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2229</span>                net_status = netw<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">-&gt;</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">send_data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">(</a> netw -&gt; link . sock<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> nboct<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> <span class="keyword">sizeof</span>( NSTRBYTE ) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">)</a>;</div>
<div class="line"><span class="lineno"> 2230</span>                <span class="keywordflow">if</span>( net_status &lt; 0 )</div>
<div class="line"><span class="lineno"> 2231</span>                    DONE = 4 ;</div>
<div class="line"><span class="lineno"> 2232</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;%d Quit sent!&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2233</span>            }</div>
<div class="line"><span class="lineno"> 2234</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2235</span>            {</div>
<div class="line"><span class="lineno"> 2236</span>                pthread_mutex_lock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2237</span>                ptr = <a class="code hl_define" href="group___l_i_s_t.html#ga1109e1a0b5996fb3c362ad243e2f8f80">list_shift</a>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a>, N_STR ) ;</div>
<div class="line"><span class="lineno"> 2238</span>                pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2239</span>                <span class="keywordflow">if</span>( ptr &amp;&amp; ptr <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">length</a> &gt; 0 &amp;&amp; ptr <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">data</a> )</div>
<div class="line"><span class="lineno"> 2240</span>                {</div>
<div class="line"><span class="lineno"> 2241</span>                    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Sending ptr size %d written %d&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> ptr <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">length</a><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> ptr <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">written</a> );</div>
<div class="line"><span class="lineno"> 2242</span> </div>
<div class="line"><span class="lineno"> 2243</span>                    <span class="comment">/* sending state */</span></div>
<div class="line"><span class="lineno"> 2244</span>                    nboctet = htonl( state );</div>
<div class="line"><span class="lineno"> 2245</span>                    memcpy( nboct, &amp;nboctet, <span class="keyword">sizeof</span>( NSTRBYTE ) );</div>
<div class="line"><span class="lineno"> 2246</span>                    <span class="comment">/* sending state */</span></div>
<div class="line"><span class="lineno"> 2247</span>                    <span class="keywordflow">if</span> ( !DONE )</div>
<div class="line"><span class="lineno"> 2248</span>                    {</div>
<div class="line"><span class="lineno"> 2249</span>                        net_status = netw<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">-&gt;</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">send_data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">(</a> netw -&gt; link . sock<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> nboct<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> <span class="keyword">sizeof</span>( NSTRBYTE ) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">)</a>;</div>
<div class="line"><span class="lineno"> 2250</span>                        <span class="keywordflow">if</span>( net_status &lt; 0 )</div>
<div class="line"><span class="lineno"> 2251</span>                            DONE = 1 ;</div>
<div class="line"><span class="lineno"> 2252</span>                    }</div>
<div class="line"><span class="lineno"> 2253</span>                    <span class="keywordflow">if</span>( !DONE )</div>
<div class="line"><span class="lineno"> 2254</span>                    {</div>
<div class="line"><span class="lineno"> 2255</span>                        <span class="comment">/* sending number of octet */</span></div>
<div class="line"><span class="lineno"> 2256</span>                        nboctet = htonl( ptr <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">written</a> );</div>
<div class="line"><span class="lineno"> 2257</span>                        memcpy( nboct, &amp;nboctet, <span class="keyword">sizeof</span>( NSTRBYTE ) );</div>
<div class="line"><span class="lineno"> 2258</span>                        <span class="comment">/* sending the number of octet to receive on next message */</span></div>
<div class="line"><span class="lineno"> 2259</span>                        net_status = netw<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">-&gt;</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">send_data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">(</a> netw -&gt; link . sock<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> nboct<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> <span class="keyword">sizeof</span>( NSTRBYTE ) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">)</a>;</div>
<div class="line"><span class="lineno"> 2260</span>                        <span class="keywordflow">if</span>( net_status &lt; 0 )</div>
<div class="line"><span class="lineno"> 2261</span>                            DONE = 2 ;</div>
<div class="line"><span class="lineno"> 2262</span>                    }</div>
<div class="line"><span class="lineno"> 2263</span>                    <span class="comment">/* sending the data itself */</span></div>
<div class="line"><span class="lineno"> 2264</span>                    <span class="keywordflow">if</span> ( !DONE )</div>
<div class="line"><span class="lineno"> 2265</span>                    {</div>
<div class="line"><span class="lineno"> 2266</span>                        net_status = netw<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">-&gt;</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">send_data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">(</a> netw -&gt; link . sock<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> ptr <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">,</a> ptr <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">written</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">)</a>;</div>
<div class="line"><span class="lineno"> 2267</span>                        <span class="keywordflow">if</span>( net_status &lt; 0 )</div>
<div class="line"><span class="lineno"> 2268</span>                            DONE = 3 ;</div>
<div class="line"><span class="lineno"> 2269</span>                    }</div>
<div class="line"><span class="lineno"> 2270</span>                    <a class="code hl_define" href="group___n___s_t_r.html#ga113e906d03374ac38e441f1df44095fb">free_nstr</a><a class="code hl_function" href="group___n___s_t_r.html#gaca4a7a2dfa962f043cb8f3762ce28761">(</a> &amp;ptr );</div>
<div class="line"><span class="lineno"> 2271</span>                    u_sleep(  netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a72517eff4bde08ad4366b5f6248931d6">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a72517eff4bde08ad4366b5f6248931d6">send_queue_consecutive_wait</a> );</div>
<div class="line"><span class="lineno"> 2272</span>                    message_sent = 1 ;</div>
<div class="line"><span class="lineno"> 2273</span>                }</div>
<div class="line"><span class="lineno"> 2274</span>            }</div>
<div class="line"><span class="lineno"> 2275</span>        }</div>
<div class="line"><span class="lineno"> 2276</span>    }</div>
<div class="line"><span class="lineno"> 2277</span>    <span class="keywordflow">while</span>( !DONE );</div>
<div class="line"><span class="lineno"> 2278</span> </div>
<div class="line"><span class="lineno"> 2279</span>    <span class="keywordflow">if</span>( DONE == 1 )</div>
<div class="line"><span class="lineno"> 2280</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error when sending state %d on socket %d (%s), network: %s&quot;</span>, netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">state</a>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2281</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 2 )</div>
<div class="line"><span class="lineno"> 2282</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error when sending number of octet to socket %d (%s), network: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2283</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 3 )</div>
<div class="line"><span class="lineno"> 2284</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;Error when sending data on socket %d (%s), network: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2285</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 4 )</div>
<div class="line"><span class="lineno"> 2286</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error when sending state QUIT on socket %d (%s), network: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2287</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 5 )</div>
<div class="line"><span class="lineno"> 2288</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error when sending state QUIT number of octet (0) on socket %d (%s), network: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2289</span> </div>
<div class="line"><span class="lineno"> 2290</span>    <span class="keywordflow">if</span>( DONE == 100 )</div>
<div class="line"><span class="lineno"> 2291</span>    {</div>
<div class="line"><span class="lineno"> 2292</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Socket %d: Sending thread exiting correctly&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2293</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_EXIT_ASKED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 2294</span>    }</div>
<div class="line"><span class="lineno"> 2295</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2296</span>    {</div>
<div class="line"><span class="lineno"> 2297</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Socket %d (%s): Sending thread exiting with error %d !&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ),DONE );</div>
<div class="line"><span class="lineno"> 2298</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_ERROR <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 2299</span>    }</div>
<div class="line"><span class="lineno"> 2300</span> </div>
<div class="line"><span class="lineno"> 2301</span>    pthread_mutex_lock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2302</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">nb_running_threads</a> -- ;</div>
<div class="line"><span class="lineno"> 2303</span>    pthread_mutex_unlock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2304</span> </div>
<div class="line"><span class="lineno"> 2305</span>    pthread_exit( 0 );</div>
<div class="line"><span class="lineno"> 2306</span> </div>
<div class="line"><span class="lineno"> 2307</span>    <span class="comment">/* suppress compiler warning */</span></div>
<div class="line"><span class="lineno"> 2308</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">!</span><span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">__linux__</span> <span class="preprocessor">)</span></div>
<div class="line"><span class="lineno"> 2309</span>    <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno"> 2310</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 2311</span>} <span class="comment">/* netw_send_func(...) */</span></div>
<div class="line"><span class="lineno"> 2312</span> </div>
<div class="line"><span class="lineno"> 2313</span> </div>
<div class="line"><span class="lineno"> 2314</span> </div>
<div class="line"><span class="lineno"> 2315</span><span class="comment">/*!\fn void *netw_recv_func( void *NET )</span></div>
<div class="line"><span class="lineno"> 2316</span><span class="comment"> *\brief To Thread Receiving function</span></div>
<div class="line"><span class="lineno"> 2317</span><span class="comment"> *\param NET the NETWORK connection to use</span></div>
<div class="line"><span class="lineno"> 2318</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga63e06c0450013078c54bb4951e9438ac"> 2319</a></span><span class="keywordtype">void</span> *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga63e06c0450013078c54bb4951e9438ac">netw_recv_func</a>( <span class="keywordtype">void</span> *NET )</div>
<div class="line"><span class="lineno"> 2320</span>{</div>
<div class="line"><span class="lineno"> 2321</span>    <span class="keywordtype">int</span> DONE = 0,</div>
<div class="line"><span class="lineno"> 2322</span>        state = 0,</div>
<div class="line"><span class="lineno"> 2323</span>        tmpstate = 0,</div>
<div class="line"><span class="lineno"> 2324</span>        net_status = 0 ;</div>
<div class="line"><span class="lineno"> 2325</span> </div>
<div class="line"><span class="lineno"> 2326</span>    NSTRBYTE nboctet = 0 ;</div>
<div class="line"><span class="lineno"> 2327</span> </div>
<div class="line"><span class="lineno"> 2328</span>    <span class="keywordtype">char</span> nboct[ 5 ]= <span class="stringliteral">&quot;&quot;</span> ;</div>
<div class="line"><span class="lineno"> 2329</span> </div>
<div class="line"><span class="lineno"> 2330</span>    N_STR *recvdmsg = NULL ;</div>
<div class="line"><span class="lineno"> 2331</span> </div>
<div class="line"><span class="lineno"> 2332</span>    <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw = (<a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *) NET ;</div>
<div class="line"><span class="lineno"> 2333</span> </div>
<div class="line"><span class="lineno"> 2334</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno"> 2335</span> </div>
<div class="line"><span class="lineno"> 2336</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 2337</span>    {</div>
<div class="line"><span class="lineno"> 2338</span>        netw_get_state( netw, &amp;state, NULL );</div>
<div class="line"><span class="lineno"> 2339</span> </div>
<div class="line"><span class="lineno"> 2340</span>        <span class="keywordflow">if</span>( state&amp;NETW_EXIT_ASKED || state&amp;NETW_EXITED )</div>
<div class="line"><span class="lineno"> 2341</span>        {</div>
<div class="line"><span class="lineno"> 2342</span>            DONE = 100;</div>
<div class="line"><span class="lineno"> 2343</span>        }</div>
<div class="line"><span class="lineno"> 2344</span>        <span class="keywordflow">if</span>( state&amp;NETW_ERROR )</div>
<div class="line"><span class="lineno"> 2345</span>        {</div>
<div class="line"><span class="lineno"> 2346</span>            DONE = 666 ;</div>
<div class="line"><span class="lineno"> 2347</span>        }</div>
<div class="line"><span class="lineno"> 2348</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2349</span>        {</div>
<div class="line"><span class="lineno"> 2350</span>            <span class="comment">/*if( !DONE &amp;&amp; !(state&amp;NETW_EXIT_ASKED) &amp;&amp; !(state&amp;NETW_EXITED) ) */</span></div>
<div class="line"><span class="lineno"> 2351</span>            <span class="keywordflow">if</span>( !DONE )</div>
<div class="line"><span class="lineno"> 2352</span>            {</div>
<div class="line"><span class="lineno"> 2353</span>                <span class="comment">/* receiving state */</span></div>
<div class="line"><span class="lineno"> 2354</span>                net_status = netw<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">-&gt;</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">recv_data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">(</a> netw -&gt; link . sock<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">,</a> nboct<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">,</a> <span class="keyword">sizeof</span>( NSTRBYTE ) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">)</a>;</div>
<div class="line"><span class="lineno"> 2355</span>                <span class="keywordflow">if</span>( net_status &lt; 0 )</div>
<div class="line"><span class="lineno"> 2356</span>                {</div>
<div class="line"><span class="lineno"> 2357</span>                    DONE = 1 ;</div>
<div class="line"><span class="lineno"> 2358</span>                }</div>
<div class="line"><span class="lineno"> 2359</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2360</span>                {</div>
<div class="line"><span class="lineno"> 2361</span>                    memcpy( &amp;nboctet, nboct, <span class="keyword">sizeof</span>( NSTRBYTE ) );</div>
<div class="line"><span class="lineno"> 2362</span>                    tmpstate = ntohl( nboctet );</div>
<div class="line"><span class="lineno"> 2363</span>                    nboctet = tmpstate ;</div>
<div class="line"><span class="lineno"> 2364</span>                    <span class="keywordflow">if</span>( tmpstate==NETW_EXIT_ASKED )</div>
<div class="line"><span class="lineno"> 2365</span>                    {</div>
<div class="line"><span class="lineno"> 2366</span>                        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;%d receiving order to QUIT, nboctet %d NETW_EXIT_ASKED %d !&quot;</span>, netw -&gt; link . sock, nboctet, NETW_EXIT_ASKED );</div>
<div class="line"><span class="lineno"> 2367</span>                        DONE = 100 ;</div>
<div class="line"><span class="lineno"> 2368</span>                        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_EXIT_ASKED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 2369</span>                    }</div>
<div class="line"><span class="lineno"> 2370</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2371</span>                    {</div>
<div class="line"><span class="lineno"> 2372</span>                        <span class="comment">/* receiving nboctet */</span></div>
<div class="line"><span class="lineno"> 2373</span>                        net_status = netw<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">-&gt;</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">recv_data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">(</a> netw -&gt; link . sock<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">,</a> nboct<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">,</a> <span class="keyword">sizeof</span>( NSTRBYTE ) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">)</a>;</div>
<div class="line"><span class="lineno"> 2374</span>                        <span class="keywordflow">if</span>( net_status &lt; 0 )</div>
<div class="line"><span class="lineno"> 2375</span>                        {</div>
<div class="line"><span class="lineno"> 2376</span>                            DONE = 2 ;</div>
<div class="line"><span class="lineno"> 2377</span>                        }</div>
<div class="line"><span class="lineno"> 2378</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2379</span>                        {</div>
<div class="line"><span class="lineno"> 2380</span>                            memcpy( &amp;nboctet, nboct, <span class="keyword">sizeof</span>( NSTRBYTE ) );</div>
<div class="line"><span class="lineno"> 2381</span>                            tmpstate = ntohl( nboctet );</div>
<div class="line"><span class="lineno"> 2382</span>                            nboctet = tmpstate ;</div>
<div class="line"><span class="lineno"> 2383</span> </div>
<div class="line"><span class="lineno"> 2384</span>                            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( recvdmsg, N_STR, 1 );</div>
<div class="line"><span class="lineno"> 2385</span>                            <span class="keywordflow">if</span>( !recvdmsg )</div>
<div class="line"><span class="lineno"> 2386</span>                            {</div>
<div class="line"><span class="lineno"> 2387</span>                                DONE = 3;</div>
<div class="line"><span class="lineno"> 2388</span>                            }</div>
<div class="line"><span class="lineno"> 2389</span>                            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2390</span>                            {</div>
<div class="line"><span class="lineno"> 2391</span>                                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;%d octets to receive...&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> nboctet );</div>
<div class="line"><span class="lineno"> 2392</span>                                <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( recvdmsg -&gt; data, <span class="keywordtype">char</span>, nboctet + 1 );</div>
<div class="line"><span class="lineno"> 2393</span>                                <span class="keywordflow">if</span>( !recvdmsg <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">data</a> )</div>
<div class="line"><span class="lineno"> 2394</span>                                {</div>
<div class="line"><span class="lineno"> 2395</span>                                    DONE = 4 ;</div>
<div class="line"><span class="lineno"> 2396</span>                                }</div>
<div class="line"><span class="lineno"> 2397</span>                                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2398</span>                                {</div>
<div class="line"><span class="lineno"> 2399</span>                                    recvdmsg <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">length</a>  = nboctet + 1 ;</div>
<div class="line"><span class="lineno"> 2400</span>                                    recvdmsg <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">written</a> = nboctet ;</div>
<div class="line"><span class="lineno"> 2401</span> </div>
<div class="line"><span class="lineno"> 2402</span>                                    <span class="comment">/* receiving the data itself */</span></div>
<div class="line"><span class="lineno"> 2403</span>                                    net_status = netw<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">-&gt;</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">recv_data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">(</a> netw -&gt; link . sock<a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">,</a> recvdmsg <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">-&gt;</a> <a class="code hl_variable" href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">data</a><a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">,</a> nboctet <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">)</a>;</div>
<div class="line"><span class="lineno"> 2404</span>                                    <span class="keywordflow">if</span>( net_status &lt; 0 )</div>
<div class="line"><span class="lineno"> 2405</span>                                    {</div>
<div class="line"><span class="lineno"> 2406</span>                                        DONE = 5 ;</div>
<div class="line"><span class="lineno"> 2407</span>                                    }</div>
<div class="line"><span class="lineno"> 2408</span>                                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2409</span>                                    {</div>
<div class="line"><span class="lineno"> 2410</span>                                        pthread_mutex_lock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 2411</span>                                        <span class="keywordflow">if</span>( !DONE &amp;&amp; <a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">list_push</a><a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a><a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">,</a> recvdmsg<a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">,</a> <a class="code hl_function" href="group___n___s_t_r.html#ga0a864a4ce4997389f2e5e2e16c51a30a">free_nstr_ptr</a> <a class="code hl_function" href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">)</a> == FALSE )</div>
<div class="line"><span class="lineno"> 2412</span>                                            DONE = 6 ;</div>
<div class="line"><span class="lineno"> 2413</span>                                        pthread_mutex_unlock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 2414</span>                                        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;%d octets received !&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> nboctet );</div>
<div class="line"><span class="lineno"> 2415</span>                                    } <span class="comment">/* recv data */</span></div>
<div class="line"><span class="lineno"> 2416</span>                                } <span class="comment">/* recv data allocation */</span></div>
<div class="line"><span class="lineno"> 2417</span>                            } <span class="comment">/* recv struct allocation */</span></div>
<div class="line"><span class="lineno"> 2418</span>                        } <span class="comment">/* recv nb octet*/</span></div>
<div class="line"><span class="lineno"> 2419</span>                    } <span class="comment">/* exit asked */</span></div>
<div class="line"><span class="lineno"> 2420</span>                } <span class="comment">/* recv state */</span></div>
<div class="line"><span class="lineno"> 2421</span>            } <span class="comment">/* if( !done) */</span></div>
<div class="line"><span class="lineno"> 2422</span>        } <span class="comment">/* if !exit */</span></div>
<div class="line"><span class="lineno"> 2423</span>    }</div>
<div class="line"><span class="lineno"> 2424</span>    <span class="keywordflow">while</span>( !DONE );</div>
<div class="line"><span class="lineno"> 2425</span> </div>
<div class="line"><span class="lineno"> 2426</span>    <span class="keywordflow">if</span>( DONE == 1 )</div>
<div class="line"><span class="lineno"> 2427</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error when receiving state from socket %d (%s), net_status: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2428</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 2 )</div>
<div class="line"><span class="lineno"> 2429</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error when receiving nboctet from socket %d (%s), net_status: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2430</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 3 )</div>
<div class="line"><span class="lineno"> 2431</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error when receiving data from socket %d (%s), net_status: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2432</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 4 )</div>
<div class="line"><span class="lineno"> 2433</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error allocating received message struct from socket %d (%s), net_status: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2434</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 5 )</div>
<div class="line"><span class="lineno"> 2435</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error allocating received messages data array from socket %d (%s), net_status: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2436</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( DONE == 6 )</div>
<div class="line"><span class="lineno"> 2437</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Error adding receved message from socket %d (%s), net_status: %s&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), (net_status==-2)?<span class="stringliteral">&quot;disconnected&quot;</span>:<span class="stringliteral">&quot;socket error&quot;</span> );</div>
<div class="line"><span class="lineno"> 2438</span> </div>
<div class="line"><span class="lineno"> 2439</span> </div>
<div class="line"><span class="lineno"> 2440</span>    <span class="keywordflow">if</span>( DONE == 100 )</div>
<div class="line"><span class="lineno"> 2441</span>    {</div>
<div class="line"><span class="lineno"> 2442</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Socket %d (%s): Receive thread exiting correctly&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ) );</div>
<div class="line"><span class="lineno"> 2443</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_EXIT_ASKED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 2444</span>    }</div>
<div class="line"><span class="lineno"> 2445</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2446</span>    {</div>
<div class="line"><span class="lineno"> 2447</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Socket %d (%s): Receive thread exiting with code %d !&quot;</span>, netw -&gt; link . sock, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( netw -&gt; link . ip ), DONE );</div>
<div class="line"><span class="lineno"> 2448</span>        <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_ERROR <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 2449</span>    }</div>
<div class="line"><span class="lineno"> 2450</span> </div>
<div class="line"><span class="lineno"> 2451</span>    pthread_mutex_lock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2452</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">nb_running_threads</a> -- ;</div>
<div class="line"><span class="lineno"> 2453</span>    pthread_mutex_unlock( &amp;netw -&gt; eventbolt );</div>
<div class="line"><span class="lineno"> 2454</span> </div>
<div class="line"><span class="lineno"> 2455</span>    pthread_exit( 0 );</div>
<div class="line"><span class="lineno"> 2456</span> </div>
<div class="line"><span class="lineno"> 2457</span>    <span class="comment">/* suppress compiler warning */</span></div>
<div class="line"><span class="lineno"> 2458</span><span class="preprocessor">#</span><span class="preprocessor">if</span> <span class="preprocessor">!</span><span class="preprocessor">defined</span><span class="preprocessor">(</span> <span class="preprocessor">__linux__</span> <span class="preprocessor">)</span></div>
<div class="line"><span class="lineno"> 2459</span>    <span class="keywordflow">return</span> NULL ;</div>
<div class="line"><span class="lineno"> 2460</span><span class="preprocessor">#</span><span class="preprocessor">endif</span></div>
<div class="line"><span class="lineno"> 2461</span>} <span class="comment">/* netw_recv_func(...) */</span></div>
<div class="line"><span class="lineno"> 2462</span> </div>
<div class="line"><span class="lineno"> 2463</span> </div>
<div class="line"><span class="lineno"> 2464</span> </div>
<div class="line"><span class="lineno"> 2465</span><span class="comment">/*!\fn netw_stop_thr_engine( NETWORK *netw )</span></div>
<div class="line"><span class="lineno"> 2466</span><span class="comment"> *\brief Stop a NETWORK connection sending and receing thread</span></div>
<div class="line"><span class="lineno"> 2467</span><span class="comment"> *\param netw The aimed NETWORK conection to stop</span></div>
<div class="line"><span class="lineno"> 2468</span><span class="comment"> *\return TRUE on success FALSE on failure</span></div>
<div class="line"><span class="lineno"> 2469</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga29159184519b3129c0154b1a2c2a3e2f"> 2470</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga29159184519b3129c0154b1a2c2a3e2f">netw_stop_thr_engine</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw )</div>
<div class="line"><span class="lineno"> 2471</span>{</div>
<div class="line"><span class="lineno"> 2472</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw,  <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2473</span>    <span class="keywordtype">int</span> state = 0, thr_engine_status = 0 ;</div>
<div class="line"><span class="lineno"> 2474</span> </div>
<div class="line"><span class="lineno"> 2475</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;Network %d stop threads event&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">netw_get_state</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;state<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">,</a> &amp;thr_engine_status <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">)</a>;</div>
<div class="line"><span class="lineno"> 2478</span> </div>
<div class="line"><span class="lineno"> 2479</span>    <span class="keywordflow">if</span>( thr_engine_status != NETW_THR_ENGINE_STARTED )</div>
<div class="line"><span class="lineno"> 2480</span>    {</div>
<div class="line"><span class="lineno"> 2481</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Thread engine status already stopped for network %p&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> netw );</div>
<div class="line"><span class="lineno"> 2482</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2483</span>    }</div>
<div class="line"><span class="lineno"> 2484</span> </div>
<div class="line"><span class="lineno"> 2485</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_EXIT_ASKED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 2486</span> </div>
<div class="line"><span class="lineno"> 2487</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;Network %d waits for send threads to stop&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2488</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> it = 0 ; it &lt; 10 ; it ++ )</div>
<div class="line"><span class="lineno"> 2489</span>    {</div>
<div class="line"><span class="lineno"> 2490</span>        sem_post( &amp;netw -&gt; send_blocker );</div>
<div class="line"><span class="lineno"> 2491</span>        usleep( 1000 );</div>
<div class="line"><span class="lineno"> 2492</span>    }</div>
<div class="line"><span class="lineno"> 2493</span>    pthread_join( netw -&gt; send_thr, NULL );</div>
<div class="line"><span class="lineno"> 2494</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;Network %d waits for recv threads to stop&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2495</span>    pthread_join( netw -&gt; recv_thr, NULL );</div>
<div class="line"><span class="lineno"> 2496</span> </div>
<div class="line"><span class="lineno"> 2497</span>    <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">,</a> NETW_EXITED|NETW_THR_ENGINE_STOPPED <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">)</a>;</div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>,  <span class="stringliteral">&quot;Network %d threads Stopped !&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2500</span> </div>
<div class="line"><span class="lineno"> 2501</span>    <span class="keywordflow">return</span> TRUE;</div>
<div class="line"><span class="lineno"> 2502</span>} <span class="comment">/* Stop_Network( ... ) */</span></div>
<div class="line"><span class="lineno"> 2503</span> </div>
<div class="line"><span class="lineno"> 2504</span> </div>
<div class="line"><span class="lineno"> 2505</span> </div>
<div class="line"><span class="lineno"> 2506</span><span class="comment">/*!\fn send_data( SOCKET s , char *buf, NSTRBYTE n )</span></div>
<div class="line"><span class="lineno"> 2507</span><span class="comment"> *\brief send data onto the socket</span></div>
<div class="line"><span class="lineno"> 2508</span><span class="comment"> *\param s connected socket</span></div>
<div class="line"><span class="lineno"> 2509</span><span class="comment"> *\param buf pointer to buffer</span></div>
<div class="line"><span class="lineno"> 2510</span><span class="comment"> *\param n number of characters we want to send</span></div>
<div class="line"><span class="lineno"> 2511</span><span class="comment"> *\return -1 on error, -2 on disconnection, n on success</span></div>
<div class="line"><span class="lineno"> 2512</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf3dc736265484a58e6678c250e38cef8"> 2513</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf3dc736265484a58e6678c250e38cef8">send_data</a>( SOCKET s, <span class="keywordtype">char</span> *buf, NSTRBYTE n )</div>
<div class="line"><span class="lineno"> 2514</span>{</div>
<div class="line"><span class="lineno"> 2515</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( buf, <span class="keywordflow">return</span> -1 );</div>
<div class="line"><span class="lineno"> 2516</span> </div>
<div class="line"><span class="lineno"> 2517</span>    <span class="keywordtype">int</span> bcount = 0 ; <span class="comment">/* counts bytes sent */</span></div>
<div class="line"><span class="lineno"> 2518</span> </div>
<div class="line"><span class="lineno"> 2519</span>    <span class="keywordtype">int</span> error = 0 ;</div>
<div class="line"><span class="lineno"> 2520</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 2521</span> </div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">if</span>( n == 0 )</div>
<div class="line"><span class="lineno"> 2523</span>    {</div>
<div class="line"><span class="lineno"> 2524</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Send of 0 is unsupported.&quot;</span> );</div>
<div class="line"><span class="lineno"> 2525</span>        <span class="keywordflow">return</span> -1 ;</div>
<div class="line"><span class="lineno"> 2526</span>    }</div>
<div class="line"><span class="lineno"> 2527</span> </div>
<div class="line"><span class="lineno"> 2528</span>    <span class="keywordflow">while</span>( (NSTRBYTE)bcount &lt; n )                 <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2529</span>    {</div>
<div class="line"><span class="lineno"> 2530</span>        <span class="keywordtype">int</span> br = 0 ;     <span class="comment">/* bytes sent this pass */</span></div>
<div class="line"><span class="lineno"> 2531</span>        br = send( s, buf, n - bcount, NETFLAGS );</div>
<div class="line"><span class="lineno"> 2532</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2533</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2534</span>        {</div>
<div class="line"><span class="lineno"> 2535</span>            bcount += br;                <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2536</span>            buf += br;                   <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2537</span>        }</div>
<div class="line"><span class="lineno"> 2538</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2539</span>        {</div>
<div class="line"><span class="lineno"> 2540</span>            <span class="keywordflow">if</span>( error == ECONNRESET || error == ENOTCONN )</div>
<div class="line"><span class="lineno"> 2541</span>            {</div>
<div class="line"><span class="lineno"> 2542</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;socket %d disconnected !&quot;</span>, s );</div>
<div class="line"><span class="lineno"> 2543</span>                <span class="keywordflow">return</span> -2 ;</div>
<div class="line"><span class="lineno"> 2544</span>            }</div>
<div class="line"><span class="lineno"> 2545</span>            <span class="comment">/* signal an error to the caller */</span></div>
<div class="line"><span class="lineno"> 2546</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2547</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Socket %d send Error: %d , %s&quot;</span>, s, br, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2548</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2549</span>            <span class="keywordflow">return</span> -1 ;</div>
<div class="line"><span class="lineno"> 2550</span>        }</div>
<div class="line"><span class="lineno"> 2551</span>    }</div>
<div class="line"><span class="lineno"> 2552</span> </div>
<div class="line"><span class="lineno"> 2553</span>    <span class="keywordflow">return</span> bcount;</div>
<div class="line"><span class="lineno"> 2554</span>} <span class="comment">/*send_data(...)*/</span></div>
<div class="line"><span class="lineno"> 2555</span> </div>
<div class="line"><span class="lineno"> 2556</span><span class="comment">/*!\fn recv_data( SOCKET s , char *buf, NSTRBYTE n )</span></div>
<div class="line"><span class="lineno"> 2557</span><span class="comment"> *\brief recv data from the socket</span></div>
<div class="line"><span class="lineno"> 2558</span><span class="comment"> *\param s connected socket</span></div>
<div class="line"><span class="lineno"> 2559</span><span class="comment"> *\param buf pointer to buffer</span></div>
<div class="line"><span class="lineno"> 2560</span><span class="comment"> *\param n number of characters we want</span></div>
<div class="line"><span class="lineno"> 2561</span><span class="comment"> *\return -1 on error, -2 on disconnection n on success</span></div>
<div class="line"><span class="lineno"> 2562</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga1fc319fa3b0eba19e163070a9fb3dae4"> 2563</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga1fc319fa3b0eba19e163070a9fb3dae4">recv_data</a>( SOCKET s, <span class="keywordtype">char</span> *buf, NSTRBYTE n )</div>
<div class="line"><span class="lineno"> 2564</span>{</div>
<div class="line"><span class="lineno"> 2565</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( buf, <span class="keywordflow">return</span> -1 );</div>
<div class="line"><span class="lineno"> 2566</span>    <span class="keywordtype">int</span> bcount = 0 ; <span class="comment">/* counts bytes read */</span></div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>    <span class="keywordtype">int</span> error = 0 ;</div>
<div class="line"><span class="lineno"> 2569</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 2570</span> </div>
<div class="line"><span class="lineno"> 2571</span>    <span class="keywordflow">if</span>( n == 0 )</div>
<div class="line"><span class="lineno"> 2572</span>    {</div>
<div class="line"><span class="lineno"> 2573</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Recv of 0 is unsupported.&quot;</span> );</div>
<div class="line"><span class="lineno"> 2574</span>        <span class="keywordflow">return</span> -1 ;</div>
<div class="line"><span class="lineno"> 2575</span>    }</div>
<div class="line"><span class="lineno"> 2576</span> </div>
<div class="line"><span class="lineno"> 2577</span>    <span class="keywordflow">while</span>( (NSTRBYTE)bcount &lt; n )</div>
<div class="line"><span class="lineno"> 2578</span>    {</div>
<div class="line"><span class="lineno"> 2579</span>        <span class="keywordtype">int</span> br = 0 ;     <span class="comment">/* bytes read this pass */</span></div>
<div class="line"><span class="lineno"> 2580</span>        <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2581</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gaf355f5fc76fc13a2bb894b92f7fb1ad9">CALL_RETRY</a>( br, recv( s, buf, n - bcount, NETFLAGS ) );</div>
<div class="line"><span class="lineno"> 2582</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2583</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2584</span>        {</div>
<div class="line"><span class="lineno"> 2585</span>            bcount += br;                    <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2586</span>            buf += br;                       <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2587</span>        }</div>
<div class="line"><span class="lineno"> 2588</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2589</span>        {</div>
<div class="line"><span class="lineno"> 2590</span>            <span class="keywordflow">if</span>( br == 0 )</div>
<div class="line"><span class="lineno"> 2591</span>            {</div>
<div class="line"><span class="lineno"> 2592</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;socket %d disconnected !&quot;</span>, s );</div>
<div class="line"><span class="lineno"> 2593</span>                <span class="keywordflow">return</span> -2 ;</div>
<div class="line"><span class="lineno"> 2594</span>            }</div>
<div class="line"><span class="lineno"> 2595</span> </div>
<div class="line"><span class="lineno"> 2596</span>            <span class="comment">/* signal an error to the caller */</span></div>
<div class="line"><span class="lineno"> 2597</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2598</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;socket %d recv returned %d, error: %s&quot;</span>, s, br, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2599</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2600</span>            <span class="keywordflow">return</span> -1 ;</div>
<div class="line"><span class="lineno"> 2601</span>        }</div>
<div class="line"><span class="lineno"> 2602</span>    }</div>
<div class="line"><span class="lineno"> 2603</span> </div>
<div class="line"><span class="lineno"> 2604</span>    <span class="keywordflow">return</span> bcount;</div>
<div class="line"><span class="lineno"> 2605</span>} <span class="comment">/*recv_data(...)*/</span></div>
<div class="line"><span class="lineno"> 2606</span> </div>
<div class="line"><span class="lineno"> 2607</span> </div>
<div class="line"><span class="lineno"> 2608</span> </div>
<div class="line"><span class="lineno"> 2609</span><span class="comment">/*!\fn int send_php( SOCKET s, int _code , char *buf, int n )</span></div>
<div class="line"><span class="lineno"> 2610</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2611</span><span class="comment"> *\brief send data onto the socket</span></div>
<div class="line"><span class="lineno"> 2612</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2613</span><span class="comment"> *\param s connected socket</span></div>
<div class="line"><span class="lineno"> 2614</span><span class="comment"> *\param buf pointer to buffer</span></div>
<div class="line"><span class="lineno"> 2615</span><span class="comment"> *\param n number of characters we want to send</span></div>
<div class="line"><span class="lineno"> 2616</span><span class="comment"> *\param _code Code for php decoding rule</span></div>
<div class="line"><span class="lineno"> 2617</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2618</span><span class="comment"> *\return -1 on error, n on success</span></div>
<div class="line"><span class="lineno"> 2619</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"> 2620</span> </div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga0f3aa54a82aed45e85124acbd7af6a29"> 2621</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga0f3aa54a82aed45e85124acbd7af6a29">send_php</a>( SOCKET s, <span class="keywordtype">int</span> _code, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> n )</div>
<div class="line"><span class="lineno"> 2622</span>{</div>
<div class="line"><span class="lineno"> 2623</span>    <span class="keywordtype">int</span> bcount = 0 ;   <span class="comment">/* counts bytes read */</span></div>
<div class="line"><span class="lineno"> 2624</span>    <span class="keywordtype">int</span> br = 0 ;       <span class="comment">/* bytes read this pass */</span></div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>    <span class="keywordtype">int</span> error = 0 ;</div>
<div class="line"><span class="lineno"> 2627</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 2628</span> </div>
<div class="line"><span class="lineno"> 2629</span>    <span class="keywordtype">char</span> *ptr = NULL ; <span class="comment">/* temp char ptr ;-) */</span></div>
<div class="line"><span class="lineno"> 2630</span>    <span class="keywordtype">char</span> tmpstr[ <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> +1 ] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keywordtype">char</span> head[ <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> +1 ] = <span class="stringliteral">&quot;&quot;</span> ;</div>
<div class="line"><span class="lineno"> 2632</span>    <span class="keywordtype">char</span> code[ <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> +1 ] = <span class="stringliteral">&quot;&quot;</span> ;</div>
<div class="line"><span class="lineno"> 2633</span> </div>
<div class="line"><span class="lineno"> 2634</span>    snprintf( tmpstr, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> + 1, <span class="stringliteral">&quot;%%0%dd&quot;</span>, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> );</div>
<div class="line"><span class="lineno"> 2635</span>    snprintf( head, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> + 1, tmpstr, n );</div>
<div class="line"><span class="lineno"> 2636</span>    snprintf( tmpstr, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> + 1, <span class="stringliteral">&quot;%%0%dd&quot;</span>, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> );</div>
<div class="line"><span class="lineno"> 2637</span>    snprintf( code, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> + 1, tmpstr, _code );</div>
<div class="line"><span class="lineno"> 2638</span> </div>
<div class="line"><span class="lineno"> 2639</span>    <span class="comment">/* sending head */</span></div>
<div class="line"><span class="lineno"> 2640</span>    bcount = br = 0 ;</div>
<div class="line"><span class="lineno"> 2641</span>    ptr = head ;</div>
<div class="line"><span class="lineno"> 2642</span>    <span class="keywordflow">while</span> ( bcount &lt; <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> )                 <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2643</span>    {</div>
<div class="line"><span class="lineno"> 2644</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gaf355f5fc76fc13a2bb894b92f7fb1ad9">CALL_RETRY</a>( br, send( s, head, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> - bcount, NETFLAGS ) );</div>
<div class="line"><span class="lineno"> 2645</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2646</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2647</span>        {</div>
<div class="line"><span class="lineno"> 2648</span>            bcount += br;                <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2649</span>            ptr += br;                   <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2650</span>        }</div>
<div class="line"><span class="lineno"> 2651</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2652</span>        {</div>
<div class="line"><span class="lineno"> 2653</span>            <span class="comment">/* signal an error to the caller */</span></div>
<div class="line"><span class="lineno"> 2654</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2655</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Socket %d sending Error %d when sending head size, neterrno: %s&quot;</span>, s, br, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2656</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2657</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2658</span>        }</div>
<div class="line"><span class="lineno"> 2659</span>    }</div>
<div class="line"><span class="lineno"> 2660</span> </div>
<div class="line"><span class="lineno"> 2661</span>    <span class="comment">/* sending code */</span></div>
<div class="line"><span class="lineno"> 2662</span>    bcount = br = 0 ;</div>
<div class="line"><span class="lineno"> 2663</span>    ptr = code ;</div>
<div class="line"><span class="lineno"> 2664</span>    <span class="keywordflow">while</span> ( bcount &lt; <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> )                 <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2665</span>    {</div>
<div class="line"><span class="lineno"> 2666</span>        br = send( s, code, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> - bcount, NETFLAGS );</div>
<div class="line"><span class="lineno"> 2667</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2668</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2669</span>        {</div>
<div class="line"><span class="lineno"> 2670</span>            bcount += br;                <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2671</span>            ptr += br;                   <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2672</span>        }</div>
<div class="line"><span class="lineno"> 2673</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2674</span>        {</div>
<div class="line"><span class="lineno"> 2675</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2676</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>,  <span class="stringliteral">&quot;Socket %d sending Error %d when sending head code, neterrno: %s&quot;</span>, s, br, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2677</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2678</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2679</span>        }</div>
<div class="line"><span class="lineno"> 2680</span>    }</div>
<div class="line"><span class="lineno"> 2681</span> </div>
<div class="line"><span class="lineno"> 2682</span>    <span class="comment">/* sending buf */</span></div>
<div class="line"><span class="lineno"> 2683</span>    bcount = 0;</div>
<div class="line"><span class="lineno"> 2684</span>    br = 0;</div>
<div class="line"><span class="lineno"> 2685</span>    <span class="keywordflow">while</span> ( bcount &lt; n )                 <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2686</span>    {</div>
<div class="line"><span class="lineno"> 2687</span>        br = send( s, buf, n - bcount, NETFLAGS );</div>
<div class="line"><span class="lineno"> 2688</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2689</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2690</span>        {</div>
<div class="line"><span class="lineno"> 2691</span>            bcount += br;                <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2692</span>            buf += br;                   <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2693</span>        }</div>
<div class="line"><span class="lineno"> 2694</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2695</span>        {</div>
<div class="line"><span class="lineno"> 2696</span>            <span class="comment">/* signal an error to the caller */</span></div>
<div class="line"><span class="lineno"> 2697</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2698</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Socket %d sending Error %d when sending message of size %d, neterrno: %S&quot;</span>, s, br, n, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2699</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2700</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2701</span>        }</div>
<div class="line"><span class="lineno"> 2702</span>    }</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>    <span class="keywordflow">return</span> bcount;</div>
<div class="line"><span class="lineno"> 2705</span> </div>
<div class="line"><span class="lineno"> 2706</span>} <span class="comment">/*send_php(...)*/</span></div>
<div class="line"><span class="lineno"> 2707</span> </div>
<div class="line"><span class="lineno"> 2708</span> </div>
<div class="line"><span class="lineno"> 2709</span> </div>
<div class="line"><span class="lineno"> 2710</span><span class="comment">/*!\fn int recv_php( SOCKET s, int *_code , char **buf )</span></div>
<div class="line"><span class="lineno"> 2711</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2712</span><span class="comment"> *\brief recv data from the socket</span></div>
<div class="line"><span class="lineno"> 2713</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2714</span><span class="comment"> *\param s connected socket</span></div>
<div class="line"><span class="lineno"> 2715</span><span class="comment"> *\param _code pointer to store the code</span></div>
<div class="line"><span class="lineno"> 2716</span><span class="comment"> *\param buf pointer to buffer</span></div>
<div class="line"><span class="lineno"> 2717</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2718</span><span class="comment"> *\return -1 on error, size on success</span></div>
<div class="line"><span class="lineno"> 2719</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf3e1619c354974bd6a40b511b2896e60"> 2720</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaf3e1619c354974bd6a40b511b2896e60">recv_php</a>( SOCKET s, <span class="keywordtype">int</span> *_code, <span class="keywordtype">char</span> **buf )</div>
<div class="line"><span class="lineno"> 2721</span>{</div>
<div class="line"><span class="lineno"> 2722</span>    <span class="keywordtype">int</span> bcount = 0 ; <span class="comment">/* counts bytes read */</span></div>
<div class="line"><span class="lineno"> 2723</span>    <span class="keywordtype">int</span> br = 0 ;     <span class="comment">/* bytes read this pass */</span></div>
<div class="line"><span class="lineno"> 2724</span>    <span class="keywordtype">long</span> <span class="keywordtype">int</span> tmpnb = 0, size = 0 ;    <span class="comment">/* size of message to receive */</span></div>
<div class="line"><span class="lineno"> 2725</span>    <span class="keywordtype">char</span> *ptr = NULL ;</div>
<div class="line"><span class="lineno"> 2726</span> </div>
<div class="line"><span class="lineno"> 2727</span>    <span class="keywordtype">int</span> error = 0 ;</div>
<div class="line"><span class="lineno"> 2728</span>    <span class="keywordtype">char</span> *errmsg = NULL ;</div>
<div class="line"><span class="lineno"> 2729</span> </div>
<div class="line"><span class="lineno"> 2730</span>    <span class="keywordtype">char</span> head[ <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> + 1 ] = <span class="stringliteral">&quot;&quot;</span> ;</div>
<div class="line"><span class="lineno"> 2731</span>    <span class="keywordtype">char</span> code[ <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> + 1]  = <span class="stringliteral">&quot;&quot;</span> ;</div>
<div class="line"><span class="lineno"> 2732</span> </div>
<div class="line"><span class="lineno"> 2733</span>    <span class="comment">/* Receiving total message size */</span></div>
<div class="line"><span class="lineno"> 2734</span>    bcount = br = 0 ;</div>
<div class="line"><span class="lineno"> 2735</span>    ptr = head;</div>
<div class="line"><span class="lineno"> 2736</span>    <span class="keywordflow">while</span> ( bcount &lt; <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> )</div>
<div class="line"><span class="lineno"> 2737</span>    {</div>
<div class="line"><span class="lineno"> 2738</span>        <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2739</span>        br = recv( s, ptr, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> - bcount, NETFLAGS );</div>
<div class="line"><span class="lineno"> 2740</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2741</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2742</span>        {</div>
<div class="line"><span class="lineno"> 2743</span>            bcount += br;                    <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2744</span>            ptr += br;                       <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2745</span>        }</div>
<div class="line"><span class="lineno"> 2746</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2747</span>        {</div>
<div class="line"><span class="lineno"> 2748</span>            <span class="keywordflow">if</span>( br == 0 &amp;&amp; bcount == ( <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a> - bcount ) )</div>
<div class="line"><span class="lineno"> 2749</span>                <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 2750</span>            <span class="comment">/* signal an error to the caller */</span></div>
<div class="line"><span class="lineno"> 2751</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2752</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Socket %d receive %d Error %s&quot;</span>, s, br, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2753</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2754</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2755</span>        }</div>
<div class="line"><span class="lineno"> 2756</span>    }</div>
<div class="line"><span class="lineno"> 2757</span> </div>
<div class="line"><span class="lineno"> 2758</span>    tmpnb = strtol( head, NULL, 10 );</div>
<div class="line"><span class="lineno"> 2759</span>    <span class="keywordflow">if</span>( tmpnb == LONG_MIN || tmpnb == LONG_MAX )</div>
<div class="line"><span class="lineno"> 2760</span>    {</div>
<div class="line"><span class="lineno"> 2761</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Size received ( %ld ) can not be determined on socket %d&quot;</span>, tmpnb, s );</div>
<div class="line"><span class="lineno"> 2762</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2763</span>    }</div>
<div class="line"><span class="lineno"> 2764</span> </div>
<div class="line"><span class="lineno"> 2765</span>    size = tmpnb ;</div>
<div class="line"><span class="lineno"> 2766</span> </div>
<div class="line"><span class="lineno"> 2767</span>    <span class="comment">/* receiving request code */</span></div>
<div class="line"><span class="lineno"> 2768</span>    bcount = br = 0 ;</div>
<div class="line"><span class="lineno"> 2769</span>    ptr = code;</div>
<div class="line"><span class="lineno"> 2770</span>    <span class="keywordflow">while</span> ( bcount &lt; <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> )</div>
<div class="line"><span class="lineno"> 2771</span>    {</div>
<div class="line"><span class="lineno"> 2772</span>        <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2773</span>        br = recv( s, ptr, <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> - bcount, NETFLAGS );</div>
<div class="line"><span class="lineno"> 2774</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2775</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2776</span>        {</div>
<div class="line"><span class="lineno"> 2777</span>            bcount += br;                    <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2778</span>            ptr += br;                       <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2779</span>        }</div>
<div class="line"><span class="lineno"> 2780</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2781</span>        {</div>
<div class="line"><span class="lineno"> 2782</span>            <span class="keywordflow">if</span>( br == 0 &amp;&amp; bcount == ( <a class="code hl_define" href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a> - bcount ) )</div>
<div class="line"><span class="lineno"> 2783</span>                <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 2784</span>            <span class="comment">/* signal an error to the caller */</span></div>
<div class="line"><span class="lineno"> 2785</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2786</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Socket %d receive %d Error , neterrno: %s&quot;</span>, s, br, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2787</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2788</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2789</span>        }</div>
<div class="line"><span class="lineno"> 2790</span>    }</div>
<div class="line"><span class="lineno"> 2791</span> </div>
<div class="line"><span class="lineno"> 2792</span>    tmpnb = strtol( code, NULL, 10 );</div>
<div class="line"><span class="lineno"> 2793</span>    <span class="keywordflow">if</span>( tmpnb == LONG_MIN || tmpnb == LONG_MAX )</div>
<div class="line"><span class="lineno"> 2794</span>    {</div>
<div class="line"><span class="lineno"> 2795</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Code received ( %ld ) can not be determined on socket %d\n&quot;</span>, tmpnb, s );</div>
<div class="line"><span class="lineno"> 2796</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2797</span>    }</div>
<div class="line"><span class="lineno"> 2798</span> </div>
<div class="line"><span class="lineno"> 2799</span>    (*_code) = tmpnb ;</div>
<div class="line"><span class="lineno"> 2800</span> </div>
<div class="line"><span class="lineno"> 2801</span>    <span class="comment">/* receving message */</span></div>
<div class="line"><span class="lineno"> 2802</span>    <span class="keywordflow">if</span>( (*buf ) )</div>
<div class="line"><span class="lineno"> 2803</span>    {</div>
<div class="line"><span class="lineno"> 2804</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( (*buf ) );</div>
<div class="line"><span class="lineno"> 2805</span>    }</div>
<div class="line"><span class="lineno"> 2806</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( (*buf), <span class="keywordtype">char</span>, (size+1) );</div>
<div class="line"><span class="lineno"> 2807</span>    <span class="keywordflow">if</span>( !(*buf ) )</div>
<div class="line"><span class="lineno"> 2808</span>    {</div>
<div class="line"><span class="lineno"> 2809</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Could not allocate PHP receive buf&quot;</span> );</div>
<div class="line"><span class="lineno"> 2810</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2811</span>    }</div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span>    bcount = 0;</div>
<div class="line"><span class="lineno"> 2814</span>    br = 0;</div>
<div class="line"><span class="lineno"> 2815</span>    ptr = (*buf);</div>
<div class="line"><span class="lineno"> 2816</span>    <span class="keywordflow">while</span> ( bcount &lt; size )</div>
<div class="line"><span class="lineno"> 2817</span>    {</div>
<div class="line"><span class="lineno"> 2818</span>        <span class="comment">/* loop until full buffer */</span></div>
<div class="line"><span class="lineno"> 2819</span>        br = recv( s, ptr, size - bcount, NETFLAGS );</div>
<div class="line"><span class="lineno"> 2820</span>        error = <a class="code hl_define" href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a> ;</div>
<div class="line"><span class="lineno"> 2821</span>        <span class="keywordflow">if</span>( br &gt; 0 )</div>
<div class="line"><span class="lineno"> 2822</span>        {</div>
<div class="line"><span class="lineno"> 2823</span>            bcount += br;                    <span class="comment">/* increment byte counter */</span></div>
<div class="line"><span class="lineno"> 2824</span>            ptr += br;                       <span class="comment">/* move buffer ptr for next read */</span></div>
<div class="line"><span class="lineno"> 2825</span>        }</div>
<div class="line"><span class="lineno"> 2826</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2827</span>        {</div>
<div class="line"><span class="lineno"> 2828</span>            <span class="keywordflow">if</span>( br == 0 &amp;&amp; bcount == ( size - bcount ) )</div>
<div class="line"><span class="lineno"> 2829</span>                <span class="keywordflow">break</span> ;</div>
<div class="line"><span class="lineno"> 2830</span>            <span class="comment">/* signal an error to the caller */</span></div>
<div class="line"><span class="lineno"> 2831</span>            errmsg = <a class="code hl_define" href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a>( error );</div>
<div class="line"><span class="lineno"> 2832</span>            <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Socket %d receive %d Error neterrno: %s&quot;</span>, s, br, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a>( errmsg ) );</div>
<div class="line"><span class="lineno"> 2833</span>            <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a>( errmsg );</div>
<div class="line"><span class="lineno"> 2834</span>            <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><span class="lineno"> 2835</span>        }</div>
<div class="line"><span class="lineno"> 2836</span>    }</div>
<div class="line"><span class="lineno"> 2837</span>    <span class="keywordflow">return</span> size ;</div>
<div class="line"><span class="lineno"> 2838</span>} <span class="comment">/*recv_php(...)*/</span></div>
<div class="line"><span class="lineno"> 2839</span> </div>
<div class="line"><span class="lineno"> 2840</span> </div>
<div class="line"><span class="lineno"> 2841</span> </div>
<div class="line"><span class="lineno"> 2842</span><span class="comment">/*!\fn int netw_get_queue_status( NETWORK *netw, int *nb_to_send, int *nb_to_read )</span></div>
<div class="line"><span class="lineno"> 2843</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2844</span><span class="comment"> *\brief retrieve network send queue status</span></div>
<div class="line"><span class="lineno"> 2845</span><span class="comment"> *\param netw NETWORK object</span></div>
<div class="line"><span class="lineno"> 2846</span><span class="comment"> *\param nb_to_send Number of messages still in send buffer (not yet submitted to kernel)</span></div>
<div class="line"><span class="lineno"> 2847</span><span class="comment"> *\param nb_to_read Number of message already read by the kernel, waiting in the local message list</span></div>
<div class="line"><span class="lineno"> 2848</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 2849</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga7db2f701ab9a20af4a6fa8baac9d5172"> 2850</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga7db2f701ab9a20af4a6fa8baac9d5172">netw_get_queue_status</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> *nb_to_send, <span class="keywordtype">int</span> *nb_to_read )</div>
<div class="line"><span class="lineno"> 2851</span>{</div>
<div class="line"><span class="lineno"> 2852</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2853</span> </div>
<div class="line"><span class="lineno"> 2854</span>    pthread_mutex_lock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2855</span>    (*nb_to_send) = netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">send_buf</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">nb_items</a> ;</div>
<div class="line"><span class="lineno"> 2856</span>    pthread_mutex_unlock( &amp;netw -&gt; sendbolt );</div>
<div class="line"><span class="lineno"> 2857</span> </div>
<div class="line"><span class="lineno"> 2858</span>    pthread_mutex_lock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 2859</span>    (*nb_to_read) = netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">recv_buf</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">-&gt;</a> <a class="code hl_variable" href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">nb_items</a> ;</div>
<div class="line"><span class="lineno"> 2860</span>    pthread_mutex_unlock( &amp;netw -&gt; recvbolt );</div>
<div class="line"><span class="lineno"> 2861</span> </div>
<div class="line"><span class="lineno"> 2862</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 2863</span>} <span class="comment">/* get queue states */</span></div>
<div class="line"><span class="lineno"> 2864</span> </div>
<div class="line"><span class="lineno"> 2865</span> </div>
<div class="line"><span class="lineno"> 2866</span> </div>
<div class="line"><span class="lineno"> 2867</span><span class="comment">/*!\fn NETWORK_POOL *netw_new_pool( int nb_min_element )</span></div>
<div class="line"><span class="lineno"> 2868</span><span class="comment"> *</span></div>
<div class="line"><span class="lineno"> 2869</span><span class="comment"> *\brief return a new network pool of nb_min_element</span></div>
<div class="line"><span class="lineno"> 2870</span><span class="comment"> *\return a new NETWORK_POOL or NULL</span></div>
<div class="line"><span class="lineno"> 2871</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gadb5284c7b187815cf3b286a5cd972876"> 2872</a></span><a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gadb5284c7b187815cf3b286a5cd972876">netw_new_pool</a>( <span class="keywordtype">int</span> nb_min_element )</div>
<div class="line"><span class="lineno"> 2873</span>{</div>
<div class="line"><span class="lineno"> 2874</span>    <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *netw_pool = NULL ;</div>
<div class="line"><span class="lineno"> 2875</span> </div>
<div class="line"><span class="lineno"> 2876</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a>( netw_pool, <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a>, 1 );</div>
<div class="line"><span class="lineno"> 2877</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw_pool, <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno"> 2878</span> </div>
<div class="line"><span class="lineno"> 2879</span>    netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a> = <a class="code hl_function" href="group___h_a_s_h___t_a_b_l_e.html#gaa2d879c1afd3c71a0917bbe2c0766664">new_ht</a><a class="code hl_function" href="group___h_a_s_h___t_a_b_l_e.html#gaa2d879c1afd3c71a0917bbe2c0766664">(</a> nb_min_element <a class="code hl_function" href="group___h_a_s_h___t_a_b_l_e.html#gaa2d879c1afd3c71a0917bbe2c0766664">)</a>;</div>
<div class="line"><span class="lineno"> 2880</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a>, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( netw_pool ) ; <span class="keywordflow">return</span> NULL );</div>
<div class="line"><span class="lineno"> 2881</span> </div>
<div class="line"><span class="lineno"> 2882</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga0499ff5244b948781a28466e35282c55">init_lock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2883</span> </div>
<div class="line"><span class="lineno"> 2884</span>    <span class="keywordflow">return</span> netw_pool ;</div>
<div class="line"><span class="lineno"> 2885</span>} <span class="comment">/* netw_new_pool() */</span></div>
<div class="line"><span class="lineno"> 2886</span> </div>
<div class="line"><span class="lineno"> 2887</span> </div>
<div class="line"><span class="lineno"> 2888</span> </div>
<div class="line"><span class="lineno"> 2889</span><span class="comment">/*!\fn int netw_destroy_pool( NETWORK_POOL **netw_pool )</span></div>
<div class="line"><span class="lineno"> 2890</span><span class="comment"> *\brief free a network pool</span></div>
<div class="line"><span class="lineno"> 2891</span><span class="comment"> *\param the address of a pointer to free</span></div>
<div class="line"><span class="lineno"> 2892</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 2893</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga5c0996a0b85b32d296c4e679a6eb86c2"> 2894</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga5c0996a0b85b32d296c4e679a6eb86c2">netw_destroy_pool</a>(  <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> **netw_pool )</div>
<div class="line"><span class="lineno"> 2895</span>{</div>
<div class="line"><span class="lineno"> 2896</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw_pool&amp;&amp;(*netw_pool), <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2897</span> </div>
<div class="line"><span class="lineno"> 2898</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gabf9cebcdf845c2c9b879a608be4c9dce">write_lock</a>( (*netw_pool) -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2899</span>    <span class="keywordflow">if</span>( (*netw_pool) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a> )</div>
<div class="line"><span class="lineno"> 2900</span>        <a class="code hl_function" href="group___h_a_s_h___t_a_b_l_e.html#ga22a943135dbcdb1611b40ce0547111ce">destroy_ht</a><a class="code hl_function" href="group___h_a_s_h___t_a_b_l_e.html#ga22a943135dbcdb1611b40ce0547111ce">(</a> &amp;(*netw_pool) <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a> <a class="code hl_function" href="group___h_a_s_h___t_a_b_l_e.html#ga22a943135dbcdb1611b40ce0547111ce">)</a>;</div>
<div class="line"><span class="lineno"> 2901</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a>( (*netw_pool) -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2902</span> </div>
<div class="line"><span class="lineno"> 2903</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga68d60dda02e374e8d2e38deb9aecadcd">rw_lock_destroy</a>( (*netw_pool) -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2904</span> </div>
<div class="line"><span class="lineno"> 2905</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a>( (*netw_pool) );</div>
<div class="line"><span class="lineno"> 2906</span> </div>
<div class="line"><span class="lineno"> 2907</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 2908</span>} <span class="comment">/* netw_destroy_pool() */</span></div>
<div class="line"><span class="lineno"> 2909</span> </div>
<div class="line"><span class="lineno"> 2910</span> </div>
<div class="line"><span class="lineno"> 2911</span> </div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gab0da745063a55fd79b6252339d5276a4"> 2912</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gab0da745063a55fd79b6252339d5276a4">netw_pool_netw_close</a>( <span class="keywordtype">void</span> *netw_ptr )</div>
<div class="line"><span class="lineno"> 2913</span>{</div>
<div class="line"><span class="lineno"> 2914</span>    <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw = (<a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *)netw_ptr ;</div>
<div class="line"><span class="lineno"> 2915</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> );</div>
<div class="line"><span class="lineno"> 2916</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Network pool %p: network id %d still active !!&quot;</span>, netw, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2917</span>    <span class="keywordflow">return</span> ;</div>
<div class="line"><span class="lineno"> 2918</span>}</div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span> </div>
<div class="line"><span class="lineno"> 2921</span> </div>
<div class="line"><span class="lineno"> 2922</span><span class="comment">/* add network to pool */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gaed3d4b17261c0ce51cd7671b81b5a007"> 2923</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gaed3d4b17261c0ce51cd7671b81b5a007">netw_pool_add</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *netw_pool, <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw )</div>
<div class="line"><span class="lineno"> 2924</span>{</div>
<div class="line"><span class="lineno"> 2925</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw_pool, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2926</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2927</span> </div>
<div class="line"><span class="lineno"> 2928</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Trying to add %lld to %p&quot;</span><a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>)netw -&gt; link . sock<a class="code hl_function" href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">,</a> netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a> );</div>
<div class="line"><span class="lineno"> 2929</span> </div>
<div class="line"><span class="lineno"> 2930</span>    <span class="comment">/* write lock the pool */</span></div>
<div class="line"><span class="lineno"> 2931</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gabf9cebcdf845c2c9b879a608be4c9dce">write_lock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2932</span>    <span class="comment">/* test if not already added */</span></div>
<div class="line"><span class="lineno"> 2933</span>    N_STR *key = NULL ;</div>
<div class="line"><span class="lineno"> 2934</span>    <a class="code hl_define" href="group___n___s_t_r.html#ga1c1f4062c727970a68bfd932c3fabcd5">nstrprintf</a>( key, <span class="stringliteral">&quot;%lld&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>)netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2935</span>    <a class="code hl_struct" href="struct_h_a_s_h___n_o_d_e.html">HASH_NODE</a> *node = NULL ;</div>
<div class="line"><span class="lineno"> 2936</span>    <span class="keywordflow">if</span>( ht_get_ptr( netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a>, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gaf0e29edead3f943a4ac241c5724e1384">_nstr</a>( key ), (<span class="keywordtype">void</span> *)&amp;node ) == TRUE )</div>
<div class="line"><span class="lineno"> 2937</span>    {</div>
<div class="line"><span class="lineno"> 2938</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Network id %d already added !&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2939</span>        <a class="code hl_define" href="group___n___s_t_r.html#ga113e906d03374ac38e441f1df44095fb">free_nstr</a><a class="code hl_function" href="group___n___s_t_r.html#gaca4a7a2dfa962f043cb8f3762ce28761">(</a> &amp;key );</div>
<div class="line"><span class="lineno"> 2940</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2941</span>        <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2942</span>    }</div>
<div class="line"><span class="lineno"> 2943</span>    <span class="comment">/* add it */</span></div>
<div class="line"><span class="lineno"> 2944</span>    <span class="keywordtype">int</span> retval = ht_put_ptr( netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a>, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gaf0e29edead3f943a4ac241c5724e1384">_nstr</a>( key ), netw, &amp;<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gab0da745063a55fd79b6252339d5276a4">netw_pool_netw_close</a> );</div>
<div class="line"><span class="lineno"> 2945</span>    <a class="code hl_define" href="group___n___s_t_r.html#ga113e906d03374ac38e441f1df44095fb">free_nstr</a><a class="code hl_function" href="group___n___s_t_r.html#gaca4a7a2dfa962f043cb8f3762ce28761">(</a> &amp;key );</div>
<div class="line"><span class="lineno"> 2946</span>    list_push( netw -&gt; pools, netw_pool, NULL );</div>
<div class="line"><span class="lineno"> 2947</span> </div>
<div class="line"><span class="lineno"> 2948</span>    <span class="comment">/* unlock the pool */</span></div>
<div class="line"><span class="lineno"> 2949</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2950</span> </div>
<div class="line"><span class="lineno"> 2951</span>    <span class="keywordflow">return</span> retval ;</div>
<div class="line"><span class="lineno"> 2952</span>} <span class="comment">/* netw_pool_add */</span></div>
<div class="line"><span class="lineno"> 2953</span> </div>
<div class="line"><span class="lineno"> 2954</span> </div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span><span class="comment">/* remove network to pool */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gafc7a91b4be2a997710a2b54037c25168"> 2957</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gafc7a91b4be2a997710a2b54037c25168">netw_pool_remove</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *netw_pool, <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw )</div>
<div class="line"><span class="lineno"> 2958</span>{</div>
<div class="line"><span class="lineno"> 2959</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw_pool, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2960</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2961</span> </div>
<div class="line"><span class="lineno"> 2962</span>    <span class="comment">/* write lock the pool */</span></div>
<div class="line"><span class="lineno"> 2963</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gabf9cebcdf845c2c9b879a608be4c9dce">write_lock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2964</span>    <span class="comment">/* test if present */</span></div>
<div class="line"><span class="lineno"> 2965</span>    N_STR *key = NULL ;</div>
<div class="line"><span class="lineno"> 2966</span>    <a class="code hl_define" href="group___n___s_t_r.html#ga1c1f4062c727970a68bfd932c3fabcd5">nstrprintf</a>( key, <span class="stringliteral">&quot;%lld&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2967</span>    <span class="keywordflow">if</span>( ht_remove( netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a>, <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gaf0e29edead3f943a4ac241c5724e1384">_nstr</a>( key ) ) == TRUE )</div>
<div class="line"><span class="lineno"> 2968</span>    {</div>
<div class="line"><span class="lineno"> 2969</span>        LIST_NODE *node = <a class="code hl_function" href="group___l_i_s_t.html#gae009d6d3c835a2affb99071ea8457803">list_search</a><a class="code hl_function" href="group___l_i_s_t.html#gae009d6d3c835a2affb99071ea8457803">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">pools</a><a class="code hl_function" href="group___l_i_s_t.html#gae009d6d3c835a2affb99071ea8457803">,</a> netw <a class="code hl_function" href="group___l_i_s_t.html#gae009d6d3c835a2affb99071ea8457803">)</a>;</div>
<div class="line"><span class="lineno"> 2970</span>        <span class="keywordflow">if</span>( node )</div>
<div class="line"><span class="lineno"> 2971</span>        {</div>
<div class="line"><span class="lineno"> 2972</span>            <span class="keywordflow">if</span>( !<a class="code hl_define" href="group___l_i_s_t.html#ga366776cfa85e526b247ef1d348c34e0c">remove_list_node</a>( netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">pools</a>, node, <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> ) )</div>
<div class="line"><span class="lineno"> 2973</span>            {</div>
<div class="line"><span class="lineno"> 2974</span>                <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Network id %d could not be removed !&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2975</span>            }</div>
<div class="line"><span class="lineno"> 2976</span>        }</div>
<div class="line"><span class="lineno"> 2977</span>        <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2978</span>        <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Network id %d removed !&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2979</span> </div>
<div class="line"><span class="lineno"> 2980</span>        <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 2981</span>    }</div>
<div class="line"><span class="lineno"> 2982</span>    <a class="code hl_define" href="group___n___s_t_r.html#ga113e906d03374ac38e441f1df44095fb">free_nstr</a><a class="code hl_function" href="group___n___s_t_r.html#gaca4a7a2dfa962f043cb8f3762ce28761">(</a> &amp;key );</div>
<div class="line"><span class="lineno"> 2983</span>    <a class="code hl_define" href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a>( <a class="code hl_define" href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a>, <span class="stringliteral">&quot;Network id %d already removed !&quot;</span>, netw -&gt; link . sock );</div>
<div class="line"><span class="lineno"> 2984</span>    <span class="comment">/* unlock the pool */</span></div>
<div class="line"><span class="lineno"> 2985</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2986</span>    <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><span class="lineno"> 2987</span>} <span class="comment">/* netw_pool_remove */</span></div>
<div class="line"><span class="lineno"> 2988</span> </div>
<div class="line"><span class="lineno"> 2989</span> </div>
<div class="line"><span class="lineno"> 2990</span> </div>
<div class="line"><span class="lineno"> 2991</span><span class="comment">/* add message to pool */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga06115ed18a658114104ca6b6823f5d79"> 2992</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga06115ed18a658114104ca6b6823f5d79">netw_pool_broadcast</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *netw_pool, <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *from, N_STR *net_msg )</div>
<div class="line"><span class="lineno"> 2993</span>{</div>
<div class="line"><span class="lineno"> 2994</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw_pool, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2995</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( net_msg, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 2996</span> </div>
<div class="line"><span class="lineno"> 2997</span>    <span class="comment">/* write lock the pool */</span></div>
<div class="line"><span class="lineno"> 2998</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gaeba0ec63ec0aa6803e9a601b645b5cbf">read_lock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 2999</span>    <a class="code hl_define" href="group___h_a_s_h___t_a_b_l_e.html#ga072f117e6bd9fdde0d39776764b8784e">ht_foreach</a>( node, netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a> )</div>
<div class="line"><span class="lineno"> 3000</span>    {</div>
<div class="line"><span class="lineno"> 3001</span>        NETWORK *netw = <a class="code hl_define" href="group___h_a_s_h___t_a_b_l_e.html#gaeb031d4f0f896b1802b9c27e62f28d14">hash_val</a>( node, NETWORK );</div>
<div class="line"><span class="lineno"> 3002</span>        <span class="keywordflow">if</span>( from )</div>
<div class="line"><span class="lineno"> 3003</span>        {</div>
<div class="line"><span class="lineno"> 3004</span>            <span class="keywordflow">if</span>( netw -&gt; link . sock != from -&gt; link . sock )</div>
<div class="line"><span class="lineno"> 3005</span>                netw_add_msg( netw, nstrdup( net_msg ) );</div>
<div class="line"><span class="lineno"> 3006</span>        }</div>
<div class="line"><span class="lineno"> 3007</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3008</span>        {</div>
<div class="line"><span class="lineno"> 3009</span>            netw_add_msg( netw, nstrdup( net_msg ) );</div>
<div class="line"><span class="lineno"> 3010</span>        }</div>
<div class="line"><span class="lineno"> 3011</span>    }</div>
<div class="line"><span class="lineno"> 3012</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 3013</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 3014</span>} <span class="comment">/* netw_pool_broadcast */</span></div>
<div class="line"><span class="lineno"> 3015</span> </div>
<div class="line"><span class="lineno"> 3016</span> </div>
<div class="line"><span class="lineno"> 3017</span><span class="comment">/* get nb clients */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga17e1ca18a5396fc41632be200396eb8c"> 3018</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga17e1ca18a5396fc41632be200396eb8c">netw_pool_nbclients</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a> *netw_pool )</div>
<div class="line"><span class="lineno"> 3019</span>{</div>
<div class="line"><span class="lineno"> 3020</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw_pool, <span class="keywordflow">return</span> -1 );</div>
<div class="line"><span class="lineno"> 3021</span> </div>
<div class="line"><span class="lineno"> 3022</span>    <span class="keywordtype">int</span> nb = -1 ;</div>
<div class="line"><span class="lineno"> 3023</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#gaeba0ec63ec0aa6803e9a601b645b5cbf">read_lock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 3024</span>    nb = netw_pool <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">pool</a> <a class="code hl_variable" href="struct_h_a_s_h___t_a_b_l_e.html#a285c7cceac1e738fe12ce00a40fd6493">-&gt;</a> <a class="code hl_variable" href="struct_h_a_s_h___t_a_b_l_e.html#a285c7cceac1e738fe12ce00a40fd6493">nb_keys</a> ;</div>
<div class="line"><span class="lineno"> 3025</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a>( netw_pool -&gt; rwlock );</div>
<div class="line"><span class="lineno"> 3026</span> </div>
<div class="line"><span class="lineno"> 3027</span>    <span class="keywordflow">return</span> nb ;</div>
<div class="line"><span class="lineno"> 3028</span>}</div>
<div class="line"><span class="lineno"> 3029</span> </div>
<div class="line"><span class="lineno"> 3030</span> </div>
<div class="line"><span class="lineno"> 3031</span><span class="comment">/* set user id on a netw */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4dcf657c3f133ae52d1fa6f2a2e0cd18"> 3032</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga4dcf657c3f133ae52d1fa6f2a2e0cd18">netw_set_user_id</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> id )</div>
<div class="line"><span class="lineno"> 3033</span>{</div>
<div class="line"><span class="lineno"> 3034</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3035</span>    netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">user_id</a> = id ;</div>
<div class="line"><span class="lineno"> 3036</span>    <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><span class="lineno"> 3037</span>}</div>
<div class="line"><span class="lineno"> 3038</span> </div>
<div class="line"><span class="lineno"> 3039</span> </div>
<div class="line"><span class="lineno"> 3040</span> </div>
<div class="line"><span class="lineno"> 3041</span><span class="comment">/*!\fn netw_send_ping( NETWORK *netw , int id_from , int id_to , int time , int type )</span></div>
<div class="line"><span class="lineno"> 3042</span><span class="comment"> *\brief Add a ping reply to the network</span></div>
<div class="line"><span class="lineno"> 3043</span><span class="comment"> *\param netw The aimed NETWORK where we want to add something to send</span></div>
<div class="line"><span class="lineno"> 3044</span><span class="comment"> *\param id_from Identifiant of the sender</span></div>
<div class="line"><span class="lineno"> 3045</span><span class="comment"> *\param id_to Identifiant of the destination, -1 if the serveur itslef is targetted</span></div>
<div class="line"><span class="lineno"> 3046</span><span class="comment"> *\param time The time it was when the ping was sended</span></div>
<div class="line"><span class="lineno"> 3047</span><span class="comment"> *\param type NETW_PING_REQUEST or NETW_PING_REPLY</span></div>
<div class="line"><span class="lineno"> 3048</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 3049</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gad9588cf27263ecf40f57d3923ccf721a"> 3050</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad9588cf27263ecf40f57d3923ccf721a">netw_send_ping</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> type, <span class="keywordtype">int</span> id_from, <span class="keywordtype">int</span> id_to, <span class="keywordtype">int</span> time )</div>
<div class="line"><span class="lineno"> 3051</span>{</div>
<div class="line"><span class="lineno"> 3052</span>    N_STR *tmpstr = NULL ;</div>
<div class="line"><span class="lineno"> 3053</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3054</span> </div>
<div class="line"><span class="lineno"> 3055</span>    tmpstr = <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaeb5e94070c0ee79ff2d11a707d225c3a">netmsg_make_ping</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaeb5e94070c0ee79ff2d11a707d225c3a">(</a> type<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaeb5e94070c0ee79ff2d11a707d225c3a">,</a> id_from<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaeb5e94070c0ee79ff2d11a707d225c3a">,</a> id_to<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaeb5e94070c0ee79ff2d11a707d225c3a">,</a> time <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaeb5e94070c0ee79ff2d11a707d225c3a">)</a>;</div>
<div class="line"><span class="lineno"> 3056</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( tmpstr, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3057</span> </div>
<div class="line"><span class="lineno"> 3058</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">,</a> tmpstr <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">)</a>;</div>
<div class="line"><span class="lineno"> 3059</span>} <span class="comment">/* netw_send_ping( ... ) */</span></div>
<div class="line"><span class="lineno"> 3060</span> </div>
<div class="line"><span class="lineno"> 3061</span> </div>
<div class="line"><span class="lineno"> 3062</span> </div>
<div class="line"><span class="lineno"> 3063</span><span class="comment">/*!\fn int netw_send_ident( NETWORK *netw , int type , int id , N_STR *name , N_STR *passwd  )</span></div>
<div class="line"><span class="lineno"> 3064</span><span class="comment"> *\brief Add a formatted NETWMSG_IDENT message to the specified network</span></div>
<div class="line"><span class="lineno"> 3065</span><span class="comment"> *\param netw The aimed NETWORK where we want to add something to send</span></div>
<div class="line"><span class="lineno"> 3066</span><span class="comment"> *\param type type of identification ( NETW_IDENT_REQUEST , NETW_IDENT_NEW )</span></div>
<div class="line"><span class="lineno"> 3067</span><span class="comment"> *\param id The ID of the sending client</span></div>
<div class="line"><span class="lineno"> 3068</span><span class="comment"> *\param name Username</span></div>
<div class="line"><span class="lineno"> 3069</span><span class="comment"> *\param passwd Password</span></div>
<div class="line"><span class="lineno"> 3070</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 3071</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gae8345266fcf7a23c0e8ffe176b0e086f"> 3072</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gae8345266fcf7a23c0e8ffe176b0e086f">netw_send_ident</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> type, <span class="keywordtype">int</span> id, N_STR *name, N_STR *passwd  )</div>
<div class="line"><span class="lineno"> 3073</span>{</div>
<div class="line"><span class="lineno"> 3074</span>    N_STR *tmpstr = NULL ;</div>
<div class="line"><span class="lineno"> 3075</span> </div>
<div class="line"><span class="lineno"> 3076</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3077</span> </div>
<div class="line"><span class="lineno"> 3078</span>    tmpstr = <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga7bae3c3de53204413c7663007ec4a4d7">netmsg_make_ident</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga7bae3c3de53204413c7663007ec4a4d7">(</a> type<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga7bae3c3de53204413c7663007ec4a4d7">,</a> id<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga7bae3c3de53204413c7663007ec4a4d7">,</a> name<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga7bae3c3de53204413c7663007ec4a4d7">,</a> passwd  <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga7bae3c3de53204413c7663007ec4a4d7">)</a>;</div>
<div class="line"><span class="lineno"> 3079</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( tmpstr, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3080</span> </div>
<div class="line"><span class="lineno"> 3081</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">,</a> tmpstr <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">)</a>;</div>
<div class="line"><span class="lineno"> 3082</span>} <span class="comment">/* netw_send_ident( ... ) */</span></div>
<div class="line"><span class="lineno"> 3083</span> </div>
<div class="line"><span class="lineno"> 3084</span> </div>
<div class="line"><span class="lineno"> 3085</span> </div>
<div class="line"><span class="lineno"> 3086</span><span class="comment">/*!\fn netw_send_position( NETWORK *netw , int id , double X , double Y , double vx , double vy , double acc_x , double acc_y , int time_stamp )</span></div>
<div class="line"><span class="lineno"> 3087</span><span class="comment"> *\brief Add a formatted NETWMSG_IDENT message to the specified network</span></div>
<div class="line"><span class="lineno"> 3088</span><span class="comment"> *\param netw The aimed NETWORK where we want to add something to send</span></div>
<div class="line"><span class="lineno"> 3089</span><span class="comment"> *\param id The ID of the sending client</span></div>
<div class="line"><span class="lineno"> 3090</span><span class="comment"> *\param X X position inside a big grid</span></div>
<div class="line"><span class="lineno"> 3091</span><span class="comment"> *\param Y Y position inside a big grid</span></div>
<div class="line"><span class="lineno"> 3092</span><span class="comment"> *\param vx X speed</span></div>
<div class="line"><span class="lineno"> 3093</span><span class="comment"> *\param vy Y speed</span></div>
<div class="line"><span class="lineno"> 3094</span><span class="comment"> *\param acc_x Y acceleration</span></div>
<div class="line"><span class="lineno"> 3095</span><span class="comment"> *\param acc_y X acceleration</span></div>
<div class="line"><span class="lineno"> 3096</span><span class="comment"> *\param time_stamp Current Time when sending (for some delta we would want to compute )</span></div>
<div class="line"><span class="lineno"> 3097</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 3098</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gafaf1202a5f56a9f2285fccfbcacb3a6c"> 3099</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gafaf1202a5f56a9f2285fccfbcacb3a6c">netw_send_position</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> id, <span class="keywordtype">double</span> X, <span class="keywordtype">double</span> Y, <span class="keywordtype">double</span> vx, <span class="keywordtype">double</span> vy, <span class="keywordtype">double</span> acc_x, <span class="keywordtype">double</span> acc_y, <span class="keywordtype">int</span> time_stamp )</div>
<div class="line"><span class="lineno"> 3100</span>{</div>
<div class="line"><span class="lineno"> 3101</span>    N_STR *tmpstr = NULL ;</div>
<div class="line"><span class="lineno"> 3102</span> </div>
<div class="line"><span class="lineno"> 3103</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3104</span> </div>
<div class="line"><span class="lineno"> 3105</span>    tmpstr = <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">netmsg_make_position_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">(</a>  id<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">,</a> X<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">,</a> Y<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">,</a> vx<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">,</a> vy<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">,</a> acc_x<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">,</a> acc_y<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">,</a> time_stamp <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">)</a>;</div>
<div class="line"><span class="lineno"> 3106</span> </div>
<div class="line"><span class="lineno"> 3107</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( tmpstr, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3108</span> </div>
<div class="line"><span class="lineno"> 3109</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">,</a> tmpstr <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">)</a>;</div>
<div class="line"><span class="lineno"> 3110</span>} <span class="comment">/* netw_send_position( ... ) */</span></div>
<div class="line"><span class="lineno"> 3111</span> </div>
<div class="line"><span class="lineno"> 3112</span> </div>
<div class="line"><span class="lineno"> 3113</span> </div>
<div class="line"><span class="lineno"> 3114</span><span class="comment">/*!\fn int netw_send_string_to( NETWORK *netw , int id_to , N_STR *name , N_STR *txt , int color )</span></div>
<div class="line"><span class="lineno"> 3115</span><span class="comment"> *\brief Add a string to the network, aiming a specific user</span></div>
<div class="line"><span class="lineno"> 3116</span><span class="comment"> *\param netw The aimed NETWORK where we want to add something to send</span></div>
<div class="line"><span class="lineno"> 3117</span><span class="comment"> *\param id_from The ID of the sending client</span></div>
<div class="line"><span class="lineno"> 3118</span><span class="comment"> *\param id_to The ID of the targetted client</span></div>
<div class="line"><span class="lineno"> 3119</span><span class="comment"> *\param name Sender Name</span></div>
<div class="line"><span class="lineno"> 3120</span><span class="comment"> *\param txt Sender text</span></div>
<div class="line"><span class="lineno"> 3121</span><span class="comment"> *\param color Sender text color</span></div>
<div class="line"><span class="lineno"> 3122</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 3123</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gad3b590da2eb8b594c75d1d5f46ba7b45"> 3124</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gad3b590da2eb8b594c75d1d5f46ba7b45">netw_send_string_to</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, <span class="keywordtype">int</span> id_to, N_STR *name, N_STR *chan, N_STR *txt, <span class="keywordtype">int</span> color )</div>
<div class="line"><span class="lineno"> 3125</span>{</div>
<div class="line"><span class="lineno"> 3126</span>    N_STR *tmpstr = NULL ;</div>
<div class="line"><span class="lineno"> 3127</span> </div>
<div class="line"><span class="lineno"> 3128</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3129</span> </div>
<div class="line"><span class="lineno"> 3130</span>    tmpstr = <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">netmsg_make_string_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">user_id</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> id_to<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> name<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> chan<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> txt<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> color <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">)</a>;</div>
<div class="line"><span class="lineno"> 3131</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( tmpstr, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3132</span> </div>
<div class="line"><span class="lineno"> 3133</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">,</a> tmpstr <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">)</a>;</div>
<div class="line"><span class="lineno"> 3134</span>} <span class="comment">/* netw_send_string_to( ... ) */</span></div>
<div class="line"><span class="lineno"> 3135</span> </div>
<div class="line"><span class="lineno"> 3136</span> </div>
<div class="line"><span class="lineno"> 3137</span> </div>
<div class="line"><span class="lineno"> 3138</span><span class="comment">/*!\fn netw_send_string_to_all( NETWORK *netw , int id , char *name , char *chan , char *txt , int color )</span></div>
<div class="line"><span class="lineno"> 3139</span><span class="comment"> *\brief Add a string to the network, aiming all server-side users</span></div>
<div class="line"><span class="lineno"> 3140</span><span class="comment"> *\param netw The aimed NETWORK where we want to add something to send</span></div>
<div class="line"><span class="lineno"> 3141</span><span class="comment"> *\param id The ID of the sending client</span></div>
<div class="line"><span class="lineno"> 3142</span><span class="comment"> *\param name Name of user</span></div>
<div class="line"><span class="lineno"> 3143</span><span class="comment"> *\param chan Target Channel, if any. Pass &quot;ALL&quot; to target the default channel</span></div>
<div class="line"><span class="lineno"> 3144</span><span class="comment"> *\param txt The text to send</span></div>
<div class="line"><span class="lineno"> 3145</span><span class="comment"> *\param color The color of the text</span></div>
<div class="line"><span class="lineno"> 3146</span><span class="comment"> *\return TRUE or FALSE;</span></div>
<div class="line"><span class="lineno"> 3147</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"> 3148</span> </div>
<div class="line"><span class="lineno"><a class="line" href="n__network_8c.html#a02b35de5d3b84e79c4fecbf4cebce603"> 3149</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="n__network_8c.html#a02b35de5d3b84e79c4fecbf4cebce603">netw_send_string_to_all</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw, N_STR *name, N_STR *chan, N_STR *txt, <span class="keywordtype">int</span> color )</div>
<div class="line"><span class="lineno"> 3150</span>{</div>
<div class="line"><span class="lineno"> 3151</span>    N_STR *tmpstr = NULL ;</div>
<div class="line"><span class="lineno"> 3152</span> </div>
<div class="line"><span class="lineno"> 3153</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3154</span> </div>
<div class="line"><span class="lineno"> 3155</span>    tmpstr = <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">netmsg_make_string_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">(</a> netw <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">-&gt;</a> <a class="code hl_variable" href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">user_id</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a>  -1<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> name<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> chan<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> txt<a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">,</a> color <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">)</a>;</div>
<div class="line"><span class="lineno"> 3156</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( tmpstr, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3157</span> </div>
<div class="line"><span class="lineno"> 3158</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">,</a> tmpstr <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">)</a>;</div>
<div class="line"><span class="lineno"> 3159</span>} <span class="comment">/* netw_send_string_to_all( ... ) */</span></div>
<div class="line"><span class="lineno"> 3160</span> </div>
<div class="line"><span class="lineno"> 3161</span> </div>
<div class="line"><span class="lineno"> 3162</span> </div>
<div class="line"><span class="lineno"> 3163</span><span class="comment">/*!\fn int netw_send_quit( NETWORK *netw )</span></div>
<div class="line"><span class="lineno"> 3164</span><span class="comment"> *\brief Add a formatted NETMSG_QUIT message to the specified network</span></div>
<div class="line"><span class="lineno"> 3165</span><span class="comment"> *\param netw The aimed NETWORK</span></div>
<div class="line"><span class="lineno"> 3166</span><span class="comment"> *\return TRUE or FALSE</span></div>
<div class="line"><span class="lineno"> 3167</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno"><a class="line" href="group___n_e_t_w_o_r_k_i_n_g.html#gac8b30599c7a5c2cce35ee401d7b9d7f1"> 3168</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#gac8b30599c7a5c2cce35ee401d7b9d7f1">netw_send_quit</a>( <a class="code hl_struct" href="struct_n_e_t_w_o_r_k.html">NETWORK</a> *netw )</div>
<div class="line"><span class="lineno"> 3169</span>{</div>
<div class="line"><span class="lineno"> 3170</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( netw, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3171</span> </div>
<div class="line"><span class="lineno"> 3172</span>    N_STR *tmpstr = NULL ;</div>
<div class="line"><span class="lineno"> 3173</span> </div>
<div class="line"><span class="lineno"> 3174</span>    tmpstr = <a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaea4cc09810479665c6c7e689dfaecff7">netmsg_make_quit_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaea4cc09810479665c6c7e689dfaecff7">(</a><a class="code hl_function" href="group___n_e_t_w_o_r_k___m_s_g.html#gaea4cc09810479665c6c7e689dfaecff7">)</a>;</div>
<div class="line"><span class="lineno"> 3175</span>    <a class="code hl_define" href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a>( tmpstr, <span class="keywordflow">return</span> FALSE );</div>
<div class="line"><span class="lineno"> 3176</span> </div>
<div class="line"><span class="lineno"> 3177</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a><a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">(</a> netw<a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">,</a> tmpstr <a class="code hl_function" href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">)</a>;</div>
<div class="line"><span class="lineno"> 3178</span>} <span class="comment">/* netw_send_quit( ... ) */</span></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga0499ff5244b948781a28466e35282c55"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga0499ff5244b948781a28466e35282c55">init_lock</a></div><div class="ttdeci">#define init_lock(__rwlock_mutex)</div><div class="ttdoc">Macro for initializing a rwlock.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00338">n_common.h:338</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga079dc7a6a7e7c54bb714d8bb2afdd022"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga079dc7a6a7e7c54bb714d8bb2afdd022">FreeNoLog</a></div><div class="ttdeci">#define FreeNoLog(__ptr)</div><div class="ttdoc">Free Handler without log.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00252">n_common.h:252</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga46bf052fc99248347a1dcf89bc0757c6"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga46bf052fc99248347a1dcf89bc0757c6">Malloc</a></div><div class="ttdeci">#define Malloc(__ptr, __struct, __size)</div><div class="ttdoc">Malloc Handler to get errors and set to 0.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00180">n_common.h:180</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga4ecf5d80299a4ca1dc13c3a19610db11"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga4ecf5d80299a4ca1dc13c3a19610db11">__n_assert</a></div><div class="ttdeci">#define __n_assert(__ptr, __ret)</div><div class="ttdoc">macro to assert things</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00260">n_common.h:260</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga55b9404f7bc9d3a3ead2f0103331a87e"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga55b9404f7bc9d3a3ead2f0103331a87e">_str</a></div><div class="ttdeci">#define _str(__PTR)</div><div class="ttdoc">define true</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00169">n_common.h:169</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga68d60dda02e374e8d2e38deb9aecadcd"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga68d60dda02e374e8d2e38deb9aecadcd">rw_lock_destroy</a></div><div class="ttdeci">#define rw_lock_destroy(__rwlock_mutex)</div><div class="ttdoc">Macro to destroy rwlock mutex.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00406">n_common.h:406</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_ga9bbd6f2ada0efec0afcdcaa60cc20474"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#ga9bbd6f2ada0efec0afcdcaa60cc20474">unlock</a></div><div class="ttdeci">#define unlock(__rwlock_mutex)</div><div class="ttdoc">Macro for releasing read/write lock a rwlock mutex.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00391">n_common.h:391</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_gabf9cebcdf845c2c9b879a608be4c9dce"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#gabf9cebcdf845c2c9b879a608be4c9dce">write_lock</a></div><div class="ttdeci">#define write_lock(__rwlock_mutex)</div><div class="ttdoc">Macro for acquiring a write lock on a rwlock mutex.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00375">n_common.h:375</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_gae62e40d702e99a7760ba1de7451dff51"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#gae62e40d702e99a7760ba1de7451dff51">Free</a></div><div class="ttdeci">#define Free(__ptr)</div><div class="ttdoc">Free Handler to get errors.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00240">n_common.h:240</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_gaeba0ec63ec0aa6803e9a601b645b5cbf"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#gaeba0ec63ec0aa6803e9a601b645b5cbf">read_lock</a></div><div class="ttdeci">#define read_lock(__rwlock_mutex)</div><div class="ttdoc">Macro for acquiring a read lock on a rwlock mutex.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00359">n_common.h:359</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_gaf0e29edead3f943a4ac241c5724e1384"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#gaf0e29edead3f943a4ac241c5724e1384">_nstr</a></div><div class="ttdeci">#define _nstr(__PTR)</div><div class="ttdoc">N_STR or &quot;NULL&quot; string for logging purposes.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00175">n_common.h:175</a></div></div>
<div class="ttc" id="agroup___c_o_m_m_o_n_s_html_gaf355f5fc76fc13a2bb894b92f7fb1ad9"><div class="ttname"><a href="group___c_o_m_m_o_n_s.html#gaf355f5fc76fc13a2bb894b92f7fb1ad9">CALL_RETRY</a></div><div class="ttdeci">#define CALL_RETRY(retvar, expression)</div><div class="ttdoc">TEMP_FAILURE gnu macro portable version.</div><div class="ttdef"><b>Definition:</b> <a href="n__common_8h_source.html#l00268">n_common.h:268</a></div></div>
<div class="ttc" id="agroup___e_n_u_m_s_html_gaa8f74897a9d29d0a5e3465a63a532668"><div class="ttname"><a href="group___e_n_u_m_s.html#gaa8f74897a9d29d0a5e3465a63a532668">N_ENUM_DEFINE</a></div><div class="ttdeci">#define N_ENUM_DEFINE(MACRO_DEFINITION, enum_name)</div><div class="ttdef"><b>Definition:</b> <a href="n__enum_8h_source.html#l00090">n_enum.h:90</a></div></div>
<div class="ttc" id="agroup___e_n_u_m_s_html_gaea85b76e3e616598be8af94c93581532"><div class="ttname"><a href="group___e_n_u_m_s.html#gaea85b76e3e616598be8af94c93581532">N_ENUM_ENTRY</a></div><div class="ttdeci">#define N_ENUM_ENTRY(class, method)</div><div class="ttdef"><b>Definition:</b> <a href="n__enum_8h_source.html#l00023">n_enum.h:23</a></div></div>
<div class="ttc" id="agroup___h_a_s_h___t_a_b_l_e_html_ga072f117e6bd9fdde0d39776764b8784e"><div class="ttname"><a href="group___h_a_s_h___t_a_b_l_e.html#ga072f117e6bd9fdde0d39776764b8784e">ht_foreach</a></div><div class="ttdeci">#define ht_foreach(__ITEM_, __HASH_)</div><div class="ttdoc">ForEach macro helper (classic / old)</div><div class="ttdef"><b>Definition:</b> <a href="n__hash_8h_source.html#l00166">n_hash.h:166</a></div></div>
<div class="ttc" id="agroup___h_a_s_h___t_a_b_l_e_html_ga22a943135dbcdb1611b40ce0547111ce"><div class="ttname"><a href="group___h_a_s_h___t_a_b_l_e.html#ga22a943135dbcdb1611b40ce0547111ce">destroy_ht</a></div><div class="ttdeci">int destroy_ht(HASH_TABLE **table)</div><div class="ttdoc">Free and set the table to NULL.</div><div class="ttdef"><b>Definition:</b> <a href="n__hash_8c_source.html#l02005">n_hash.c:2005</a></div></div>
<div class="ttc" id="agroup___h_a_s_h___t_a_b_l_e_html_gaa2d879c1afd3c71a0917bbe2c0766664"><div class="ttname"><a href="group___h_a_s_h___t_a_b_l_e.html#gaa2d879c1afd3c71a0917bbe2c0766664">new_ht</a></div><div class="ttdeci">HASH_TABLE * new_ht(unsigned long int size)</div><div class="ttdef"><b>Definition:</b> <a href="n__hash_8c_source.html#l01860">n_hash.c:1860</a></div></div>
<div class="ttc" id="agroup___h_a_s_h___t_a_b_l_e_html_gaeb031d4f0f896b1802b9c27e62f28d14"><div class="ttname"><a href="group___h_a_s_h___t_a_b_l_e.html#gaeb031d4f0f896b1802b9c27e62f28d14">hash_val</a></div><div class="ttdeci">#define hash_val(node, type)</div><div class="ttdoc">Cast a HASH_NODE element.</div><div class="ttdef"><b>Definition:</b> <a href="n__hash_8h_source.html#l00159">n_hash.h:159</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga1109e1a0b5996fb3c362ad243e2f8f80"><div class="ttname"><a href="group___l_i_s_t.html#ga1109e1a0b5996fb3c362ad243e2f8f80">list_shift</a></div><div class="ttdeci">#define list_shift(__LIST_, __TYPE_)</div><div class="ttdoc">Shift macro helper for void pointer casting.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00081">n_list.h:81</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga1dafe7a250ddad51fadd375f057287e7"><div class="ttname"><a href="group___l_i_s_t.html#ga1dafe7a250ddad51fadd375f057287e7">list_empty</a></div><div class="ttdeci">int list_empty(LIST *list)</div><div class="ttdoc">Empty a LIST list of pointers.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8c_source.html#l00424">n_list.c:424</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga366776cfa85e526b247ef1d348c34e0c"><div class="ttname"><a href="group___l_i_s_t.html#ga366776cfa85e526b247ef1d348c34e0c">remove_list_node</a></div><div class="ttdeci">#define remove_list_node(__LIST_,__NODE_, __TYPE_)</div><div class="ttdoc">Remove macro helper for void pointer casting.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00083">n_list.h:83</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga4eab319289a83524639ee5e9f0441fdf"><div class="ttname"><a href="group___l_i_s_t.html#ga4eab319289a83524639ee5e9f0441fdf">list_push</a></div><div class="ttdeci">int list_push(LIST *list, void *ptr, void(*destructor)(void *ptr))</div><div class="ttdoc">Add a pointer to the end of the list.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8c_source.html#l00121">n_list.c:121</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga55cdaac0dd0f4f4d687607e6679a4634"><div class="ttname"><a href="group___l_i_s_t.html#ga55cdaac0dd0f4f4d687607e6679a4634">list_foreach</a></div><div class="ttdeci">#define list_foreach(__ITEM_, __LIST_)</div><div class="ttdoc">ForEach macro helper.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00070">n_list.h:70</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_ga90d32fef68ce6f3ec0a7b4085690c755"><div class="ttname"><a href="group___l_i_s_t.html#ga90d32fef68ce6f3ec0a7b4085690c755">list_destroy</a></div><div class="ttdeci">int list_destroy(LIST **list)</div><div class="ttdoc">Empty and Free a list container.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8c_source.html#l00480">n_list.c:480</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_gada615e3b144e97bcff147dfe89f6fef6"><div class="ttname"><a href="group___l_i_s_t.html#gada615e3b144e97bcff147dfe89f6fef6">new_generic_list</a></div><div class="ttdeci">LIST * new_generic_list(int max_items)</div><div class="ttdoc">Initialiaze a generic list container to max_items pointers.</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8c_source.html#l00020">n_list.c:20</a></div></div>
<div class="ttc" id="agroup___l_i_s_t_html_gae009d6d3c835a2affb99071ea8457803"><div class="ttname"><a href="group___l_i_s_t.html#gae009d6d3c835a2affb99071ea8457803">list_search</a></div><div class="ttdeci">LIST_NODE * list_search(LIST *list, void *ptr)</div><div class="ttdoc">search ptr in list</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8c_source.html#l00385">n_list.c:385</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_ga61355655c6d490cdf201afdfc340df4b"><div class="ttname"><a href="group___l_o_g.html#ga61355655c6d490cdf201afdfc340df4b">n_log</a></div><div class="ttdeci">#define n_log(__LEVEL__,...)</div><div class="ttdoc">Logging function wrapper to get line and func.</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00073">n_log.h:73</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_ga6ff63e8955665c4a58b1598f2b07c51a"><div class="ttname"><a href="group___l_o_g.html#ga6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG</div><div class="ttdoc">debug-level messages</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00065">n_log.h:65</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_ga96fad55b3f5adf08c39e4c877cf185e3"><div class="ttname"><a href="group___l_o_g.html#ga96fad55b3f5adf08c39e4c877cf185e3">LOG_ERR</a></div><div class="ttdeci">#define LOG_ERR</div><div class="ttdoc">error conditions</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00057">n_log.h:57</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_gaeb4f36db01bd128c7afeac5889dac311"><div class="ttname"><a href="group___l_o_g.html#gaeb4f36db01bd128c7afeac5889dac311">LOG_INFO</a></div><div class="ttdeci">#define LOG_INFO</div><div class="ttdoc">informational</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8h_source.html#l00063">n_log.h:63</a></div></div>
<div class="ttc" id="agroup___l_o_g_html_gafbbbfcb9063b9f1454a499dbf98f7a56"><div class="ttname"><a href="group___l_o_g.html#gafbbbfcb9063b9f1454a499dbf98f7a56">_n_log</a></div><div class="ttdeci">void _n_log(int level, const char *file, const char *func, int line, const char *format,...)</div><div class="ttdoc">Logging function.</div><div class="ttdef"><b>Definition:</b> <a href="n__log_8c_source.html#l00216">n_log.c:216</a></div></div>
<div class="ttc" id="agroup___n___s_t_r_html_ga0a864a4ce4997389f2e5e2e16c51a30a"><div class="ttname"><a href="group___n___s_t_r.html#ga0a864a4ce4997389f2e5e2e16c51a30a">free_nstr_ptr</a></div><div class="ttdeci">void free_nstr_ptr(void *ptr)</div><div class="ttdoc">Free a N_STR pointer structure.</div><div class="ttdef"><b>Definition:</b> <a href="n__str_8c_source.html#l00049">n_str.c:49</a></div></div>
<div class="ttc" id="agroup___n___s_t_r_html_ga113e906d03374ac38e441f1df44095fb"><div class="ttname"><a href="group___n___s_t_r.html#ga113e906d03374ac38e441f1df44095fb">free_nstr</a></div><div class="ttdeci">#define free_nstr(__ptr)</div><div class="ttdef"><b>Definition:</b> <a href="n__str_8h_source.html#l00200">n_str.h:200</a></div></div>
<div class="ttc" id="agroup___n___s_t_r_html_ga1c1f4062c727970a68bfd932c3fabcd5"><div class="ttname"><a href="group___n___s_t_r.html#ga1c1f4062c727970a68bfd932c3fabcd5">nstrprintf</a></div><div class="ttdeci">#define nstrprintf(__nstr_var,...)</div><div class="ttdoc">Macro to quickly allocate and sprintf to N_STR *.</div><div class="ttdef"><b>Definition:</b> <a href="n__str_8h_source.html#l00097">n_str.h:97</a></div></div>
<div class="ttc" id="agroup___n___s_t_r_html_gaca4a7a2dfa962f043cb8f3762ce28761"><div class="ttname"><a href="group___n___s_t_r.html#gaca4a7a2dfa962f043cb8f3762ce28761">_free_nstr</a></div><div class="ttdeci">int _free_nstr(N_STR **ptr)</div><div class="ttdoc">Free a N_STR structure and set the pointer to NULL.</div><div class="ttdef"><b>Definition:</b> <a href="n__str_8c_source.html#l00066">n_str.c:66</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k___m_s_g_html_ga6d469c5cbc4fdfa266be68a35d10a904"><div class="ttname"><a href="group___n_e_t_w_o_r_k___m_s_g.html#ga6d469c5cbc4fdfa266be68a35d10a904">netmsg_make_position_msg</a></div><div class="ttdeci">N_STR * netmsg_make_position_msg(int id, double X, double Y, double vx, double vy, double acc_x, double acc_y, int time_stamp)</div><div class="ttdef"><b>Definition:</b> <a href="n__network__msg_8c_source.html#l00659">n_network_msg.c:659</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k___m_s_g_html_ga7bae3c3de53204413c7663007ec4a4d7"><div class="ttname"><a href="group___n_e_t_w_o_r_k___m_s_g.html#ga7bae3c3de53204413c7663007ec4a4d7">netmsg_make_ident</a></div><div class="ttdeci">N_STR * netmsg_make_ident(int type, int id, N_STR *name, N_STR *passwd)</div><div class="ttdoc">Add a formatted NETWMSG_IDENT message to the specified network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network__msg_8c_source.html#l00622">n_network_msg.c:622</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k___m_s_g_html_gaea4cc09810479665c6c7e689dfaecff7"><div class="ttname"><a href="group___n_e_t_w_o_r_k___m_s_g.html#gaea4cc09810479665c6c7e689dfaecff7">netmsg_make_quit_msg</a></div><div class="ttdeci">N_STR * netmsg_make_quit_msg(void)</div><div class="ttdef"><b>Definition:</b> <a href="n__network__msg_8c_source.html#l00716">n_network_msg.c:716</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k___m_s_g_html_gaeb5e94070c0ee79ff2d11a707d225c3a"><div class="ttname"><a href="group___n_e_t_w_o_r_k___m_s_g.html#gaeb5e94070c0ee79ff2d11a707d225c3a">netmsg_make_ping</a></div><div class="ttdeci">N_STR * netmsg_make_ping(int type, int id_from, int id_to, int time)</div><div class="ttdoc">Make a ping message to send to a network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network__msg_8c_source.html#l00575">n_network_msg.c:575</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k___m_s_g_html_gafb91c3ea7bfa93212141fa1fe074fb3d"><div class="ttname"><a href="group___n_e_t_w_o_r_k___m_s_g.html#gafb91c3ea7bfa93212141fa1fe074fb3d">netmsg_make_string_msg</a></div><div class="ttdeci">N_STR * netmsg_make_string_msg(int id_from, int id_to, N_STR *name, N_STR *chan, N_STR *txt, int color)</div><div class="ttdef"><b>Definition:</b> <a href="n__network__msg_8c_source.html#l00686">n_network_msg.c:686</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga06115ed18a658114104ca6b6823f5d79"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga06115ed18a658114104ca6b6823f5d79">netw_pool_broadcast</a></div><div class="ttdeci">int netw_pool_broadcast(NETWORK_POOL *netw_pool, NETWORK *from, N_STR *net_msg)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02992">n_network.c:2992</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga0d0992b4eac986d7757ecddbc66e3b90"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga0d0992b4eac986d7757ecddbc66e3b90">netw_get_msg</a></div><div class="ttdeci">N_STR * netw_get_msg(NETWORK *netw)</div><div class="ttdoc">Get a message from aimed NETWORK.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02061">n_network.c:2061</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga0f3aa54a82aed45e85124acbd7af6a29"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga0f3aa54a82aed45e85124acbd7af6a29">send_php</a></div><div class="ttdeci">int send_php(SOCKET s, int _code, char *buf, int n)</div><div class="ttdoc">send data onto the socket</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02621">n_network.c:2621</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga10429a9fa106b61c38f28635242ce502"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga10429a9fa106b61c38f28635242ce502">netw_add_msg</a></div><div class="ttdeci">int netw_add_msg(NETWORK *netw, N_STR *msg)</div><div class="ttdoc">Add a message to send in aimed NETWORK.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01982">n_network.c:1982</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga17e1ca18a5396fc41632be200396eb8c"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga17e1ca18a5396fc41632be200396eb8c">netw_pool_nbclients</a></div><div class="ttdeci">int netw_pool_nbclients(NETWORK_POOL *netw_pool)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03018">n_network.c:3018</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga1fc319fa3b0eba19e163070a9fb3dae4"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga1fc319fa3b0eba19e163070a9fb3dae4">recv_data</a></div><div class="ttdeci">int recv_data(SOCKET s, char *buf, NSTRBYTE n)</div><div class="ttdoc">recv data from the socket</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02563">n_network.c:2563</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga22bc4dd5d80c2229c3c43f6d6705dece"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga22bc4dd5d80c2229c3c43f6d6705dece">netw_init_wsa</a></div><div class="ttdeci">int netw_init_wsa(int mode, int v1, int v2)</div><div class="ttdoc">Do not directly use, internal api.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l00752">n_network.c:752</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga29159184519b3129c0154b1a2c2a3e2f"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga29159184519b3129c0154b1a2c2a3e2f">netw_stop_thr_engine</a></div><div class="ttdeci">int netw_stop_thr_engine(NETWORK *netw)</div><div class="ttdoc">Stop a NETWORK connection sending and receing thread.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02470">n_network.c:2470</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga2ef0aab7ff9fb531466a536773b53683"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga2ef0aab7ff9fb531466a536773b53683">netw_send_func</a></div><div class="ttdeci">void * netw_send_func(void *NET)</div><div class="ttdoc">Thread send function.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02189">n_network.c:2189</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga32138772c399518190a14e81164fc469"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga32138772c399518190a14e81164fc469">netw_accept_nonblock_from</a></div><div class="ttdeci">NETWORK * netw_accept_nonblock_from(NETWORK *from, int blocking)</div><div class="ttdoc">make a normal blocking 'accept' .</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01970">n_network.c:1970</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga3f93cb2837a5f8d836804f450415d7b8"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga3f93cb2837a5f8d836804f450415d7b8">NETWORK_IPV6</a></div><div class="ttdeci">#define NETWORK_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00030">n_network.h:30</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga4cef67bc400323306a3d1c1ed5cec17b"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga4cef67bc400323306a3d1c1ed5cec17b">netw_connect_ex</a></div><div class="ttdeci">int netw_connect_ex(NETWORK **netw, char *host, char *port, int send_list_limit, int recv_list_limit, int ip_version)</div><div class="ttdoc">Use this to connect a NETWORK to any listening one.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01243">n_network.c:1243</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga4dcf657c3f133ae52d1fa6f2a2e0cd18"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga4dcf657c3f133ae52d1fa6f2a2e0cd18">netw_set_user_id</a></div><div class="ttdeci">int netw_set_user_id(NETWORK *netw, int id)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03032">n_network.c:3032</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga52afd4f5662c9c8f334d224ae2cdbdf2"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga52afd4f5662c9c8f334d224ae2cdbdf2">netw_make_listening</a></div><div class="ttdeci">int netw_make_listening(NETWORK **netw, char *addr, char *port, int nbpending, int ip_version)</div><div class="ttdoc">Make a NETWORK be a Listening network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01684">n_network.c:1684</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga559af0e5a7ad6c1693c0387eefde89bf"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga559af0e5a7ad6c1693c0387eefde89bf">HEAD_SIZE</a></div><div class="ttdeci">#define HEAD_SIZE</div><div class="ttdoc">NETWORK -&gt; mode value for a CLIENT (meaning connecting)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00234">n_network.h:234</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga5ba0555c5ccd261227c3c1216923d563"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga5ba0555c5ccd261227c3c1216923d563">netw_start_thr_engine</a></div><div class="ttdeci">int netw_start_thr_engine(NETWORK *netw)</div><div class="ttdoc">Start the NETWORK netw Threaded Engine.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02149">n_network.c:2149</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga5c0996a0b85b32d296c4e679a6eb86c2"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga5c0996a0b85b32d296c4e679a6eb86c2">netw_destroy_pool</a></div><div class="ttdeci">int netw_destroy_pool(NETWORK_POOL **netw_pool)</div><div class="ttdoc">free a network pool</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02894">n_network.c:2894</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga5f726a9a4d94caeeeff82e4449564d64"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga5f726a9a4d94caeeeff82e4449564d64">NETWORK_IPV4</a></div><div class="ttdeci">#define NETWORK_IPV4</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00029">n_network.h:29</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga60beb772aa298f36d1443a28e3ec5ec8"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga60beb772aa298f36d1443a28e3ec5ec8">netw_wait_close</a></div><div class="ttdeci">int netw_wait_close(NETWORK **netw)</div><div class="ttdoc">Wait for peer closing a specified Network, destroy queues, free the structure.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01591">n_network.c:1591</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga63e06c0450013078c54bb4951e9438ac"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga63e06c0450013078c54bb4951e9438ac">netw_recv_func</a></div><div class="ttdeci">void * netw_recv_func(void *NET)</div><div class="ttdoc">To Thread Receiving function.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02319">n_network.c:2319</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga72bfa45bed60463a02fe636da854ce9f"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga72bfa45bed60463a02fe636da854ce9f">HEAD_CODE</a></div><div class="ttdeci">#define HEAD_CODE</div><div class="ttdoc">PHP send and receive header size.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00236">n_network.h:236</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga7db2f701ab9a20af4a6fa8baac9d5172"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga7db2f701ab9a20af4a6fa8baac9d5172">netw_get_queue_status</a></div><div class="ttdeci">int netw_get_queue_status(NETWORK *netw, int *nb_to_send, int *nb_to_read)</div><div class="ttdoc">retrieve network send queue status</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02850">n_network.c:2850</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga80624fa0de793761e9ea5cebff424c68"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga80624fa0de793761e9ea5cebff424c68">netw_accept_from_ex</a></div><div class="ttdeci">NETWORK * netw_accept_from_ex(NETWORK *from, int send_list_limit, int recv_list_limit, int non_blocking, int *retval)</div><div class="ttdoc">make a normal 'accept' .</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01810">n_network.c:1810</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_ga995d9aaabaca026d79f15a9823eaebaf"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#ga995d9aaabaca026d79f15a9823eaebaf">netw_wait_close_timed</a></div><div class="ttdeci">int netw_wait_close_timed(NETWORK **netw, int timeout)</div><div class="ttdoc">Wait for peer closing a specified Network, destroy queues, free the structure.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01606">n_network.c:1606</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gaa5ed966d8c5844ded549eda41e38c0be"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gaa5ed966d8c5844ded549eda41e38c0be">netw_setsockopt</a></div><div class="ttdeci">int netw_setsockopt(NETWORK *netw, int optname, int value)</div><div class="ttdoc">Modify common socket options on the given netw.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l00866">n_network.c:866</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gaa8e1fe7978995197f08aa0ef24a76c33"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gaa8e1fe7978995197f08aa0ef24a76c33">netw_set</a></div><div class="ttdeci">int netw_set(NETWORK *netw, int flag)</div><div class="ttdoc">Restart or reset the specified network ability.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01420">n_network.c:1420</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gab0da745063a55fd79b6252339d5276a4"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gab0da745063a55fd79b6252339d5276a4">netw_pool_netw_close</a></div><div class="ttdeci">void netw_pool_netw_close(void *netw_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02912">n_network.c:2912</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gab99090cbf623f95556ea610e690b50d9"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gab99090cbf623f95556ea610e690b50d9">netw_accept_from</a></div><div class="ttdeci">NETWORK * netw_accept_from(NETWORK *from)</div><div class="ttdoc">make a normal blocking 'accept' .</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01957">n_network.c:1957</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gac345c1af1935cebb9ee33edd4c32267a"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gac345c1af1935cebb9ee33edd4c32267a">netw_close</a></div><div class="ttdeci">int netw_close(NETWORK **netw)</div><div class="ttdoc">Closing a specified Network, destroy queues, free the structure.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01497">n_network.c:1497</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gac8b30599c7a5c2cce35ee401d7b9d7f1"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gac8b30599c7a5c2cce35ee401d7b9d7f1">netw_send_quit</a></div><div class="ttdeci">int netw_send_quit(NETWORK *netw)</div><div class="ttdoc">Add a formatted NETMSG_QUIT message to the specified network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03168">n_network.c:3168</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gace3b069637ff0f12809eca2fb1a0b696"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gace3b069637ff0f12809eca2fb1a0b696">netw_wait_msg</a></div><div class="ttdeci">N_STR * netw_wait_msg(NETWORK *netw, long refresh, long timeout)</div><div class="ttdoc">Wait a message from aimed NETWORK.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02085">n_network.c:2085</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gad02f949dd057ae7dd382f03f9364cac0"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gad02f949dd057ae7dd382f03f9364cac0">netw_set_blocking</a></div><div class="ttdeci">int netw_set_blocking(NETWORK *netw, unsigned long int is_blocking)</div><div class="ttdoc">Modify blocking socket mode.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l00806">n_network.c:806</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gad3b590da2eb8b594c75d1d5f46ba7b45"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gad3b590da2eb8b594c75d1d5f46ba7b45">netw_send_string_to</a></div><div class="ttdeci">int netw_send_string_to(NETWORK *netw, int id_to, N_STR *name, N_STR *chan, N_STR *txt, int color)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03124">n_network.c:3124</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gad9588cf27263ecf40f57d3923ccf721a"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gad9588cf27263ecf40f57d3923ccf721a">netw_send_ping</a></div><div class="ttdeci">int netw_send_ping(NETWORK *netw, int type, int id_from, int id_to, int time)</div><div class="ttdoc">Add a ping reply to the network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03050">n_network.c:3050</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gadb5284c7b187815cf3b286a5cd972876"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gadb5284c7b187815cf3b286a5cd972876">netw_new_pool</a></div><div class="ttdeci">NETWORK_POOL * netw_new_pool(int nb_min_element)</div><div class="ttdoc">return a new network pool of nb_min_element</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02872">n_network.c:2872</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gadedaf21e22e67d0f7d27038e069fd6a6"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gadedaf21e22e67d0f7d27038e069fd6a6">NETWORK_CONSECUTIVE_SEND_TIMEOUT</a></div><div class="ttdeci">#define NETWORK_CONSECUTIVE_SEND_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00032">n_network.h:32</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gae18d52a130063ba1fd0a4cf4b6a2da20"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gae18d52a130063ba1fd0a4cf4b6a2da20">netw_connect</a></div><div class="ttdeci">int netw_connect(NETWORK **netw, char *host, char *port, int ip_version)</div><div class="ttdoc">Use this to connect a NETWORK to any listening one, unrestricted send/recv lists.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01378">n_network.c:1378</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gae3f625db1d84d26e70b9201d2f3aa062"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gae3f625db1d84d26e70b9201d2f3aa062">NETWORK_DEPLETE_TIMEOUT</a></div><div class="ttdeci">#define NETWORK_DEPLETE_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00031">n_network.h:31</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gae8345266fcf7a23c0e8ffe176b0e086f"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gae8345266fcf7a23c0e8ffe176b0e086f">netw_send_ident</a></div><div class="ttdeci">int netw_send_ident(NETWORK *netw, int type, int id, N_STR *name, N_STR *passwd)</div><div class="ttdoc">Add a formatted NETWMSG_IDENT message to the specified network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03072">n_network.c:3072</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gaed3d4b17261c0ce51cd7671b81b5a007"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gaed3d4b17261c0ce51cd7671b81b5a007">netw_pool_add</a></div><div class="ttdeci">int netw_pool_add(NETWORK_POOL *netw_pool, NETWORK *netw)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02923">n_network.c:2923</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gaf25c0f462f174092815b0c5d019441db"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gaf25c0f462f174092815b0c5d019441db">netw_get_state</a></div><div class="ttdeci">int netw_get_state(NETWORK *netw, int *state, int *thr_engine_status)</div><div class="ttdoc">Get the state of a network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01393">n_network.c:1393</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gaf3dc736265484a58e6678c250e38cef8"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gaf3dc736265484a58e6678c250e38cef8">send_data</a></div><div class="ttdeci">int send_data(SOCKET s, char *buf, NSTRBYTE n)</div><div class="ttdoc">send data onto the socket</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02513">n_network.c:2513</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gaf3e1619c354974bd6a40b511b2896e60"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gaf3e1619c354974bd6a40b511b2896e60">recv_php</a></div><div class="ttdeci">int recv_php(SOCKET s, int *_code, char **buf)</div><div class="ttdoc">recv data from the socket</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02720">n_network.c:2720</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gafaf1202a5f56a9f2285fccfbcacb3a6c"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gafaf1202a5f56a9f2285fccfbcacb3a6c">netw_send_position</a></div><div class="ttdeci">int netw_send_position(NETWORK *netw, int id, double X, double Y, double vx, double vy, double acc_x, double acc_y, int time_stamp)</div><div class="ttdoc">Add a formatted NETWMSG_IDENT message to the specified network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03099">n_network.c:3099</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gafc7a91b4be2a997710a2b54037c25168"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gafc7a91b4be2a997710a2b54037c25168">netw_pool_remove</a></div><div class="ttdeci">int netw_pool_remove(NETWORK_POOL *netw_pool, NETWORK *netw)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02957">n_network.c:2957</a></div></div>
<div class="ttc" id="agroup___n_e_t_w_o_r_k_i_n_g_html_gafd17b2ed695976a31b4cdee5091e0ef7"><div class="ttname"><a href="group___n_e_t_w_o_r_k_i_n_g.html#gafd17b2ed695976a31b4cdee5091e0ef7">netw_add_msg_ex</a></div><div class="ttdeci">int netw_add_msg_ex(NETWORK *netw, char *str, unsigned int length)</div><div class="ttdoc">Add a message to send in aimed NETWORK.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l02018">n_network.c:2018</a></div></div>
<div class="ttc" id="an__network_8c_html_a02b35de5d3b84e79c4fecbf4cebce603"><div class="ttname"><a href="n__network_8c.html#a02b35de5d3b84e79c4fecbf4cebce603">netw_send_string_to_all</a></div><div class="ttdeci">int netw_send_string_to_all(NETWORK *netw, N_STR *name, N_STR *chan, N_STR *txt, int color)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l03149">n_network.c:3149</a></div></div>
<div class="ttc" id="an__network_8c_html_a47e28ca4745f27fc86baf2ce2848d295"><div class="ttname"><a href="n__network_8c.html#a47e28ca4745f27fc86baf2ce2848d295">deplete_send_buffer</a></div><div class="ttdeci">int deplete_send_buffer(int fd, long timeout)</div><div class="ttdoc">wait until the socket is empty or timeout, checking each 100 msec.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l01558">n_network.c:1558</a></div></div>
<div class="ttc" id="an__network_8c_html_a9caee75e3a67942e37ccb4de2c889105"><div class="ttname"><a href="n__network_8c.html#a9caee75e3a67942e37ccb4de2c889105">netw_new</a></div><div class="ttdeci">NETWORK * netw_new(int send_list_limit, int recv_list_limit)</div><div class="ttdoc">Return an empty allocated network ready to be netw_closed.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l00631">n_network.c:631</a></div></div>
<div class="ttc" id="an__network_8c_html_a9fe7353395b6abe8f260a2de5d3b3d96"><div class="ttname"><a href="n__network_8c.html#a9fe7353395b6abe8f260a2de5d3b3d96">netstrerror</a></div><div class="ttdeci">#define netstrerror(code)</div><div class="ttdoc">BSD style errno string NO WORKING ON REDHAT.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l00603">n_network.c:603</a></div></div>
<div class="ttc" id="an__network_8c_html_aa852852826e7fd48fa5791e9ac1e32ae"><div class="ttname"><a href="n__network_8c.html#aa852852826e7fd48fa5791e9ac1e32ae">neterrno</a></div><div class="ttdeci">#define neterrno</div><div class="ttdoc">Keep it compatible with bsd like.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l00590">n_network.c:590</a></div></div>
<div class="ttc" id="an__network_8c_html_ab995208f051c8975b80f13ff2cfeae32"><div class="ttname"><a href="n__network_8c.html#ab995208f051c8975b80f13ff2cfeae32">get_in_addr</a></div><div class="ttdeci">char * get_in_addr(struct sockaddr *sa)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8c_source.html#l00737">n_network.c:737</a></div></div>
<div class="ttc" id="astruct_h_a_s_h___n_o_d_e_html"><div class="ttname"><a href="struct_h_a_s_h___n_o_d_e.html">HASH_NODE</a></div><div class="ttdoc">structure of a hash table node</div><div class="ttdef"><b>Definition:</b> <a href="n__hash_8h_source.html#l00082">n_hash.h:83</a></div></div>
<div class="ttc" id="astruct_h_a_s_h___t_a_b_l_e_html_a285c7cceac1e738fe12ce00a40fd6493"><div class="ttname"><a href="struct_h_a_s_h___t_a_b_l_e.html#a285c7cceac1e738fe12ce00a40fd6493">HASH_TABLE::nb_keys</a></div><div class="ttdeci">unsigned long int nb_keys</div><div class="ttdoc">total number of used keys in the table</div><div class="ttdef"><b>Definition:</b> <a href="n__hash_8h_source.html#l00113">n_hash.h:113</a></div></div>
<div class="ttc" id="astruct_l_i_s_t___n_o_d_e_html_a3e3c8144183582d63ffad5fb3315ea69"><div class="ttname"><a href="struct_l_i_s_t___n_o_d_e.html#a3e3c8144183582d63ffad5fb3315ea69">LIST_NODE::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdoc">void pointer to store</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00029">n_list.h:29</a></div></div>
<div class="ttc" id="astruct_l_i_s_t_html_a17ecceed58e4353b703f55133a36c0d1"><div class="ttname"><a href="struct_l_i_s_t.html#a17ecceed58e4353b703f55133a36c0d1">LIST::nb_items</a></div><div class="ttdeci">int nb_items</div><div class="ttdoc">number of item currently in the list</div><div class="ttdef"><b>Definition:</b> <a href="n__list_8h_source.html#l00047">n_list.h:47</a></div></div>
<div class="ttc" id="astruct_n___s_t_r_html_a576fb0ebcd98c7bad5aa25250d830092"><div class="ttname"><a href="struct_n___s_t_r.html#a576fb0ebcd98c7bad5aa25250d830092">N_STR::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">the string</div><div class="ttdef"><b>Definition:</b> <a href="n__str_8h_source.html#l00153">n_str.h:153</a></div></div>
<div class="ttc" id="astruct_n___s_t_r_html_a92e6a58234cf975e9d1419e9429cb663"><div class="ttname"><a href="struct_n___s_t_r.html#a92e6a58234cf975e9d1419e9429cb663">N_STR::length</a></div><div class="ttdeci">NSTRBYTE length</div><div class="ttdoc">length of string (in case we wanna keep information after the 0 end of string value)</div><div class="ttdef"><b>Definition:</b> <a href="n__str_8h_source.html#l00155">n_str.h:155</a></div></div>
<div class="ttc" id="astruct_n___s_t_r_html_aacd53350ba5ffcb9284e23069f74da3d"><div class="ttname"><a href="struct_n___s_t_r.html#aacd53350ba5ffcb9284e23069f74da3d">N_STR::written</a></div><div class="ttdeci">NSTRBYTE written</div><div class="ttdoc">size of the written data inside the string</div><div class="ttdef"><b>Definition:</b> <a href="n__str_8h_source.html#l00157">n_str.h:157</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k___p_o_o_l_html"><div class="ttname"><a href="struct_n_e_t_w_o_r_k___p_o_o_l.html">NETWORK_POOL</a></div><div class="ttdoc">structure of a network pool</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00352">n_network.h:353</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k___p_o_o_l_html_af120ab26f1240d792d9b5c3b52235fec"><div class="ttname"><a href="struct_n_e_t_w_o_r_k___p_o_o_l.html#af120ab26f1240d792d9b5c3b52235fec">NETWORK_POOL::pool</a></div><div class="ttdeci">HASH_TABLE * pool</div><div class="ttdoc">table of clients</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00355">n_network.h:355</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html">NETWORK</a></div><div class="ttdoc">Structure of a NETWORK.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00263">n_network.h:264</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a0eca3f4b7ee3a85432baa0cdb49361a3"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a0eca3f4b7ee3a85432baa0cdb49361a3">NETWORK::crypto_mode</a></div><div class="ttdeci">int crypto_mode</div><div class="ttdoc">tell if the socket have to be encrypted (flags NETW_CRYPTO_*)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00294">n_network.h:294</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a18fed15683e91916116ec855e5890756"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a18fed15683e91916116ec855e5890756">NETWORK::threaded_engine_status</a></div><div class="ttdeci">int threaded_engine_status</div><div class="ttdoc">Threaded network engine state for this network.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00272">n_network.h:272</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a1db8130fdbab7a8cc7d88c9f40ef7c77"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a1db8130fdbab7a8cc7d88c9f40ef7c77">NETWORK::nb_pending</a></div><div class="ttdeci">int nb_pending</div><div class="ttdoc">Nb pending connection,if listening.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00266">n_network.h:266</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a23deb42defc105bed87f798888fa9243"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a23deb42defc105bed87f798888fa9243">NETWORK::so_reuseaddr</a></div><div class="ttdeci">int so_reuseaddr</div><div class="ttdoc">so reuseaddr state</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00278">n_network.h:278</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a65fef5690cccc30acb1be83ee8dda127"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a65fef5690cccc30acb1be83ee8dda127">NETWORK::nb_running_threads</a></div><div class="ttdeci">int nb_running_threads</div><div class="ttdoc">nb running threads, if &gt; 0 thread engine is still running</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00300">n_network.h:300</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a72517eff4bde08ad4366b5f6248931d6"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a72517eff4bde08ad4366b5f6248931d6">NETWORK::send_queue_consecutive_wait</a></div><div class="ttdeci">int send_queue_consecutive_wait</div><div class="ttdoc">send queue consecutive pool interval, used when there are still items to send, in usec</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00276">n_network.h:276</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a7dba80b8f74427985ad4cb4e3504eddb"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a7dba80b8f74427985ad4cb4e3504eddb">NETWORK::so_rcvtimeo</a></div><div class="ttdeci">int so_rcvtimeo</div><div class="ttdoc">send timeout value</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00288">n_network.h:288</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a8a60485e1460f7cda5522b9382c43018"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a8a60485e1460f7cda5522b9382c43018">NETWORK::tcpnodelay</a></div><div class="ttdeci">int tcpnodelay</div><div class="ttdoc">state of naggle algorythm, 0 untouched, 1 forcibly disabled</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00280">n_network.h:280</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_a9c309c4d4a34adb115a21d124fba5213"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#a9c309c4d4a34adb115a21d124fba5213">NETWORK::recv_buf</a></div><div class="ttdeci">LIST * recv_buf</div><div class="ttdoc">reveicing buffer (for incomming usage)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00327">n_network.h:327</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_aa7d88c729aeaee09b4a2daed19c6384f"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#aa7d88c729aeaee09b4a2daed19c6384f">NETWORK::user_id</a></div><div class="ttdeci">int user_id</div><div class="ttdoc">if part of a user property, id of the user</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00298">n_network.h:298</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_aae099d39c28749fe6ca1c3c834f16700"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#aae099d39c28749fe6ca1c3c834f16700">NETWORK::so_sndbuf</a></div><div class="ttdeci">int so_sndbuf</div><div class="ttdoc">size of the socket send buffer, 0 untouched, else size in bytes</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00282">n_network.h:282</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_aaf963860be7e103f162fe2cdbf681ec4"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#aaf963860be7e103f162fe2cdbf681ec4">NETWORK::so_sndtimeo</a></div><div class="ttdeci">int so_sndtimeo</div><div class="ttdoc">send timeout value</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00286">n_network.h:286</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_ab5b54d3f01092bef4a3261b87187de44"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#ab5b54d3f01092bef4a3261b87187de44">NETWORK::deplete_timeout</a></div><div class="ttdeci">int deplete_timeout</div><div class="ttdoc">deplete send buffer ( 0 disabled, &gt; 0 wait for timeout and check unset/unack datas)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00292">n_network.h:292</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_ac052169cb0af68ba1a285da02e7a383a"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#ac052169cb0af68ba1a285da02e7a383a">NETWORK::state</a></div><div class="ttdeci">int state</div><div class="ttdoc">state of the connection , NETW_RUN, NETW_QUIT, NETW_STOP , NETW_ERR</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00270">n_network.h:270</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_ac6ee9581baa5e9d738641783c12684c8"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#ac6ee9581baa5e9d738641783c12684c8">NETWORK::send_data</a></div><div class="ttdeci">netw_func send_data</div><div class="ttdoc">send func ptr</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00306">n_network.h:306</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_ac8f7cfa2ad7bb499e28b80cd54a1aba0"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#ac8f7cfa2ad7bb499e28b80cd54a1aba0">NETWORK::addr_infos_loaded</a></div><div class="ttdeci">int addr_infos_loaded</div><div class="ttdoc">Internal flag to know if we have to free addr infos.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00274">n_network.h:274</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_ad95aeeed009dbdd2a9f1b362fa4f7e23"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#ad95aeeed009dbdd2a9f1b362fa4f7e23">NETWORK::pools</a></div><div class="ttdeci">LIST * pools</div><div class="ttdoc">pointers to network pools if members of any</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00344">n_network.h:344</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_ae0c060a264b61e2c11147a101159ca5b"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#ae0c060a264b61e2c11147a101159ca5b">NETWORK::so_linger</a></div><div class="ttdeci">int so_linger</div><div class="ttdoc">close lingering value (-1 disabled, 0 force close, &gt;0 linger )</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00290">n_network.h:290</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_aec612b7a36948836e9593464af149d4d"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#aec612b7a36948836e9593464af149d4d">NETWORK::crypto_algo</a></div><div class="ttdeci">int crypto_algo</div><div class="ttdoc">if encryption is on, which one (flags NETW_ENCRYPT_*)</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00296">n_network.h:296</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_af6c379d66dc41fb7d62efb98fc8bcf4b"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#af6c379d66dc41fb7d62efb98fc8bcf4b">NETWORK::send_buf</a></div><div class="ttdeci">LIST * send_buf</div><div class="ttdoc">sending buffer (for outgoing queuing )</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00325">n_network.h:325</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_af8205e18871cd24122c77e82b3310179"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#af8205e18871cd24122c77e82b3310179">NETWORK::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">NETWORK mode , 1 listening, 0 connecting.</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00268">n_network.h:268</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_af9cdd850de1d747671ba20c804bd7715"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#af9cdd850de1d747671ba20c804bd7715">NETWORK::so_rcvbuf</a></div><div class="ttdeci">int so_rcvbuf</div><div class="ttdoc">size of the socket recv buffer, 0 untouched, else size in bytes</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00284">n_network.h:284</a></div></div>
<div class="ttc" id="astruct_n_e_t_w_o_r_k_html_afa4742a842c0f4e729d8a88371c49209"><div class="ttname"><a href="struct_n_e_t_w_o_r_k.html#afa4742a842c0f4e729d8a88371c49209">NETWORK::recv_data</a></div><div class="ttdeci">netw_func recv_data</div><div class="ttdoc">receive func ptr</div><div class="ttdef"><b>Definition:</b> <a href="n__network_8h_source.html#l00308">n_network.h:308</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="n__network_8c.html">n_network.c</a></li>
    <li class="footer">Generated on Wed Feb 2 2022 14:24:10 for Nilorea Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
